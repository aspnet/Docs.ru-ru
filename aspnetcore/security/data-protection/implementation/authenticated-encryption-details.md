---
title: Сведения о шифровании с проверкой подлинности в ASP.NET Core
author: rick-anderson
description: Сведения о реализации шифрования с проверкой подлинности ASP.NET Core Data Protection.
ms.author: riande
ms.date: 10/14/2016
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: security/data-protection/implementation/authenticated-encryption-details
ms.openlocfilehash: 7978725534cdd3a5b425851f61b1c7ae3ada88df
ms.sourcegitcommit: ca34c1ac578e7d3daa0febf1810ba5fc74f60bbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2020
ms.locfileid: "93051841"
---
# <a name="authenticated-encryption-details-in-aspnet-core"></a>Сведения о шифровании с проверкой подлинности в ASP.NET Core

<a name="data-protection-implementation-authenticated-encryption-details"></a>

Вызовы Идатапротектор. Protect — это операции шифрования, прошедшие проверку подлинности. Метод Protect обеспечивает конфиденциальность и подлинность, а также привязан к цепочке назначений, которая использовалась для получения этого конкретного экземпляра Идатапротектор из его корневого Идатапротектионпровидер.

Идатапротектор. Protect принимает параметр Byte [] с открытым текстом и создает защищенные полезные данные в байтах [], формат которых описан ниже. (Существует также перегрузка метода расширения, принимающая параметр строки с открытым текстом и возвращающая защищенную строковую полезную нагрузку. Если этот API используется, формат защищенных полезных данных по-прежнему будет иметь следующую структуру, но он будет [base64url в кодировке](https://tools.ietf.org/html/rfc4648#section-5).)

## <a name="protected-payload-format"></a>Формат защищенных полезных данных

Защищенный формат полезных данных состоит из трех основных компонентов:

* 32-разрядный заголовок Magic, определяющий версию системы защиты данных.

* Идентификатор 128-битного ключа, определяющий ключ, используемый для защиты этих полезных данных.

* Оставшаяся часть защищенных полезных данных зависит [от шифратора, инкапсулированного этим ключом](xref:security/data-protection/implementation/subkeyderivation#data-protection-implementation-subkey-derivation). В приведенном ниже примере ключ представляет собой шифратор AES-256-CBC + HMACSHA256, а полезные данные дополнительно делятся следующим образом:
  * Модификатор 128-разрядного ключа.
  * 128-разрядный вектор инициализации.
  * 48 байта для выходных данных AES-256-CBC.
  * Тег проверки подлинности HMACSHA256.

Пример защищенных полезных данных показан ниже.

```
09 F0 C9 F0 80 9C 81 0C 19 66 19 40 95 36 53 F8
AA FF EE 57 57 2F 40 4C 3F 7F CC 9D CC D9 32 3E
84 17 99 16 EC BA 1F 4A A1 18 45 1F 2D 13 7A 28
79 6B 86 9C F8 B7 84 F9 26 31 FC B1 86 0A F1 56
61 CF 14 58 D3 51 6F CF 36 50 85 82 08 2D 3F 73
5F B0 AD 9E 1A B2 AE 13 57 90 C8 F5 7C 95 4E 6A
8A AA 06 EF 43 CA 19 62 84 7C 11 B2 C8 71 9D AA
52 19 2E 5B 4C 1E 54 F0 55 BE 88 92 12 C1 4B 5E
52 C9 74 A0
```

В формате полезных данных, превышающем первые 32 бит, или 4 байта — это заголовок Magic, определяющий версию (09 F0 C9 F0).

Следующий 128 бит или 16 байт является идентификатором ключа (80 9C 81 0C 19 66 19 40 95 36 53 F8 AA FF EE 57).

Остаток содержит полезные данные и зависит от используемого формата.

> [!WARNING]
> Все полезные данные, защищенные заданным ключом, будут начинаться с того же 20-байтового заголовка (магическое значение, идентификатор ключа). Администраторы могут использовать этот факт в целях диагностики, чтобы приблизительно оценить время создания полезных данных. Например, приведенные выше полезные данные соответствуют ключу {0c819c80-6619-4019-9536-53f8aaffee57}. Если после проверки репозитория ключей вы обнаружите, что Дата активации конкретного ключа была 2015-01-01, а Дата окончания срока действия была 2015-03-01, то разумно предположить, что полезные данные (если они не были изменены) были созданы в этом окне, присвойте или Возьмите небольшой параметр фактор с любой стороны.
