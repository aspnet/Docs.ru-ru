---
title: Управление ссылками protobuf с помощью .NET gRPC
author: juntaoluo
description: Сведения о добавлении, обновлении, удалении и перечислении ссылок Protobuf с помощью глобального средства dotnet-grpc.
monikerRange: '>= aspnetcore-3.0'
ms.author: johluo
ms.date: 10/17/2019
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: grpc/dotnet-grpc
ms.openlocfilehash: f34e1543d9695e138a85db3b79e013cf5fb6d138
ms.sourcegitcommit: ca34c1ac578e7d3daa0febf1810ba5fc74f60bbf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2020
ms.locfileid: "93059914"
---
# <a name="manage-protobuf-references-with-dotnet-grpc"></a>Управление ссылками protobuf с помощью .NET gRPC

Автор: [John Luo](https://github.com/juntaoluo) (Джон Луо)

`dotnet-grpc` — это глобальное средство .NET Core для управления ссылками [Protobuf ( *.proto* )](xref:grpc/basics#proto-file) в рамках проекта gRPC .NET. Это средство можно использовать для добавления, обновления, удаления и перечисления ссылок Protobuf.

## <a name="installation"></a>Установка

Чтобы установить [глобальное средство .NET Core](/dotnet/core/tools/global-tools) `dotnet-grpc`, выполните следующую команду:

```dotnetcli
dotnet tool install -g dotnet-grpc
```

## <a name="add-references"></a>Добавление ссылок

`dotnet-grpc` можно использовать для добавления ссылок Protobuf в качестве элементов `<Protobuf />` в файл *CSPROJ* :

```xml
<Protobuf Include="Protos\greet.proto" GrpcServices="Server" />
```

Ссылки Protobuf используются для создания клиентских и (или) серверных ресурсов C#. Средство `dotnet-grpc` предоставляет указанные ниже возможности:

* Создание ссылки Protobuf из локальных файлов на диске.
* Создание ссылки Protobuf из удаленного файла, указанного с помощью URL-адреса.
* Гарантия добавления в проект правильных зависимостей пакета gRPC.

Например, пакет `Grpc.AspNetCore` добавляется в веб-приложение. `Grpc.AspNetCore` содержит поддержку инструментов и серверных и клиентских библиотек gRPC. Кроме того, пакеты `Grpc.Net.Client`, `Grpc.Tools` и `Google.Protobuf`, содержащие только поддержку инструментов и серверных и клиентских библиотек gRPC, добавляются в консольное приложение.

### <a name="add-file"></a>Добавление файла

Команда `add-file` используется для добавления локальных файлов на диске в качестве ссылок Protobuf. Предоставленные пути к файлам:

* могут быть указаны относительно текущего каталога или абсолютных путей;
* могут содержать подстановочные знаки для использования [стандартных масок ](https://wikipedia.org/wiki/Glob_(programming)) файлов.

Если какие-либо файлы находятся за пределами каталога проекта, добавляется элемент `Link` для отображения файла в папке `Protos` в Visual Studio.

### <a name="usage"></a>Использование

```dotnetcli
dotnet grpc add-file [options] <files>...
```

#### <a name="arguments"></a>Аргументы

| Аргумент | Описание |
|-|-|
| файлы | Ссылки на файлы protobuf. Это может быть путь к стандартной маске для локальных файлов protobuf. |

#### <a name="options"></a>Параметры

| Короткий параметр | Длинный параметр | Описание |
|-|-|-|
| -p | --project | Путь к целевому файлу проекта. Если файл не указан, команда ищет текущий каталог для него.
| -S | --services | Тип служб gRPC, которые нужно создать. Если указан `Default`, `Both` используется для веб-проектов, а `Client` — для прочих проектов. Допустимые значения: `Both`, `Client`, `Default`, `None`, `Server`.
| -i | --additional-import-dirs | Дополнительные каталоги, которые будут использоваться при разрешении импортов для файлов protobuf. Это список путей, разделенных точкой с запятой.
| | --access | Модификатор доступа, используемый для создаваемых классов C#. Значение по умолчанию — `Public`. Допустимые значения: `Internal` и `Public`.

### <a name="add-url"></a>Добавление URL-адреса

Команда `add-url` используется для добавления удаленного файла, заданного исходным URL-адресом, в качестве ссылки Protobuf. Чтобы указать место для скачивания удаленного файла, необходимо задать путь к файлу. Этот путь может быть указан относительно текущего каталога или абсолютного пути. Если этот путь находится за пределами каталога проекта, добавляется элемент `Link` для отображения файла в папке `Protos` в Visual Studio.

### <a name="usage"></a>Использование

```dotnetcli
dotnet-grpc add-url [options] <url>
```

#### <a name="arguments"></a>Аргументы

| Аргумент | Описание |
|-|-|
| url | URL-адрес удаленного файла protobuf. |

#### <a name="options"></a>Параметры

| Короткий параметр | Длинный параметр | Описание |
|-|-|-|
| -o | --output | Указывает путь скачивания для удаленного файла protobuf. Это обязательный параметр.
| -p | --project | Путь к целевому файлу проекта. Если файл не указан, команда ищет текущий каталог для него.
| -S | --services | Тип служб gRPC, которые нужно создать. Если указан `Default`, `Both` используется для веб-проектов, а `Client` — для прочих проектов. Допустимые значения: `Both`, `Client`, `Default`, `None`, `Server`.
| -i | --additional-import-dirs | Дополнительные каталоги, которые будут использоваться при разрешении импортов для файлов protobuf. Это список путей, разделенных точкой с запятой.
| | --access | Модификатор доступа, используемый для создаваемых классов C#. Значение по умолчанию — `Public`. Допустимые значения: `Internal` и `Public`.

## <a name="remove"></a>Удалить

Команда `remove` используется для удаления ссылок Protobuf из файла *CSPROJ*. В качестве аргументов эта команда принимает URL-адреса источника и аргументы пути. Средство:

* удаляет только ссылку Protobuf;
* не удаляет файл *PROTO* , даже если он был первоначально скачан с удаленного URL-адреса.

### <a name="usage"></a>Использование

```dotnetcli
dotnet-grpc remove [options] <references>...
```

### <a name="arguments"></a>Аргументы

| Аргумент | Описание |
|-|-|
| ссылки | URL-адреса или пути к файлам для удаляемых ссылок protobuf. |

### <a name="options"></a>Параметры

| Короткий параметр | Длинный параметр | Описание |
|-|-|-|
| -p | --project | Путь к целевому файлу проекта. Если файл не указан, команда ищет текущий каталог для него.

## <a name="refresh"></a>Обновление

Команда `refresh` используется для обновления удаленной ссылки последним содержимым из URL-адреса источника. Для указания обновляемой ссылки можно использовать как путь скачивания файла, так и URL-адрес источника. Примечание.

* Хэши содержимого файла сравниваются, чтобы определить, требуется ли обновить локальный файл.
* Сведения о метке времени не сравниваются.

Средство всегда заменяет локальный файл удаленным, если требуется обновление.

### <a name="usage"></a>Использование

```dotnetcli
dotnet-grpc refresh [options] [<references>...]
```

### <a name="arguments"></a>Аргументы

| Аргумент | Описание |
|-|-|
| ссылки | URL-адреса или пути к файлам для удаленных ссылок protobuf, которые нужно обновить. Оставьте этот аргумент пустым, чтобы обновить все удаленные ссылки. |

### <a name="options"></a>Параметры

| Короткий параметр | Длинный параметр | Описание |
|-|-|-|
| -p | --project | Путь к целевому файлу проекта. Если файл не указан, команда ищет текущий каталог для него.
| | --dry-run | Выводит список файлов, которые будут обновлены без скачивания нового содержимого.

## <a name="list"></a>Список

Команда `list` используется для вывода всех ссылок на Protobuf в файле проекта. Если все значения столбца являются значениями по умолчанию, этот столбец можно опустить.

### <a name="usage"></a>Использование

```dotnetcli
dotnet-grpc list [options]
```

### <a name="options"></a>Параметры

| Короткий параметр | Длинный параметр | Описание |
|-|-|-|
| -p | --project | Путь к целевому файлу проекта. Если файл не указан, команда ищет текущий каталог для него.

## <a name="additional-resources"></a>Дополнительные ресурсы

* <xref:grpc/index>
* <xref:grpc/basics>
* <xref:grpc/aspnetcore>
