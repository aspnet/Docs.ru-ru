---
title: Глобализация и локализация в ASP.NET Core
author: rick-anderson
description: Сведения о службах и ПО промежуточного слоя, предоставляемых ASP.NET Core для локализации содержимого на разные языки и для разных региональных параметров.
ms.author: riande
ms.date: 11/30/2019
no-loc:
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: fundamentals/localization
ms.openlocfilehash: fcf69bdaaed5cf0283ae27440c28061857d2cbcb
ms.sourcegitcommit: d1a897ebd89daa05170ac448e4831d327f6b21a8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2020
ms.locfileid: "91606776"
---
# <a name="globalization-and-localization-in-aspnet-core"></a><span data-ttu-id="88f47-103">Глобализация и локализация в ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="88f47-103">Globalization and localization in ASP.NET Core</span></span>

::: moniker range=">= aspnetcore-3.0 < aspnetcore-5.0"

<span data-ttu-id="88f47-104">Авторы: [Рик Андерсон](https://twitter.com/RickAndMSFT) (Rick Anderson), [Дэмиен Боуден](https://twitter.com/damien_bod) (Damien Bowden), [Барт Каликсто](https://twitter.com/bartmax) (Bart Calixto), [Надим Афана](https://afana.me/) (Nadeem Afana) и [Хишам Бин Атея](https://twitter.com/hishambinateya) (Hisham Bin Ateya)</span><span class="sxs-lookup"><span data-stu-id="88f47-104">By [Rick Anderson](https://twitter.com/RickAndMSFT), [Damien Bowden](https://twitter.com/damien_bod), [Bart Calixto](https://twitter.com/bartmax), [Nadeem Afana](https://afana.me/), and [Hisham Bin Ateya](https://twitter.com/hishambinateya)</span></span>

<span data-ttu-id="88f47-105">Создание многоязычного веб-сайта позволит расширить аудиторию.</span><span class="sxs-lookup"><span data-stu-id="88f47-105">A multilingual website allows the site to reach a wider audience.</span></span> <span data-ttu-id="88f47-106">ASP.NET Core предоставляет службы и ПО промежуточного слоя для локализации на разные языки и для разных региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-106">ASP.NET Core provides services and middleware for localizing into different languages and cultures.</span></span>

<span data-ttu-id="88f47-107">Интернационализация предполагает [глобализацию](/dotnet/api/system.globalization) и [локализацию](/dotnet/standard/globalization-localization/localization).</span><span class="sxs-lookup"><span data-stu-id="88f47-107">Internationalization involves [Globalization](/dotnet/api/system.globalization) and [Localization](/dotnet/standard/globalization-localization/localization).</span></span> <span data-ttu-id="88f47-108">Глобализация — это процесс разработки приложений, которые поддерживают разные языки и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-108">Globalization is the process of designing apps that support different cultures.</span></span> <span data-ttu-id="88f47-109">Глобализация добавляет поддержку ввода отображения и вывода определенного набора языковых сценариев, относящихся к конкретным регионам.</span><span class="sxs-lookup"><span data-stu-id="88f47-109">Globalization adds support for input, display, and output of a defined set of language scripts that relate to specific geographic areas.</span></span>

<span data-ttu-id="88f47-110">Локализация — это процесс адаптации глобализованного приложения, уже подготовленного к локализации, к определенному языку, языковому стандарту и региональным параметрам.</span><span class="sxs-lookup"><span data-stu-id="88f47-110">Localization is the process of adapting a globalized app, which you have already processed for localizability, to a particular culture/locale.</span></span> <span data-ttu-id="88f47-111">Дополнительные сведения см. в разделе **Термины, относящиеся к глобализации и локализации** ближе к концу этого документа.</span><span class="sxs-lookup"><span data-stu-id="88f47-111">For more information see **Globalization and localization terms** near the end of this document.</span></span>

<span data-ttu-id="88f47-112">Локализация приложения включает следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="88f47-112">App localization involves the following:</span></span>

1. <span data-ttu-id="88f47-113">обеспечение возможности локализации для содержимого приложения;</span><span class="sxs-lookup"><span data-stu-id="88f47-113">Make the app's content localizable</span></span>
1. <span data-ttu-id="88f47-114">предоставление локализованных ресурсов для поддерживаемых языков и региональных параметров;</span><span class="sxs-lookup"><span data-stu-id="88f47-114">Provide localized resources for the languages and cultures you support</span></span>
1. <span data-ttu-id="88f47-115">реализацию стратегии по выбору языка и региональных параметров для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-115">Implement a strategy to select the language/culture for each request</span></span>

<span data-ttu-id="88f47-116">[Просмотреть или скачать образец кода](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/localization/sample/3.x/Localization) ([как скачивать](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="88f47-116">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/localization/sample/3.x/Localization) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="make-the-apps-content-localizable"></a><span data-ttu-id="88f47-117">Обеспечение возможности локализации для содержимого приложения</span><span class="sxs-lookup"><span data-stu-id="88f47-117">Make the app's content localizable</span></span>

<span data-ttu-id="88f47-118"><xref:Microsoft.Extensions.Localization.IStringLocalizer> и <xref:Microsoft.Extensions.Localization.IStringLocalizer%601> создавались для повышения производительность при разработке локализованных приложений.</span><span class="sxs-lookup"><span data-stu-id="88f47-118"><xref:Microsoft.Extensions.Localization.IStringLocalizer> and <xref:Microsoft.Extensions.Localization.IStringLocalizer%601> were architected to improve productivity when developing localized apps.</span></span> <span data-ttu-id="88f47-119">`IStringLocalizer` использует классы <xref:System.Resources.ResourceManager> и <xref:System.Resources.ResourceReader> для предоставления ресурсов, связанных с определенным языком и региональными параметрами, во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="88f47-119">`IStringLocalizer` uses the <xref:System.Resources.ResourceManager> and <xref:System.Resources.ResourceReader> to provide culture-specific resources at run time.</span></span> <span data-ttu-id="88f47-120">Этот интерфейс имеет индексатор и интерфейс `IEnumerable` для возврата локализованных строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-120">The interface has an indexer and an `IEnumerable` for returning localized strings.</span></span> <span data-ttu-id="88f47-121">`IStringLocalizer` не требует сохранять строки на языке по умолчанию в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-121">`IStringLocalizer` doesn't require storing the default language strings in a resource file.</span></span> <span data-ttu-id="88f47-122">Вы можете разрабатывать приложение, предназначенное для локализации, не создавая файлы ресурсов на ранних этапах разработки.</span><span class="sxs-lookup"><span data-stu-id="88f47-122">You can develop an app targeted for localization and not need to create resource files early in development.</span></span> <span data-ttu-id="88f47-123">В приведенном ниже коде показано, как подготовить строку "About Title" для локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-123">The code below shows how to wrap the string "About Title" for localization.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/AboutController.cs)]

<span data-ttu-id="88f47-124">В предыдущем коде реализация `IStringLocalizer<T>` получена в результате [внедрения зависимостей](dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="88f47-124">In the preceding code, the `IStringLocalizer<T>` implementation comes from [Dependency Injection](dependency-injection.md).</span></span> <span data-ttu-id="88f47-125">Если локализованное значение для строки "About Title" не найдено, возвращается ключ индексатора, то есть строка "About Title".</span><span class="sxs-lookup"><span data-stu-id="88f47-125">If the localized value of "About Title" isn't found, then the indexer key is returned, that is, the string "About Title".</span></span> <span data-ttu-id="88f47-126">Вы можете оставить литеральные строки на языке по умолчанию и заключить их в средство локализации, чтобы сосредоточиться на разработке приложения.</span><span class="sxs-lookup"><span data-stu-id="88f47-126">You can leave the default language literal strings in the app and wrap them in the localizer, so that you can focus on developing the app.</span></span> <span data-ttu-id="88f47-127">Вы разрабатываете приложение на языке по умолчанию и подготавливаете его к локализации, не создавая предварительно файл ресурсов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-127">You develop your app with your default language and prepare it for the localization step without first creating a default resource file.</span></span> <span data-ttu-id="88f47-128">Вы также можете выбрать традиционный подход и предоставить ключ для извлечения строки на языке по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-128">Alternatively, you can use the traditional approach and provide a key to retrieve the default language string.</span></span> <span data-ttu-id="88f47-129">Для многих разработчиков новый рабочий процесс, который не требует наличия файла *RESX* на языке по умолчанию и позволяет просто заключать строки для дальнейшей обработки, может помочь снизить затраты на локализацию приложения.</span><span class="sxs-lookup"><span data-stu-id="88f47-129">For many developers the new workflow of not having a default language *.resx* file and simply wrapping the string literals can reduce the overhead of localizing an app.</span></span> <span data-ttu-id="88f47-130">Другие разработчики могут предпочесть традиционный рабочий процесс, так как он упрощает работу с более длинными строками и обновление локализованных строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-130">Other developers will prefer the traditional work flow as it can make it easier to work with longer string literals and make it easier to update localized strings.</span></span>

<span data-ttu-id="88f47-131">Используйте реализацию `IHtmlLocalizer<T>` для ресурсов, содержащих код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-131">Use the `IHtmlLocalizer<T>` implementation for resources that contain HTML.</span></span> <span data-ttu-id="88f47-132">Интерфейс `IHtmlLocalizer` кодирует в HTML аргументы, отформатированные в строке ресурса, но не кодирует в HTML саму строку.</span><span class="sxs-lookup"><span data-stu-id="88f47-132">`IHtmlLocalizer` HTML encodes arguments that are formatted in the resource string, but doesn't HTML encode the resource string itself.</span></span> <span data-ttu-id="88f47-133">В выделенной ниже строке в HTML кодируется только значение параметра `name`.</span><span class="sxs-lookup"><span data-stu-id="88f47-133">In the sample highlighted below, only the value of `name` parameter is HTML encoded.</span></span>

[!code-csharp[](~/fundamentals/localization/sample/3.x/Localization/Controllers/BookController.cs?highlight=3,5,20&start=1&end=24)]

> [!NOTE]
> <span data-ttu-id="88f47-134">Как правило, требуется локализовать только текст, но не код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-134">Generally, only localize text, not HTML.</span></span>

<span data-ttu-id="88f47-135">На самом нижнем уровне интерфейс `IStringLocalizerFactory` можно получить из [внедрения зависимостей](dependency-injection.md):</span><span class="sxs-lookup"><span data-stu-id="88f47-135">At the lowest level, you can get `IStringLocalizerFactory` out of [Dependency Injection](dependency-injection.md):</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/TestController.cs?start=9&end=26&highlight=7-13)]

<span data-ttu-id="88f47-136">В приведенном выше коде демонстрируются оба фабричных метода создания.</span><span class="sxs-lookup"><span data-stu-id="88f47-136">The code above demonstrates each of the two factory create methods.</span></span>

<span data-ttu-id="88f47-137">Вы можете разбивать локализованные строки по контроллеру, области или использовать всего один конвейер.</span><span class="sxs-lookup"><span data-stu-id="88f47-137">You can partition your localized strings by controller, area, or have just one container.</span></span> <span data-ttu-id="88f47-138">В образце приложения для общих ресурсов применяется класс-заглушка с именем `SharedResource`.</span><span class="sxs-lookup"><span data-stu-id="88f47-138">In the sample app, a dummy class named `SharedResource` is used for shared resources.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/SharedResource.cs)]

<span data-ttu-id="88f47-139">Некоторые разработчики используют класс `Startup` для хранения глобальных или общих строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-139">Some developers use the `Startup` class to contain global or shared strings.</span></span> <span data-ttu-id="88f47-140">В примере ниже используются средства локализации `InfoController` и `SharedResource`.</span><span class="sxs-lookup"><span data-stu-id="88f47-140">In the sample below, the `InfoController` and the `SharedResource` localizers are used:</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/InfoController.cs?range=9-26)]

## <a name="view-localization"></a><span data-ttu-id="88f47-141">Локализация представления</span><span class="sxs-lookup"><span data-stu-id="88f47-141">View localization</span></span>

<span data-ttu-id="88f47-142">Служба `IViewLocalizer` предоставляет локализованные строки для [представления](xref:mvc/views/overview).</span><span class="sxs-lookup"><span data-stu-id="88f47-142">The `IViewLocalizer` service provides localized strings for a [view](xref:mvc/views/overview).</span></span> <span data-ttu-id="88f47-143">Класс `ViewLocalizer` реализует этот интерфейс и находит расположение ресурсов по пути к файлу представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-143">The `ViewLocalizer` class implements this interface and finds the resource location from the view file path.</span></span> <span data-ttu-id="88f47-144">В следующем примере кода демонстрируется использование реализации `IViewLocalizer` по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="88f47-144">The following code shows how to use the default implementation of `IViewLocalizer`:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Home/About.cshtml)]

<span data-ttu-id="88f47-145">Реализация `IViewLocalizer` по умолчанию находит файл ресурсов по имени файла представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-145">The default implementation of `IViewLocalizer` finds the resource file based on the view's file name.</span></span> <span data-ttu-id="88f47-146">Возможности использовать глобальный общий файл ресурсов нет.</span><span class="sxs-lookup"><span data-stu-id="88f47-146">There's no option to use a global shared resource file.</span></span> <span data-ttu-id="88f47-147">`ViewLocalizer` реализует средство локализации с помощью интерфейса `IHtmlLocalizer`, поэтому Razor не кодирует локализованную строку в HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-147">`ViewLocalizer` implements the localizer using `IHtmlLocalizer`, so Razor doesn't HTML encode the localized string.</span></span> <span data-ttu-id="88f47-148">Вы можете параметризовать строки ресурсов, и `IViewLocalizer` будет кодировать в HTML параметры, но не строки ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-148">You can parameterize resource strings and `IViewLocalizer` will HTML encode the parameters, but not the resource string.</span></span> <span data-ttu-id="88f47-149">Рассмотрим следующую разметку Razor:</span><span class="sxs-lookup"><span data-stu-id="88f47-149">Consider the following Razor markup:</span></span>

```cshtml
@Localizer["<i>Hello</i> <b>{0}!</b>", UserManager.GetUserName(User)]
```

<span data-ttu-id="88f47-150">Файл ресурсов на французском языке может содержать следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="88f47-150">A French resource file could contain the following:</span></span>

| <span data-ttu-id="88f47-151">Ключ</span><span class="sxs-lookup"><span data-stu-id="88f47-151">Key</span></span> | <span data-ttu-id="88f47-152">Значение</span><span class="sxs-lookup"><span data-stu-id="88f47-152">Value</span></span> |
| --- | ----- |
| `<i>Hello</i> <b>{0}!</b>` | `<i>Bonjour</i> <b>{0} !</b>` |

<span data-ttu-id="88f47-153">Преобразованное для просмотра представление будет содержать разметку HTML из файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-153">The rendered view would contain the HTML markup from the resource file.</span></span>

> [!NOTE]
> <span data-ttu-id="88f47-154">Как правило, требуется локализовать только текст, но не код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-154">Generally, only localize text, not HTML.</span></span>

<span data-ttu-id="88f47-155">Чтобы использовать в представлении общий файл ресурсов, внедрите `IHtmlLocalizer<T>`:</span><span class="sxs-lookup"><span data-stu-id="88f47-155">To use a shared resource file in a view, inject `IHtmlLocalizer<T>`:</span></span>

[!code-cshtml[](~/fundamentals/localization/sample/3.x/Localization/Views/Test/About.cshtml?highlight=5,12)]

## <a name="dataannotations-localization"></a><span data-ttu-id="88f47-156">Локализация DataAnnotations</span><span class="sxs-lookup"><span data-stu-id="88f47-156">DataAnnotations localization</span></span>

<span data-ttu-id="88f47-157">Сообщения об ошибках DataAnnotations локализуются с помощью `IStringLocalizer<T>`.</span><span class="sxs-lookup"><span data-stu-id="88f47-157">DataAnnotations error messages are localized with `IStringLocalizer<T>`.</span></span> <span data-ttu-id="88f47-158">При использовании параметра `ResourcesPath = "Resources"` сообщения об ошибках в `RegisterViewModel` могут сохраняться по одному из следующих путей:</span><span class="sxs-lookup"><span data-stu-id="88f47-158">Using the option `ResourcesPath = "Resources"`, the error messages in `RegisterViewModel` can be stored in either of the following paths:</span></span>

* <span data-ttu-id="88f47-159">*Resources/ViewModels.Account.RegisterViewModel.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-159">*Resources/ViewModels.Account.RegisterViewModel.fr.resx*</span></span>
* <span data-ttu-id="88f47-160">*Resources/ViewModels/Account/RegisterViewModel.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-160">*Resources/ViewModels/Account/RegisterViewModel.fr.resx*</span></span>

[!code-csharp[](localization/sample/3.x/Localization/ViewModels/Account/RegisterViewModel.cs?start=9&end=26)]

<span data-ttu-id="88f47-161">В ASP.NET Core MVC 1.1.0 и более поздних версиях атрибуты, не относящиеся в проверке, локализуются.</span><span class="sxs-lookup"><span data-stu-id="88f47-161">In ASP.NET Core MVC 1.1.0 and higher, non-validation attributes are localized.</span></span> <span data-ttu-id="88f47-162">В ASP.NET Core MVC 1.0 **не** производится поиск локализованных строк для атрибутов, не относящихся к проверке.</span><span class="sxs-lookup"><span data-stu-id="88f47-162">ASP.NET Core MVC 1.0 does **not** look up localized strings for non-validation attributes.</span></span>

<a name="one-resource-string-multiple-classes"></a>

### <a name="using-one-resource-string-for-multiple-classes"></a><span data-ttu-id="88f47-163">Использование одной строки ресурса для нескольких классов</span><span class="sxs-lookup"><span data-stu-id="88f47-163">Using one resource string for multiple classes</span></span>

<span data-ttu-id="88f47-164">В следующем коде показано, как использовать одну строку ресурса для атрибутов проверки с несколькими классами:</span><span class="sxs-lookup"><span data-stu-id="88f47-164">The following code shows how to use one resource string for validation attributes with multiple classes:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc()
        .AddDataAnnotationsLocalization(options => {
            options.DataAnnotationLocalizerProvider = (type, factory) =>
                factory.Create(typeof(SharedResource));
        });
}
```

<span data-ttu-id="88f47-165">В предыдущем коде `SharedResource` — это класс, соответствующий файлу RESX, в котором хранятся сообщения о проверке.</span><span class="sxs-lookup"><span data-stu-id="88f47-165">In the preceding code, `SharedResource` is the class corresponding to the resx where your validation messages are stored.</span></span> <span data-ttu-id="88f47-166">При таком подходе DataAnnotations будут использовать только `SharedResource`, а не ресурс для каждого класса.</span><span class="sxs-lookup"><span data-stu-id="88f47-166">With this approach, DataAnnotations will only use `SharedResource`, rather than the resource for each class.</span></span>

## <a name="provide-localized-resources-for-the-languages-and-cultures-you-support"></a><span data-ttu-id="88f47-167">Предоставление локализованных ресурсов для поддерживаемых языков и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="88f47-167">Provide localized resources for the languages and cultures you support</span></span>

### <a name="supportedcultures-and-supporteduicultures"></a><span data-ttu-id="88f47-168">SupportedCultures и SupportedUICultures</span><span class="sxs-lookup"><span data-stu-id="88f47-168">SupportedCultures and SupportedUICultures</span></span>

<span data-ttu-id="88f47-169">ASP.NET Core позволяет указывать два значения языка и региональных параметров: `SupportedCultures` и `SupportedUICultures`.</span><span class="sxs-lookup"><span data-stu-id="88f47-169">ASP.NET Core allows you to specify two culture values, `SupportedCultures` and `SupportedUICultures`.</span></span> <span data-ttu-id="88f47-170">Объект [CultureInfo](/dotnet/api/system.globalization.cultureinfo) для `SupportedCultures` определяет результаты функций, зависящих от языка и региональных параметров: форматирование дат, времени, чисел, денежных единиц и т. д.</span><span class="sxs-lookup"><span data-stu-id="88f47-170">The [CultureInfo](/dotnet/api/system.globalization.cultureinfo) object for `SupportedCultures` determines the results of culture-dependent functions, such as date, time, number, and currency formatting.</span></span> <span data-ttu-id="88f47-171">`SupportedCultures` также определяет порядок сортировки текста, соглашения о регистре символов и способы сравнения строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-171">`SupportedCultures` also determines the sorting order of text, casing conventions, and string comparisons.</span></span> <span data-ttu-id="88f47-172">Дополнительные сведения о получении сервером значения языка и региональных параметров см. в описании свойства [CultureInfo.CurrentCulture](/dotnet/api/system.stringcomparer.currentculture#System_StringComparer_CurrentCulture).</span><span class="sxs-lookup"><span data-stu-id="88f47-172">See [CultureInfo.CurrentCulture](/dotnet/api/system.stringcomparer.currentculture#System_StringComparer_CurrentCulture) for more info on how the server gets the Culture.</span></span> <span data-ttu-id="88f47-173">Значение `SupportedUICultures` определяет то, какие строки переводов (в файле *RESX*) ищет объект [ResourceManager](/dotnet/api/system.resources.resourcemanager).</span><span class="sxs-lookup"><span data-stu-id="88f47-173">The `SupportedUICultures` determines which translated strings (from *.resx* files) are looked up by the [ResourceManager](/dotnet/api/system.resources.resourcemanager).</span></span> <span data-ttu-id="88f47-174">`ResourceManager` ищет связанные с языком и региональными параметрами строки, которые определяются значением `CurrentUICulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-174">The `ResourceManager` simply looks up culture-specific strings that's determined by `CurrentUICulture`.</span></span> <span data-ttu-id="88f47-175">Каждый поток в .NET имеет объекты `CurrentCulture` и `CurrentUICulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-175">Every thread in .NET has `CurrentCulture` and `CurrentUICulture` objects.</span></span> <span data-ttu-id="88f47-176">ASP.NET Core проверяет эти значения при обработке функций, зависящих от языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-176">ASP.NET Core inspects these values when rendering culture-dependent functions.</span></span> <span data-ttu-id="88f47-177">Например, если для текущего потока заданы язык и региональные параметры "en-US" (английский, США), метод `DateTime.Now.ToLongDateString()` выводит строку "Thursday, February 18, 2016", но если `CurrentCulture` имеет значение "ru-RU" (русский, Россия), выводится строка "четверг, 18 февраля 2016 г."</span><span class="sxs-lookup"><span data-stu-id="88f47-177">For example, if the current thread's culture is set to "en-US" (English, United States), `DateTime.Now.ToLongDateString()` displays "Thursday, February 18, 2016", but if `CurrentCulture` is set to "es-ES" (Spanish, Spain) the output will be "jueves, 18 de febrero de 2016".</span></span>

## <a name="resource-files"></a><span data-ttu-id="88f47-178">Файлы ресурсов</span><span class="sxs-lookup"><span data-stu-id="88f47-178">Resource files</span></span>

<span data-ttu-id="88f47-179">Файл ресурсов — это полезное средство для отделения локализуемых строк от кода.</span><span class="sxs-lookup"><span data-stu-id="88f47-179">A resource file is a useful mechanism for separating localizable strings from code.</span></span> <span data-ttu-id="88f47-180">Переведенные строки на языках, отличных от языка по умолчанию, содержатся в отдельных файлах ресурсов с расширением *RESX*.</span><span class="sxs-lookup"><span data-stu-id="88f47-180">Translated strings for the non-default language are isolated in *.resx* resource files.</span></span> <span data-ttu-id="88f47-181">Например, вам нужно создать файл ресурсов для испанского языка с именем *Welcome.es.resx*, который будет содержать переведенные строки.</span><span class="sxs-lookup"><span data-stu-id="88f47-181">For example, you might want to create Spanish resource file named *Welcome.es.resx* containing translated strings.</span></span> <span data-ttu-id="88f47-182">"es" — это код испанского языка.</span><span class="sxs-lookup"><span data-stu-id="88f47-182">"es" is the language code for Spanish.</span></span> <span data-ttu-id="88f47-183">Чтобы создать этот файл ресурсов в Visual Studio, выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="88f47-183">To create this resource file in Visual Studio:</span></span>

1. <span data-ttu-id="88f47-184">В **обозревателе решений** щелкните правой кнопкой мыши папку, которая будет содержать файл ресурсов, а затем выберите пункты **Добавить** > **Новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="88f47-184">In **Solution Explorer**, right click on the folder which will contain the resource file > **Add** > **New Item**.</span></span>

   ![Вложенное контекстное меню: в обозревателе решений контекстное меню открывается для папки ресурсов.](localization/_static/newi.png)

1. <span data-ttu-id="88f47-187">В поле **Поиск установленных шаблонов** введите слово "ресурс" и укажите имя файла.</span><span class="sxs-lookup"><span data-stu-id="88f47-187">In the **Search installed templates** box, enter "resource" and name the file.</span></span>

   ![Диалоговое окно ''Добавление нового элемента''](localization/_static/res.png)

1. <span data-ttu-id="88f47-189">Введите значение ключа (строку на исходном языке) в столбце **Имя** и переведенную строку в столбце **Значение**.</span><span class="sxs-lookup"><span data-stu-id="88f47-189">Enter the key value (native string) in the **Name** column and the translated string in the **Value** column.</span></span>

   ![Файл Welcome.es.resx (файлов ресурсов с приветствиями на испанском языке) со словом "Hello" в столбце "Имя" и словом "Hol"a ("Hello" на испанском) в столбце "Значение"](localization/_static/hola.png)

   <span data-ttu-id="88f47-191">В Visual Studio отобразится файл *Welcome.es.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-191">Visual Studio shows the *Welcome.es.resx* file.</span></span>

   ![Обозреватель решений с файлом ресурсов на испанском языке](localization/_static/se.png)

## <a name="resource-file-naming"></a><span data-ttu-id="88f47-193">Именование файлов ресурсов</span><span class="sxs-lookup"><span data-stu-id="88f47-193">Resource file naming</span></span>

<span data-ttu-id="88f47-194">Имена ресурсов представляют собой полные имена типов соответствующего класса за исключением имени сборки.</span><span class="sxs-lookup"><span data-stu-id="88f47-194">Resources are named for the full type name of their class minus the assembly name.</span></span> <span data-ttu-id="88f47-195">Например, ресурс на французском языке в проекте, главная сборка которого имеет имя `LocalizationWebsite.Web.dll`, для класса `LocalizationWebsite.Web.Startup` будет иметь имя *Startup.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-195">For example, a French resource in a project whose main assembly is `LocalizationWebsite.Web.dll` for the class `LocalizationWebsite.Web.Startup` would be named *Startup.fr.resx*.</span></span> <span data-ttu-id="88f47-196">Ресурс для класса `LocalizationWebsite.Web.Controllers.HomeController` будет иметь имя *Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-196">A resource for the class `LocalizationWebsite.Web.Controllers.HomeController` would be named *Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-197">Если пространство имен целевого класса не совпадает с именем сборки, необходимо использовать полное имя типа.</span><span class="sxs-lookup"><span data-stu-id="88f47-197">If your targeted class's namespace isn't the same as the assembly name you will need the full type name.</span></span> <span data-ttu-id="88f47-198">Например, в образце проекта ресурс для типа `ExtraNamespace.Tools` будет иметь имя *ExtraNamespace.Tools.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-198">For example, in the sample project a resource for the type `ExtraNamespace.Tools` would be named *ExtraNamespace.Tools.fr.resx*.</span></span>

<span data-ttu-id="88f47-199">В образце проекта метод `ConfigureServices` присваивает свойству `ResourcesPath` значение "Resources", поэтому относительный путь к файлу ресурсов на французском языке для контроллера домашней страницы в проекте будет иметь вид *Resources/Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-199">In the sample project, the `ConfigureServices` method sets the `ResourcesPath` to "Resources", so the project relative path for the home controller's French resource file is *Resources/Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-200">Кроме того, для упорядочения файлов ресурсов можно использовать папки.</span><span class="sxs-lookup"><span data-stu-id="88f47-200">Alternatively, you can use folders to organize resource files.</span></span> <span data-ttu-id="88f47-201">Для контроллера домашней страницы путь будет иметь вид *Resources/Controllers/HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-201">For the home controller, the path would be *Resources/Controllers/HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-202">Если параметр `ResourcesPath` не используется, файл *RESX* будет находиться в базовом каталоге проекта.</span><span class="sxs-lookup"><span data-stu-id="88f47-202">If you don't use the `ResourcesPath` option, the *.resx* file would go in the project base directory.</span></span> <span data-ttu-id="88f47-203">Файл ресурса для `HomeController` будет иметь имя *Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-203">The resource file for `HomeController` would be named *Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-204">Выбор соглашения об именовании на основе точечной нотации или пути зависит от того, как следует упорядочивать файлы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-204">The choice of using the dot or path naming convention depends on how you want to organize your resource files.</span></span>

| <span data-ttu-id="88f47-205">Имя ресурса</span><span class="sxs-lookup"><span data-stu-id="88f47-205">Resource name</span></span> | <span data-ttu-id="88f47-206">Точечная нотация или путь</span><span class="sxs-lookup"><span data-stu-id="88f47-206">Dot or path naming</span></span> |
| ------------   | ------------- |
| <span data-ttu-id="88f47-207">Resources/Controllers.HomeController.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-207">Resources/Controllers.HomeController.fr.resx</span></span> | <span data-ttu-id="88f47-208">Точки</span><span class="sxs-lookup"><span data-stu-id="88f47-208">Dot</span></span>  |
| <span data-ttu-id="88f47-209">Resources/Controllers/HomeController.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-209">Resources/Controllers/HomeController.fr.resx</span></span>  | <span data-ttu-id="88f47-210">Path</span><span class="sxs-lookup"><span data-stu-id="88f47-210">Path</span></span> |

<span data-ttu-id="88f47-211">Файлы ресурсов, для которых используется директива `@inject IViewLocalizer` в представлениях Razor, следуют той же модели.</span><span class="sxs-lookup"><span data-stu-id="88f47-211">Resource files using `@inject IViewLocalizer` in Razor views follow a similar pattern.</span></span> <span data-ttu-id="88f47-212">Файлу ресурсов для представления может присваиваться имя на основе либо точечной нотации, либо пути.</span><span class="sxs-lookup"><span data-stu-id="88f47-212">The resource file for a view can be named using either dot naming or path naming.</span></span> <span data-ttu-id="88f47-213">В файле ресурсов для представления Razor имитируется путь к связанному файлу представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-213">Razor view resource files mimic the path of their associated view file.</span></span> <span data-ttu-id="88f47-214">Допустим, свойству `ResourcesPath` присвоено значение "Resources". В этом случае файл ресурсов на французском языке, связанный с представлением *Views/Home/About.cshtml*, может иметь одно из следующих имен:</span><span class="sxs-lookup"><span data-stu-id="88f47-214">Assuming we set the `ResourcesPath` to "Resources", the French resource file associated with the *Views/Home/About.cshtml* view could be either of the following:</span></span>

* <span data-ttu-id="88f47-215">Resources/Views/Home/About.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-215">Resources/Views/Home/About.fr.resx</span></span>

* <span data-ttu-id="88f47-216">Resources/Views.Home.About.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-216">Resources/Views.Home.About.fr.resx</span></span>

<span data-ttu-id="88f47-217">Если параметр `ResourcesPath` не используется, файл *RESX* для представления будет находиться в той же папке, что и представление.</span><span class="sxs-lookup"><span data-stu-id="88f47-217">If you don't use the `ResourcesPath` option, the *.resx* file for a view would be located in the same folder as the view.</span></span>

### <a name="rootnamespaceattribute"></a><span data-ttu-id="88f47-218">RootNamespaceAttribute</span><span class="sxs-lookup"><span data-stu-id="88f47-218">RootNamespaceAttribute</span></span> 

<span data-ttu-id="88f47-219">Атрибут [RootNamespace](/dotnet/api/microsoft.extensions.localization.rootnamespaceattribute?view=aspnetcore-2.1) содержит корневое пространство имен сборки, если корневое пространство имен сборки отличается от имени сборки.</span><span class="sxs-lookup"><span data-stu-id="88f47-219">The [RootNamespace](/dotnet/api/microsoft.extensions.localization.rootnamespaceattribute?view=aspnetcore-2.1) attribute provides the root namespace of an assembly when the root namespace of an assembly is different than the assembly name.</span></span> 

> [!WARNING]
> <span data-ttu-id="88f47-220">Это может произойти, если имя проекта — недопустимый идентификатор .NET.</span><span class="sxs-lookup"><span data-stu-id="88f47-220">This can occur when a project's name is not a valid .NET identifier.</span></span> <span data-ttu-id="88f47-221">Например, `my-project-name.csproj` будет использовать корневое пространство имен `my_project_name` и имя сборки `my-project-name`, что повлечет эту ошибку.</span><span class="sxs-lookup"><span data-stu-id="88f47-221">For instance `my-project-name.csproj` will use the root namespace `my_project_name` and the assembly name `my-project-name` leading to this error.</span></span> 

<span data-ttu-id="88f47-222">Если корневое пространство имен сборки отличается от имени сборки</span><span class="sxs-lookup"><span data-stu-id="88f47-222">If the root namespace of an assembly is different than the assembly name:</span></span>

* <span data-ttu-id="88f47-223">Локализация не работает по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-223">Localization does not work by default.</span></span>
* <span data-ttu-id="88f47-224">Локализация завершается сбоем из-за метода поиска ресурсов в сборке.</span><span class="sxs-lookup"><span data-stu-id="88f47-224">Localization fails due to the way resources are searched for within the assembly.</span></span> <span data-ttu-id="88f47-225">`RootNamespace` — это значение во время сборки, которое недоступно выполняющемуся процессу.</span><span class="sxs-lookup"><span data-stu-id="88f47-225">`RootNamespace` is a build-time value which is not available to the executing process.</span></span> 

<span data-ttu-id="88f47-226">Если `RootNamespace` отличается от `AssemblyName`, включите следующее в файл *AssemblyInfo.cs* (со значениями параметров, замененными фактическими значениями).</span><span class="sxs-lookup"><span data-stu-id="88f47-226">If the `RootNamespace` is different from the `AssemblyName`, include the following in *AssemblyInfo.cs* (with parameter values replaced with the actual values):</span></span>

```csharp
using System.Reflection;
using Microsoft.Extensions.Localization;

[assembly: ResourceLocation("Resource Folder Name")]
[assembly: RootNamespace("App Root Namespace")]
```

<span data-ttu-id="88f47-227">Приведенный выше код обеспечивает успешное разрешение RESX-файлов.</span><span class="sxs-lookup"><span data-stu-id="88f47-227">The preceding code enables the successful resolution of resx files.</span></span>

## <a name="culture-fallback-behavior"></a><span data-ttu-id="88f47-228">Резервный язык и региональные параметры</span><span class="sxs-lookup"><span data-stu-id="88f47-228">Culture fallback behavior</span></span>

<span data-ttu-id="88f47-229">При поиске ресурса локализации использует резервный язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-229">When searching for a resource, localization engages in "culture fallback".</span></span> <span data-ttu-id="88f47-230">Если запрошенный язык и региональные параметры не найдены, используется родительский язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-230">Starting from the requested culture, if not found, it reverts to the parent culture of that culture.</span></span> <span data-ttu-id="88f47-231">Кстати, родительский язык и региональные параметры представляют свойство [CultureInfo.Parent](/dotnet/api/system.globalization.cultureinfo.parent).</span><span class="sxs-lookup"><span data-stu-id="88f47-231">As an aside, the [CultureInfo.Parent](/dotnet/api/system.globalization.cultureinfo.parent) property represents the parent culture.</span></span> <span data-ttu-id="88f47-232">Обычно (но не всегда) это означает удаление национального символа из ISO.</span><span class="sxs-lookup"><span data-stu-id="88f47-232">This usually (but not always) means removing the national signifier from the ISO.</span></span> <span data-ttu-id="88f47-233">Например, диалект испанского в Мексике — es-MX.</span><span class="sxs-lookup"><span data-stu-id="88f47-233">For example, the dialect of Spanish spoken in Mexico is "es-MX".</span></span> <span data-ttu-id="88f47-234">Родительский элемент "es" (испанский) не относится к той или иной стране.</span><span class="sxs-lookup"><span data-stu-id="88f47-234">It has the parent "es"&mdash;Spanish non-specific to any country.</span></span>

<span data-ttu-id="88f47-235">Допустим, сайт получает запрос на ресурс "Приветствие" с использованием языка и региональных параметров fr-CA.</span><span class="sxs-lookup"><span data-stu-id="88f47-235">Imagine your site receives a request for a "Welcome" resource using culture "fr-CA".</span></span> <span data-ttu-id="88f47-236">Система локализации ищет в следующих ресурсах по порядку и выбирает первое совпадение:</span><span class="sxs-lookup"><span data-stu-id="88f47-236">The localization system looks for the following resources, in order, and selects the first match:</span></span>

* <span data-ttu-id="88f47-237">*Welcome.fr-CA.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-237">*Welcome.fr-CA.resx*</span></span>
* <span data-ttu-id="88f47-238">*Welcome.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-238">*Welcome.fr.resx*</span></span>
* <span data-ttu-id="88f47-239">*Welcome.resx* (если `NeutralResourcesLanguage` — fr-CA)</span><span class="sxs-lookup"><span data-stu-id="88f47-239">*Welcome.resx* (if the `NeutralResourcesLanguage` is "fr-CA")</span></span>

<span data-ttu-id="88f47-240">Если вы удалите указатель языка и региональных параметров ".fr" и при этом задан французский язык и региональные параметры, будет считан файл ресурсов по умолчанию и строки локализуются.</span><span class="sxs-lookup"><span data-stu-id="88f47-240">As an example, if you remove the ".fr" culture designator and you have the culture set to French, the default resource file is read and strings are localized.</span></span> <span data-ttu-id="88f47-241">Диспетчер ресурсов назначает ресурс по умолчанию или резервный ресурс на тот случай, когда соответствия запрошенному языку и региональным параметрам не найдено.</span><span class="sxs-lookup"><span data-stu-id="88f47-241">The Resource manager designates a default or fallback resource for when nothing meets your requested culture.</span></span> <span data-ttu-id="88f47-242">Если нужно, чтобы при отсутствии ресурса для запрошенного языка и региональных параметров просто возвращался ключ, не используйте файл ресурсов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-242">If you want to just return the key when missing a resource for the requested culture you must not have a default resource file.</span></span>

### <a name="generate-resource-files-with-visual-studio"></a><span data-ttu-id="88f47-243">Создание файлов ресурсов с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88f47-243">Generate resource files with Visual Studio</span></span>

<span data-ttu-id="88f47-244">Если вы создаете в Visual Studio файл ресурсов, в имени которого не указаны язык и региональные параметры (например, *Welcome.resx*), Visual Studio создаст класс C# со свойством для каждой строки.</span><span class="sxs-lookup"><span data-stu-id="88f47-244">If you create a resource file in Visual Studio without a culture in the file name (for example, *Welcome.resx*), Visual Studio will create a C# class with a property for each string.</span></span> <span data-ttu-id="88f47-245">В ASP.NET Core обычно требуется иное поведение.</span><span class="sxs-lookup"><span data-stu-id="88f47-245">That's usually not what you want with ASP.NET Core.</span></span> <span data-ttu-id="88f47-246">Как правило, файл ресурсов *RESX* по умолчанию (файл *RESX* без указания языка и региональных параметров) не используется.</span><span class="sxs-lookup"><span data-stu-id="88f47-246">You typically don't have a default *.resx* resource file (a *.resx* file without the culture name).</span></span> <span data-ttu-id="88f47-247">Мы рекомендуем создать файл *RESX* с указанием языка и региональных параметров (например, *Welcome.fr.resx*).</span><span class="sxs-lookup"><span data-stu-id="88f47-247">We suggest you create the *.resx* file with a culture name (for example *Welcome.fr.resx*).</span></span> <span data-ttu-id="88f47-248">При создании файла *RESX* с указанием языка и региональных параметров среда Visual Studio не создает файл класса.</span><span class="sxs-lookup"><span data-stu-id="88f47-248">When you create a *.resx* file with a culture name, Visual Studio won't generate the class file.</span></span>

### <a name="add-other-cultures"></a><span data-ttu-id="88f47-249">Добавление других языков и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="88f47-249">Add other cultures</span></span>

<span data-ttu-id="88f47-250">Каждое сочетание языка и региональных параметров (кроме языка по умолчанию) требует уникального файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-250">Each language and culture combination (other than the default language) requires a unique resource file.</span></span> <span data-ttu-id="88f47-251">Создавая файлы ресурсов для разных языков, языковых стандартов и региональных параметров, вы включаете в их имена коды языков ISO (например, **en-us**, **ru-ru** и **fr-ca**).</span><span class="sxs-lookup"><span data-stu-id="88f47-251">You create resource files for different cultures and locales by creating new resource files in which the ISO language codes are part of the file name (for example, **en-us**, **fr-ca**, and **en-gb**).</span></span> <span data-ttu-id="88f47-252">Эти коды ISO помещаются между именем файла и расширением *RESX*, например *Welcome.es-MX.resx* (испанский, Мексика).</span><span class="sxs-lookup"><span data-stu-id="88f47-252">These ISO codes are placed between the file name and the *.resx* file extension, as in *Welcome.es-MX.resx* (Spanish/Mexico).</span></span>

## <a name="implement-a-strategy-to-select-the-languageculture-for-each-request"></a><span data-ttu-id="88f47-253">реализацию стратегии по выбору языка и региональных параметров для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-253">Implement a strategy to select the language/culture for each request</span></span>

### <a name="configure-localization"></a><span data-ttu-id="88f47-254">Настройка локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-254">Configure localization</span></span>

<span data-ttu-id="88f47-255">Локализация настраивается в методе `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="88f47-255">Localization is configured in the `Startup.ConfigureServices` method:</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Startup.cs?name=snippet1)]

* <span data-ttu-id="88f47-256">Метод `AddLocalization` добавляет службы локализации в контейнер служб.</span><span class="sxs-lookup"><span data-stu-id="88f47-256">`AddLocalization` adds the localization services to the services container.</span></span> <span data-ttu-id="88f47-257">В приведенном выше коде также задается путь к ресурсам "Resources".</span><span class="sxs-lookup"><span data-stu-id="88f47-257">The code above also sets the resources path to "Resources".</span></span>

* <span data-ttu-id="88f47-258">Метод `AddViewLocalization` добавляет поддержку файлов локализованных представлений.</span><span class="sxs-lookup"><span data-stu-id="88f47-258">`AddViewLocalization` adds support for localized view files.</span></span> <span data-ttu-id="88f47-259">В этом примере локализация образца представления основана на суффиксе файла представления,</span><span class="sxs-lookup"><span data-stu-id="88f47-259">In this sample view localization is based on the view file suffix.</span></span> <span data-ttu-id="88f47-260">например "fr" в файле *Index.fr.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="88f47-260">For example "fr" in the *Index.fr.cshtml* file.</span></span>

* <span data-ttu-id="88f47-261">Метод `AddDataAnnotationsLocalization` добавляет поддержку локализованных сообщений проверки `DataAnnotations` посредством абстракций `IStringLocalizer`.</span><span class="sxs-lookup"><span data-stu-id="88f47-261">`AddDataAnnotationsLocalization` adds support for localized `DataAnnotations` validation messages through `IStringLocalizer` abstractions.</span></span>

### <a name="localization-middleware"></a><span data-ttu-id="88f47-262">Промежуточный слой локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-262">Localization middleware</span></span>

<span data-ttu-id="88f47-263">Текущий язык и региональные параметры в запросе задаются в [промежуточном слое](xref:fundamentals/middleware/index) локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-263">The current culture on a request is set in the localization [Middleware](xref:fundamentals/middleware/index).</span></span> <span data-ttu-id="88f47-264">Промежуточный слой локализации включается в методе `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="88f47-264">The localization middleware is enabled in the `Startup.Configure` method.</span></span> <span data-ttu-id="88f47-265">Промежуточный слой локализации должен настраиваться перед другими промежуточными слоями, которые могут проверять язык и региональные параметры запроса (например, `app.UseMvcWithDefaultRoute()`).</span><span class="sxs-lookup"><span data-stu-id="88f47-265">The localization middleware must be configured before any middleware which might check the request culture (for example, `app.UseMvcWithDefaultRoute()`).</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Startup.cs?name=snippet2)]

[!INCLUDE[about the series](~/includes/code-comments-loc.md)]

<span data-ttu-id="88f47-266">`UseRequestLocalization` инициализирует объект `RequestLocalizationOptions`.</span><span class="sxs-lookup"><span data-stu-id="88f47-266">`UseRequestLocalization` initializes a `RequestLocalizationOptions` object.</span></span> <span data-ttu-id="88f47-267">При каждом запросе проверяется список поставщиков `RequestCultureProvider` в объекте `RequestLocalizationOptions` и используется первый поставщик, который может успешно определить язык и региональные параметры запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-267">On every request the list of `RequestCultureProvider` in the `RequestLocalizationOptions` is enumerated and the first provider that can successfully determine the request culture is used.</span></span> <span data-ttu-id="88f47-268">Поставщики по умолчанию берутся из класса `RequestLocalizationOptions`:</span><span class="sxs-lookup"><span data-stu-id="88f47-268">The default providers come from the `RequestLocalizationOptions` class:</span></span>

1. `QueryStringRequestCultureProvider`
1. `CookieRequestCultureProvider`
1. `AcceptLanguageHeaderRequestCultureProvider`

<span data-ttu-id="88f47-269">В списке по умолчанию поставщики следуют от наиболее конкретных до наиболее общих.</span><span class="sxs-lookup"><span data-stu-id="88f47-269">The default list goes from most specific to least specific.</span></span> <span data-ttu-id="88f47-270">Далее в этой статье вы узнаете, как можно изменить этот порядок и даже добавить пользовательский поставщик языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-270">Later in the article we'll see how you can change the order and even add a custom culture provider.</span></span> <span data-ttu-id="88f47-271">Если ни один из поставщиков не может определить язык и региональные параметры запроса, используется `DefaultRequestCulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-271">If none of the providers can determine the request culture, the `DefaultRequestCulture` is used.</span></span>

### <a name="querystringrequestcultureprovider"></a><span data-ttu-id="88f47-272">QueryStringRequestCultureProvider</span><span class="sxs-lookup"><span data-stu-id="88f47-272">QueryStringRequestCultureProvider</span></span>

<span data-ttu-id="88f47-273">Некоторые приложения используют строку запроса для указания <https://docs.microsoft.com/dotnet/api/system.globalization.cultureinfo?view=netcore-3.1>.</span><span class="sxs-lookup"><span data-stu-id="88f47-273">Some apps will use a query string to set the <https://docs.microsoft.com/dotnet/api/system.globalization.cultureinfo?view=netcore-3.1>.</span></span> <span data-ttu-id="88f47-274">Если в приложении для этого применяется файл cookie или заголовок Accept-Language, добавление строки запроса к URL-адресу может быть полезным в целях отладки и тестирования кода.</span><span class="sxs-lookup"><span data-stu-id="88f47-274">For apps that use the cookie or Accept-Language header approach, adding a query string to the URL is useful for debugging and testing code.</span></span> <span data-ttu-id="88f47-275">По умолчанию поставщик `QueryStringRequestCultureProvider` регистрируется в качестве первого поставщика локализации в списке `RequestCultureProvider`.</span><span class="sxs-lookup"><span data-stu-id="88f47-275">By default, the `QueryStringRequestCultureProvider` is registered as the first localization provider in the `RequestCultureProvider` list.</span></span> <span data-ttu-id="88f47-276">Вы передаете параметры строки запроса `culture` и `ui-culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-276">You pass the query string parameters `culture` and `ui-culture`.</span></span> <span data-ttu-id="88f47-277">В следующем примере в качестве языка и региональных параметров (язык и регион) задаются испанский язык и Мексика:</span><span class="sxs-lookup"><span data-stu-id="88f47-277">The following example sets the specific culture (language and region) to Spanish/Mexico:</span></span>

   `http://localhost:5000/?culture=es-MX&ui-culture=es-MX`

<span data-ttu-id="88f47-278">Если передан только один из двух параметров (`culture` или `ui-culture`), поставщик строки запроса задаст с его помощью оба значения.</span><span class="sxs-lookup"><span data-stu-id="88f47-278">If you only pass in one of the two (`culture` or `ui-culture`), the query string provider will set both values using the one you passed in.</span></span> <span data-ttu-id="88f47-279">Например, если передан только язык и региональные параметры, будут заданы оба значения `Culture` и `UICulture`:</span><span class="sxs-lookup"><span data-stu-id="88f47-279">For example, setting just the culture will set both the `Culture` and the `UICulture`:</span></span>

```
http://localhost:5000/?culture=es-MX
```

### <a name="no-loccookierequestcultureprovider"></a><span data-ttu-id="88f47-280">CookieRequestCultureProvider</span><span class="sxs-lookup"><span data-stu-id="88f47-280">CookieRequestCultureProvider</span></span>

<span data-ttu-id="88f47-281">Рабочие приложения часто предоставляют механизм для указания языка и региональных параметров с помощью соответствующего файла cookie ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88f47-281">Production apps will often provide a mechanism to set the culture with the ASP.NET Core culture cookie.</span></span> <span data-ttu-id="88f47-282">Чтобы создать файл `MakeCookieValue`, используйте метод cookie.</span><span class="sxs-lookup"><span data-stu-id="88f47-282">Use the `MakeCookieValue` method to create a cookie.</span></span>

<span data-ttu-id="88f47-283">`CookieRequestCultureProvider` `DefaultCookieName` возвращает имя файла cookie по умолчанию, с помощью которого отслеживается предпочтительный язык и региональные параметры пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-283">The `CookieRequestCultureProvider` `DefaultCookieName` returns the default cookie name used to track the user's preferred culture information.</span></span> <span data-ttu-id="88f47-284">Имя cookie по умолчанию — `.AspNetCore.Culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-284">The default cookie name is `.AspNetCore.Culture`.</span></span>

<span data-ttu-id="88f47-285">Файл cookie имеет формат `c=%LANGCODE%|uic=%LANGCODE%`, где `c` — это `Culture`, а `uic` — это `UICulture`, например:</span><span class="sxs-lookup"><span data-stu-id="88f47-285">The cookie format is `c=%LANGCODE%|uic=%LANGCODE%`, where `c` is `Culture` and `uic` is `UICulture`, for example:</span></span>

```
c=en-UK|uic=en-US
```

<span data-ttu-id="88f47-286">Если указаны либо только язык и региональные параметры, либо только язык и региональные параметры пользовательского интерфейса, это значение будет использоваться для обоих параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-286">If you only specify one of culture info and UI culture, the specified culture will be used for both culture info and UI culture.</span></span>

### <a name="the-accept-language-http-header"></a><span data-ttu-id="88f47-287">Заголовок HTTP Accept-Language</span><span class="sxs-lookup"><span data-stu-id="88f47-287">The Accept-Language HTTP header</span></span>

<span data-ttu-id="88f47-288">[Заголовок Accept-Language](https://www.w3.org/International/questions/qa-accept-lang-locales) может задаваться в большинстве браузеров и изначально предназначался для указания языка пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-288">The [Accept-Language header](https://www.w3.org/International/questions/qa-accept-lang-locales) is settable in most browsers and was originally intended to specify the user's language.</span></span> <span data-ttu-id="88f47-289">Он показывает, какой язык был выбран в браузере или унаследован от базовой операционной системы.</span><span class="sxs-lookup"><span data-stu-id="88f47-289">This setting indicates what the browser has been set to send or has inherited from the underlying operating system.</span></span> <span data-ttu-id="88f47-290">Заголовок HTTP Accept-Language в запросе из браузера — это не самый надежный способ определения предпочтительного языка пользователя (см. статью [Настройка языковых предпочтений в браузере](https://www.w3.org/International/questions/qa-lang-priorities.en.php)).</span><span class="sxs-lookup"><span data-stu-id="88f47-290">The Accept-Language HTTP header from a browser request isn't an infallible way to detect the user's preferred language (see [Setting language preferences in a browser](https://www.w3.org/International/questions/qa-lang-priorities.en.php)).</span></span> <span data-ttu-id="88f47-291">В рабочем приложении должна быть возможность выбора языка и региональных параметров пользователем.</span><span class="sxs-lookup"><span data-stu-id="88f47-291">A production app should include a way for a user to customize their choice of culture.</span></span>

### <a name="set-the-accept-language-http-header-in-ie"></a><span data-ttu-id="88f47-292">Задание заголовка HTTP Accept-Language в Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="88f47-292">Set the Accept-Language HTTP header in IE</span></span>

1. <span data-ttu-id="88f47-293">Щелкните значок шестеренки и выберите пункт **Свойства браузера**.</span><span class="sxs-lookup"><span data-stu-id="88f47-293">From the gear icon, tap **Internet Options**.</span></span>

1. <span data-ttu-id="88f47-294">Нажмите кнопку **Языки**.</span><span class="sxs-lookup"><span data-stu-id="88f47-294">Tap **Languages**.</span></span>

   ![Свойства браузера](localization/_static/lang.png)

1. <span data-ttu-id="88f47-296">Нажмите **Задать предпочитаемые языки**.</span><span class="sxs-lookup"><span data-stu-id="88f47-296">Tap **Set Language Preferences**.</span></span>

1. <span data-ttu-id="88f47-297">Нажмите **Добавить язык**.</span><span class="sxs-lookup"><span data-stu-id="88f47-297">Tap **Add a language**.</span></span>

1. <span data-ttu-id="88f47-298">Добавьте язык.</span><span class="sxs-lookup"><span data-stu-id="88f47-298">Add the language.</span></span>

1. <span data-ttu-id="88f47-299">Выберите язык, а затем нажмите кнопку **Вверх**.</span><span class="sxs-lookup"><span data-stu-id="88f47-299">Tap the language, then tap **Move Up**.</span></span>

### <a name="use-a-custom-provider"></a><span data-ttu-id="88f47-300">Использование пользовательского поставщика</span><span class="sxs-lookup"><span data-stu-id="88f47-300">Use a custom provider</span></span>

<span data-ttu-id="88f47-301">Предположим, необходимо, чтобы ваши клиенты могли сохранять информацию о своем языке и региональных параметрах в ваших базах данных.</span><span class="sxs-lookup"><span data-stu-id="88f47-301">Suppose you want to let your customers store their language and culture in your databases.</span></span> <span data-ttu-id="88f47-302">Можно написать поставщик, который будет искать эти значения для пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-302">You could write a provider to look up these values for the user.</span></span> <span data-ttu-id="88f47-303">В следующем примере кода показано, как добавить пользовательский поставщик:</span><span class="sxs-lookup"><span data-stu-id="88f47-303">The following code shows how to add a custom provider:</span></span>

```csharp
private const string enUSCulture = "en-US";

services.Configure<RequestLocalizationOptions>(options =>
{
    var supportedCultures = new[]
    {
        new CultureInfo(enUSCulture),
        new CultureInfo("fr")
    };

    options.DefaultRequestCulture = new RequestCulture(culture: enUSCulture, uiCulture: enUSCulture);
    options.SupportedCultures = supportedCultures;
    options.SupportedUICultures = supportedCultures;

    options.AddInitialRequestCultureProvider(new CustomRequestCultureProvider(async context =>
    {
        // My custom request culture logic
        return new ProviderCultureResult("en");
    }));
});
```

<span data-ttu-id="88f47-304">Для добавления или удаления поставщиков локализации используйте объект `RequestLocalizationOptions`.</span><span class="sxs-lookup"><span data-stu-id="88f47-304">Use `RequestLocalizationOptions` to add or remove localization providers.</span></span>

### <a name="set-the-culture-programmatically"></a><span data-ttu-id="88f47-305">Задание языка и региональных параметров программным образом</span><span class="sxs-lookup"><span data-stu-id="88f47-305">Set the culture programmatically</span></span>

<span data-ttu-id="88f47-306">В образце проекта **Localization.StarterWeb** в [GitHub](https://github.com/aspnet/entropy) есть пользовательский интерфейс для задания значения `Culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-306">This sample **Localization.StarterWeb** project on [GitHub](https://github.com/aspnet/entropy) contains UI to set the `Culture`.</span></span> <span data-ttu-id="88f47-307">Файл *Views/Shared/_SelectLanguagePartial.cshtml* позволяет выбрать язык и региональные параметры из списка поддерживаемых:</span><span class="sxs-lookup"><span data-stu-id="88f47-307">The *Views/Shared/_SelectLanguagePartial.cshtml* file allows you to select the culture from the list of supported cultures:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Shared/_SelectLanguagePartial.cshtml)]

<span data-ttu-id="88f47-308">Файл *Views/Shared/_SelectLanguagePartial.cshtml* добавляется в раздел `footer` файла макета, поэтому он доступен всем представлениям:</span><span class="sxs-lookup"><span data-stu-id="88f47-308">The *Views/Shared/_SelectLanguagePartial.cshtml* file is added to the `footer` section of the layout file so it will be available to all views:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Shared/_Layout.cshtml?range=43-56&highlight=10)]

<span data-ttu-id="88f47-309">Метод `SetLanguage` задает файл cookie языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-309">The `SetLanguage` method sets the culture cookie.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/HomeController.cs?range=57-67)]

<span data-ttu-id="88f47-310">Подключить файл *_SelectLanguagePartial.cshtml* к образцу кода этого проекта нельзя.</span><span class="sxs-lookup"><span data-stu-id="88f47-310">You can't plug in the *_SelectLanguagePartial.cshtml* to sample code for this project.</span></span> <span data-ttu-id="88f47-311">В проекте **Localization.StarterWeb** в [GitHub](https://github.com/aspnet/entropy) есть код для передачи объекта `RequestLocalizationOptions` в частичное представление Razor посредством контейнера [внедрения зависимостей](dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="88f47-311">The **Localization.StarterWeb** project on [GitHub](https://github.com/aspnet/entropy) has code to flow the `RequestLocalizationOptions` to a Razor partial through the [Dependency Injection](dependency-injection.md) container.</span></span>

## <a name="model-binding-route-data-and-query-strings"></a><span data-ttu-id="88f47-312">Данные маршрутов привязки модели и строки запросов</span><span class="sxs-lookup"><span data-stu-id="88f47-312">Model binding route data and query strings</span></span>

<span data-ttu-id="88f47-313">См. раздел [Поведение глобализации для данных маршрутов привязки модели и строк запросов](xref:mvc/models/model-binding#glob).</span><span class="sxs-lookup"><span data-stu-id="88f47-313">See [Globalization behavior of model binding route data and query strings](xref:mvc/models/model-binding#glob).</span></span>

## <a name="globalization-and-localization-terms"></a><span data-ttu-id="88f47-314">Термины, относящиеся к глобализации и локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-314">Globalization and localization terms</span></span>

<span data-ttu-id="88f47-315">Процесс локализации приложения требует базового понимания распространенных кодировок, часто используемых при разработке современного программного обеспечения, и связанных с ними проблем.</span><span class="sxs-lookup"><span data-stu-id="88f47-315">The process of localizing your app also requires a basic understanding of relevant character sets commonly used in modern software development and an understanding of the issues associated with them.</span></span> <span data-ttu-id="88f47-316">Хотя на всех компьютерах текст сохраняется в виде цифр (кодов), в разных системах эти коды для одного и того же текста различаются.</span><span class="sxs-lookup"><span data-stu-id="88f47-316">Although all computers store text as numbers (codes), different systems store the same text using different numbers.</span></span> <span data-ttu-id="88f47-317">Под процессом локализации понимается перевод пользовательского интерфейса приложения для определенного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-317">The localization process refers to translating the app user interface (UI) for a specific culture/locale.</span></span>

<span data-ttu-id="88f47-318">[Возможность локализации](/dotnet/standard/globalization-localization/localizability-review) — это определяемое на промежуточной стадии состояние готовности глобализованного приложения к локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-318">[Localizability](/dotnet/standard/globalization-localization/localizability-review) is an intermediate process for verifying that a globalized app is ready for localization.</span></span>

<span data-ttu-id="88f47-319">Формат [RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) для названия языка и региональных параметров имеет вид `<languagecode2>-<country/regioncode2>`, где `<languagecode2>` — это код языка, а `<country/regioncode2>` — код субкультуры.</span><span class="sxs-lookup"><span data-stu-id="88f47-319">The [RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) format for the culture name is `<languagecode2>-<country/regioncode2>`, where `<languagecode2>` is the language code and `<country/regioncode2>` is the subculture code.</span></span> <span data-ttu-id="88f47-320">Примеры: `es-CL` для испанского языка (Чили), `en-US` для английского языка (США), `en-AU` для английского языка (Австралия).</span><span class="sxs-lookup"><span data-stu-id="88f47-320">For example, `es-CL` for Spanish (Chile), `en-US` for English (United States), and `en-AU` for English (Australia).</span></span> <span data-ttu-id="88f47-321">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) — это комбинация двухбуквенного кода культуры ISO 639 в нижнем регистре (он связан с языком) и двухбуквенного кода субкультуры ISO 3166 в верхнем регистре (он связан со страной или регионом).</span><span class="sxs-lookup"><span data-stu-id="88f47-321">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) is a combination of an ISO 639 two-letter lowercase culture code associated with a language and an ISO 3166 two-letter uppercase subculture code associated with a country or region.</span></span> <span data-ttu-id="88f47-322">См. раздел <https://docs.microsoft.com/previous-versions/commerce-server/ee825488(v=cs.20)>.</span><span class="sxs-lookup"><span data-stu-id="88f47-322">See <https://docs.microsoft.com/previous-versions/commerce-server/ee825488(v=cs.20)>.</span></span>

<span data-ttu-id="88f47-323">Вместо слова "интернационализация" (internationalization) часто используют аббревиатуру "I18N".</span><span class="sxs-lookup"><span data-stu-id="88f47-323">Internationalization is often abbreviated to "I18N".</span></span> <span data-ttu-id="88f47-324">В аббревиатуру включаются первая и последняя буквы слова, а также число букв между ними, то есть 18 — это число букв между первой ("I") и последней ("N") буквами.</span><span class="sxs-lookup"><span data-stu-id="88f47-324">The abbreviation takes the first and last letters and the number of letters between them, so 18 stands for the number of letters between the first "I" and the last "N".</span></span> <span data-ttu-id="88f47-325">То же самое касается глобализации (Globalization — G11N) и локализации (Localization — L10N).</span><span class="sxs-lookup"><span data-stu-id="88f47-325">The same applies to Globalization (G11N), and Localization (L10N).</span></span>

<span data-ttu-id="88f47-326">Термины:</span><span class="sxs-lookup"><span data-stu-id="88f47-326">Terms:</span></span>

* <span data-ttu-id="88f47-327">Глобализация (G11N): процесс подготовки приложения к поддержке различных языков и регионов.</span><span class="sxs-lookup"><span data-stu-id="88f47-327">Globalization (G11N): The process of making an app support different languages and regions.</span></span>
* <span data-ttu-id="88f47-328">Локализация (L10N): процесс настройки приложения для работы с конкретным языком и регионом.</span><span class="sxs-lookup"><span data-stu-id="88f47-328">Localization (L10N): The process of customizing an app for a given language and region.</span></span>
* <span data-ttu-id="88f47-329">Интернационализация (I18N): описывает глобализацию и локализацию.</span><span class="sxs-lookup"><span data-stu-id="88f47-329">Internationalization (I18N): Describes both globalization and localization.</span></span>
* <span data-ttu-id="88f47-330">Язык и региональные параметры: обозначает язык и (необязательно) регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-330">Culture: It's a language and, optionally, a region.</span></span>
* <span data-ttu-id="88f47-331">Нейтральный язык и региональные параметры: язык и региональные параметры, для которых указан язык, но не регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-331">Neutral culture: A culture that has a specified language, but not a region.</span></span> <span data-ttu-id="88f47-332">(например, "en", "es").</span><span class="sxs-lookup"><span data-stu-id="88f47-332">(for example "en", "es")</span></span>
* <span data-ttu-id="88f47-333">Конкретный язык и региональные параметры: язык и региональные параметры, для которых указаны язык и регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-333">Specific culture: A culture that has a specified language and region.</span></span> <span data-ttu-id="88f47-334">(например, "en-US", "en-GB", "es-CL").</span><span class="sxs-lookup"><span data-stu-id="88f47-334">(for example "en-US", "en-GB", "es-CL")</span></span>
* <span data-ttu-id="88f47-335">Родительский язык и региональные параметры: нейтральные язык и региональные параметры, содержащие конкретные язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-335">Parent culture: The neutral culture that contains a specific culture.</span></span> <span data-ttu-id="88f47-336">(например, "en" — это родительские язык и региональные параметры для "en-US" и "en-GB").</span><span class="sxs-lookup"><span data-stu-id="88f47-336">(for example, "en" is the parent culture of "en-US" and "en-GB")</span></span>
* <span data-ttu-id="88f47-337">Языковой стандарт: тот же, что и язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-337">Locale: A locale is the same as a culture.</span></span>

[!INCLUDE[](~/includes/localization/currency.md)]

[!INCLUDE[](~/includes/localization/unsupported-culture-log-level.md)]

## <a name="additional-resources"></a><span data-ttu-id="88f47-338">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="88f47-338">Additional resources</span></span>

* <xref:fundamentals/troubleshoot-aspnet-core-localization>
* <span data-ttu-id="88f47-339">[Проект Localization.StarterWeb](https://github.com/aspnet/Entropy/tree/master/samples/Localization.StarterWeb), используемый в этой статье.</span><span class="sxs-lookup"><span data-stu-id="88f47-339">[Localization.StarterWeb project](https://github.com/aspnet/Entropy/tree/master/samples/Localization.StarterWeb) used in the article.</span></span>
* [<span data-ttu-id="88f47-340">Глобализация и локализация приложений .NET</span><span class="sxs-lookup"><span data-stu-id="88f47-340">Globalizing and localizing .NET applications</span></span>](/dotnet/standard/globalization-localization/index)
* [<span data-ttu-id="88f47-341">Ресурсы в RESX-файлах</span><span class="sxs-lookup"><span data-stu-id="88f47-341">Resources in .resx Files</span></span>](/dotnet/framework/resources/working-with-resx-files-programmatically)
* [<span data-ttu-id="88f47-342">Набор средств многоязычных приложений Майкрософт</span><span class="sxs-lookup"><span data-stu-id="88f47-342">Microsoft Multilingual App Toolkit</span></span>](https://marketplace.visualstudio.com/items?itemName=MultilingualAppToolkit.MultilingualAppToolkit-18308)
* [<span data-ttu-id="88f47-343">Локализация и универсальные шаблоны</span><span class="sxs-lookup"><span data-stu-id="88f47-343">Localization & Generics</span></span>](http://hishambinateya.com/localization-and-generics)

::: moniker-end

::: moniker range="< aspnetcore-3.0"

<span data-ttu-id="88f47-344">Авторы: [Рик Андерсон](https://twitter.com/RickAndMSFT) (Rick Anderson), [Дэмиен Боуден](https://twitter.com/damien_bod) (Damien Bowden), [Барт Каликсто](https://twitter.com/bartmax) (Bart Calixto), [Надим Афана](https://afana.me/) (Nadeem Afana) и [Хишам Бин Атея](https://twitter.com/hishambinateya) (Hisham Bin Ateya)</span><span class="sxs-lookup"><span data-stu-id="88f47-344">By [Rick Anderson](https://twitter.com/RickAndMSFT), [Damien Bowden](https://twitter.com/damien_bod), [Bart Calixto](https://twitter.com/bartmax), [Nadeem Afana](https://afana.me/), and [Hisham Bin Ateya](https://twitter.com/hishambinateya)</span></span>

<span data-ttu-id="88f47-345">Создание многоязычного веб-сайта позволит расширить аудиторию.</span><span class="sxs-lookup"><span data-stu-id="88f47-345">A multilingual website allows the site to reach a wider audience.</span></span> <span data-ttu-id="88f47-346">ASP.NET Core предоставляет службы и ПО промежуточного слоя для локализации на разные языки и для разных региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-346">ASP.NET Core provides services and middleware for localizing into different languages and cultures.</span></span>

<span data-ttu-id="88f47-347">Интернационализация предполагает [глобализацию](/dotnet/api/system.globalization) и [локализацию](/dotnet/standard/globalization-localization/localization).</span><span class="sxs-lookup"><span data-stu-id="88f47-347">Internationalization involves [Globalization](/dotnet/api/system.globalization) and [Localization](/dotnet/standard/globalization-localization/localization).</span></span> <span data-ttu-id="88f47-348">Глобализация — это процесс разработки приложений, которые поддерживают разные языки и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-348">Globalization is the process of designing apps that support different cultures.</span></span> <span data-ttu-id="88f47-349">Глобализация добавляет поддержку ввода отображения и вывода определенного набора языковых сценариев, относящихся к конкретным регионам.</span><span class="sxs-lookup"><span data-stu-id="88f47-349">Globalization adds support for input, display, and output of a defined set of language scripts that relate to specific geographic areas.</span></span>

<span data-ttu-id="88f47-350">Локализация — это процесс адаптации глобализованного приложения, уже подготовленного к локализации, к определенному языку, языковому стандарту и региональным параметрам.</span><span class="sxs-lookup"><span data-stu-id="88f47-350">Localization is the process of adapting a globalized app, which you have already processed for localizability, to a particular culture/locale.</span></span> <span data-ttu-id="88f47-351">Дополнительные сведения см. в разделе **Термины, относящиеся к глобализации и локализации** ближе к концу этого документа.</span><span class="sxs-lookup"><span data-stu-id="88f47-351">For more information see **Globalization and localization terms** near the end of this document.</span></span>

<span data-ttu-id="88f47-352">Локализация приложения включает следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="88f47-352">App localization involves the following:</span></span>

1. <span data-ttu-id="88f47-353">обеспечение возможности локализации для содержимого приложения;</span><span class="sxs-lookup"><span data-stu-id="88f47-353">Make the app's content localizable</span></span>
1. <span data-ttu-id="88f47-354">предоставление локализованных ресурсов для поддерживаемых языков и региональных параметров;</span><span class="sxs-lookup"><span data-stu-id="88f47-354">Provide localized resources for the languages and cultures you support</span></span>
1. <span data-ttu-id="88f47-355">реализацию стратегии по выбору языка и региональных параметров для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-355">Implement a strategy to select the language/culture for each request</span></span>

<span data-ttu-id="88f47-356">[Просмотреть или скачать образец кода](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/localization/sample/Localization) ([как скачивать](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="88f47-356">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/localization/sample/Localization) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="make-the-apps-content-localizable"></a><span data-ttu-id="88f47-357">Обеспечение возможности локализации для содержимого приложения</span><span class="sxs-lookup"><span data-stu-id="88f47-357">Make the app's content localizable</span></span>

<span data-ttu-id="88f47-358"><xref:Microsoft.Extensions.Localization.IStringLocalizer> и <xref:Microsoft.Extensions.Localization.IStringLocalizer%601> создавались для повышения производительность при разработке локализованных приложений.</span><span class="sxs-lookup"><span data-stu-id="88f47-358"><xref:Microsoft.Extensions.Localization.IStringLocalizer> and <xref:Microsoft.Extensions.Localization.IStringLocalizer%601> were architected to improve productivity when developing localized apps.</span></span> <span data-ttu-id="88f47-359">`IStringLocalizer` использует классы <xref:System.Resources.ResourceManager> и <xref:System.Resources.ResourceReader> для предоставления ресурсов, связанных с определенным языком и региональными параметрами, во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="88f47-359">`IStringLocalizer` uses the <xref:System.Resources.ResourceManager> and <xref:System.Resources.ResourceReader> to provide culture-specific resources at run time.</span></span> <span data-ttu-id="88f47-360">Этот интерфейс имеет индексатор и интерфейс `IEnumerable` для возврата локализованных строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-360">The interface has an indexer and an `IEnumerable` for returning localized strings.</span></span> <span data-ttu-id="88f47-361">`IStringLocalizer` не требует сохранять строки на языке по умолчанию в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-361">`IStringLocalizer` doesn't require storing the default language strings in a resource file.</span></span> <span data-ttu-id="88f47-362">Вы можете разрабатывать приложение, предназначенное для локализации, не создавая файлы ресурсов на ранних этапах разработки.</span><span class="sxs-lookup"><span data-stu-id="88f47-362">You can develop an app targeted for localization and not need to create resource files early in development.</span></span> <span data-ttu-id="88f47-363">В приведенном ниже коде показано, как подготовить строку "About Title" для локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-363">The code below shows how to wrap the string "About Title" for localization.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/AboutController.cs)]

<span data-ttu-id="88f47-364">В предыдущем коде реализация `IStringLocalizer<T>` получена в результате [внедрения зависимостей](dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="88f47-364">In the preceding code, the `IStringLocalizer<T>` implementation comes from [Dependency Injection](dependency-injection.md).</span></span> <span data-ttu-id="88f47-365">Если локализованное значение для строки "About Title" не найдено, возвращается ключ индексатора, то есть строка "About Title".</span><span class="sxs-lookup"><span data-stu-id="88f47-365">If the localized value of "About Title" isn't found, then the indexer key is returned, that is, the string "About Title".</span></span> <span data-ttu-id="88f47-366">Вы можете оставить литеральные строки на языке по умолчанию и заключить их в средство локализации, чтобы сосредоточиться на разработке приложения.</span><span class="sxs-lookup"><span data-stu-id="88f47-366">You can leave the default language literal strings in the app and wrap them in the localizer, so that you can focus on developing the app.</span></span> <span data-ttu-id="88f47-367">Вы разрабатываете приложение на языке по умолчанию и подготавливаете его к локализации, не создавая предварительно файл ресурсов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-367">You develop your app with your default language and prepare it for the localization step without first creating a default resource file.</span></span> <span data-ttu-id="88f47-368">Вы также можете выбрать традиционный подход и предоставить ключ для извлечения строки на языке по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-368">Alternatively, you can use the traditional approach and provide a key to retrieve the default language string.</span></span> <span data-ttu-id="88f47-369">Для многих разработчиков новый рабочий процесс, который не требует наличия файла *RESX* на языке по умолчанию и позволяет просто заключать строки для дальнейшей обработки, может помочь снизить затраты на локализацию приложения.</span><span class="sxs-lookup"><span data-stu-id="88f47-369">For many developers the new workflow of not having a default language *.resx* file and simply wrapping the string literals can reduce the overhead of localizing an app.</span></span> <span data-ttu-id="88f47-370">Другие разработчики могут предпочесть традиционный рабочий процесс, так как он упрощает работу с более длинными строками и обновление локализованных строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-370">Other developers will prefer the traditional work flow as it can make it easier to work with longer string literals and make it easier to update localized strings.</span></span>

<span data-ttu-id="88f47-371">Используйте реализацию `IHtmlLocalizer<T>` для ресурсов, содержащих код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-371">Use the `IHtmlLocalizer<T>` implementation for resources that contain HTML.</span></span> <span data-ttu-id="88f47-372">Интерфейс `IHtmlLocalizer` кодирует в HTML аргументы, отформатированные в строке ресурса, но не кодирует в HTML саму строку.</span><span class="sxs-lookup"><span data-stu-id="88f47-372">`IHtmlLocalizer` HTML encodes arguments that are formatted in the resource string, but doesn't HTML encode the resource string itself.</span></span> <span data-ttu-id="88f47-373">В выделенной ниже строке в HTML кодируется только значение параметра `name`.</span><span class="sxs-lookup"><span data-stu-id="88f47-373">In the sample highlighted below, only the value of `name` parameter is HTML encoded.</span></span>

[!code-csharp[](~/fundamentals/localization/sample/3.x/Localization/Controllers/BookController.cs?highlight=3,5,20&start=1&end=24)]

> [!NOTE]
> <span data-ttu-id="88f47-374">Как правило, требуется локализовать только текст, но не код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-374">Generally, only localize text, not HTML.</span></span>

<span data-ttu-id="88f47-375">На самом нижнем уровне интерфейс `IStringLocalizerFactory` можно получить из [внедрения зависимостей](dependency-injection.md):</span><span class="sxs-lookup"><span data-stu-id="88f47-375">At the lowest level, you can get `IStringLocalizerFactory` out of [Dependency Injection](dependency-injection.md):</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/TestController.cs?start=9&end=26&highlight=7-13)]

<span data-ttu-id="88f47-376">В приведенном выше коде демонстрируются оба фабричных метода создания.</span><span class="sxs-lookup"><span data-stu-id="88f47-376">The code above demonstrates each of the two factory create methods.</span></span>

<span data-ttu-id="88f47-377">Вы можете разбивать локализованные строки по контроллеру, области или использовать всего один конвейер.</span><span class="sxs-lookup"><span data-stu-id="88f47-377">You can partition your localized strings by controller, area, or have just one container.</span></span> <span data-ttu-id="88f47-378">В образце приложения для общих ресурсов применяется класс-заглушка с именем `SharedResource`.</span><span class="sxs-lookup"><span data-stu-id="88f47-378">In the sample app, a dummy class named `SharedResource` is used for shared resources.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/SharedResource.cs)]

<span data-ttu-id="88f47-379">Некоторые разработчики используют класс `Startup` для хранения глобальных или общих строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-379">Some developers use the `Startup` class to contain global or shared strings.</span></span> <span data-ttu-id="88f47-380">В примере ниже используются средства локализации `InfoController` и `SharedResource`.</span><span class="sxs-lookup"><span data-stu-id="88f47-380">In the sample below, the `InfoController` and the `SharedResource` localizers are used:</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/InfoController.cs?range=9-26)]

## <a name="view-localization"></a><span data-ttu-id="88f47-381">Локализация представления</span><span class="sxs-lookup"><span data-stu-id="88f47-381">View localization</span></span>

<span data-ttu-id="88f47-382">Служба `IViewLocalizer` предоставляет локализованные строки для [представления](xref:mvc/views/overview).</span><span class="sxs-lookup"><span data-stu-id="88f47-382">The `IViewLocalizer` service provides localized strings for a [view](xref:mvc/views/overview).</span></span> <span data-ttu-id="88f47-383">Класс `ViewLocalizer` реализует этот интерфейс и находит расположение ресурсов по пути к файлу представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-383">The `ViewLocalizer` class implements this interface and finds the resource location from the view file path.</span></span> <span data-ttu-id="88f47-384">В следующем примере кода демонстрируется использование реализации `IViewLocalizer` по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="88f47-384">The following code shows how to use the default implementation of `IViewLocalizer`:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Home/About.cshtml)]

<span data-ttu-id="88f47-385">Реализация `IViewLocalizer` по умолчанию находит файл ресурсов по имени файла представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-385">The default implementation of `IViewLocalizer` finds the resource file based on the view's file name.</span></span> <span data-ttu-id="88f47-386">Возможности использовать глобальный общий файл ресурсов нет.</span><span class="sxs-lookup"><span data-stu-id="88f47-386">There's no option to use a global shared resource file.</span></span> <span data-ttu-id="88f47-387">`ViewLocalizer` реализует средство локализации с помощью интерфейса `IHtmlLocalizer`, поэтому Razor не кодирует локализованную строку в HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-387">`ViewLocalizer` implements the localizer using `IHtmlLocalizer`, so Razor doesn't HTML encode the localized string.</span></span> <span data-ttu-id="88f47-388">Вы можете параметризовать строки ресурсов, и `IViewLocalizer` будет кодировать в HTML параметры, но не строки ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-388">You can parameterize resource strings and `IViewLocalizer` will HTML encode the parameters, but not the resource string.</span></span> <span data-ttu-id="88f47-389">Рассмотрим следующую разметку Razor:</span><span class="sxs-lookup"><span data-stu-id="88f47-389">Consider the following Razor markup:</span></span>

```cshtml
@Localizer["<i>Hello</i> <b>{0}!</b>", UserManager.GetUserName(User)]
```

<span data-ttu-id="88f47-390">Файл ресурсов на французском языке может содержать следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="88f47-390">A French resource file could contain the following:</span></span>

| <span data-ttu-id="88f47-391">Ключ</span><span class="sxs-lookup"><span data-stu-id="88f47-391">Key</span></span> | <span data-ttu-id="88f47-392">Значение</span><span class="sxs-lookup"><span data-stu-id="88f47-392">Value</span></span> |
| --- | ----- |
| `<i>Hello</i> <b>{0}!</b>` | `<i>Bonjour</i> <b>{0} !</b>` |

<span data-ttu-id="88f47-393">Преобразованное для просмотра представление будет содержать разметку HTML из файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-393">The rendered view would contain the HTML markup from the resource file.</span></span>

> [!NOTE]
> <span data-ttu-id="88f47-394">Как правило, требуется локализовать только текст, но не код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-394">Generally, only localize text, not HTML.</span></span>

<span data-ttu-id="88f47-395">Чтобы использовать в представлении общий файл ресурсов, внедрите `IHtmlLocalizer<T>`:</span><span class="sxs-lookup"><span data-stu-id="88f47-395">To use a shared resource file in a view, inject `IHtmlLocalizer<T>`:</span></span>

[!code-cshtml[](~/fundamentals/localization/sample/3.x/Localization/Views/Test/About.cshtml?highlight=5,12)]

## <a name="dataannotations-localization"></a><span data-ttu-id="88f47-396">Локализация DataAnnotations</span><span class="sxs-lookup"><span data-stu-id="88f47-396">DataAnnotations localization</span></span>

<span data-ttu-id="88f47-397">Сообщения об ошибках DataAnnotations локализуются с помощью `IStringLocalizer<T>`.</span><span class="sxs-lookup"><span data-stu-id="88f47-397">DataAnnotations error messages are localized with `IStringLocalizer<T>`.</span></span> <span data-ttu-id="88f47-398">При использовании параметра `ResourcesPath = "Resources"` сообщения об ошибках в `RegisterViewModel` могут сохраняться по одному из следующих путей:</span><span class="sxs-lookup"><span data-stu-id="88f47-398">Using the option `ResourcesPath = "Resources"`, the error messages in `RegisterViewModel` can be stored in either of the following paths:</span></span>

* <span data-ttu-id="88f47-399">*Resources/ViewModels.Account.RegisterViewModel.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-399">*Resources/ViewModels.Account.RegisterViewModel.fr.resx*</span></span>
* <span data-ttu-id="88f47-400">*Resources/ViewModels/Account/RegisterViewModel.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-400">*Resources/ViewModels/Account/RegisterViewModel.fr.resx*</span></span>

[!code-csharp[](localization/sample/3.x/Localization/ViewModels/Account/RegisterViewModel.cs?start=9&end=26)]

<span data-ttu-id="88f47-401">В ASP.NET Core MVC 1.1.0 и более поздних версиях атрибуты, не относящиеся в проверке, локализуются.</span><span class="sxs-lookup"><span data-stu-id="88f47-401">In ASP.NET Core MVC 1.1.0 and higher, non-validation attributes are localized.</span></span> <span data-ttu-id="88f47-402">В ASP.NET Core MVC 1.0 **не** производится поиск локализованных строк для атрибутов, не относящихся к проверке.</span><span class="sxs-lookup"><span data-stu-id="88f47-402">ASP.NET Core MVC 1.0 does **not** look up localized strings for non-validation attributes.</span></span>

<a name="one-resource-string-multiple-classes"></a>

### <a name="using-one-resource-string-for-multiple-classes"></a><span data-ttu-id="88f47-403">Использование одной строки ресурса для нескольких классов</span><span class="sxs-lookup"><span data-stu-id="88f47-403">Using one resource string for multiple classes</span></span>

<span data-ttu-id="88f47-404">В следующем коде показано, как использовать одну строку ресурса для атрибутов проверки с несколькими классами:</span><span class="sxs-lookup"><span data-stu-id="88f47-404">The following code shows how to use one resource string for validation attributes with multiple classes:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc()
        .AddDataAnnotationsLocalization(options => {
            options.DataAnnotationLocalizerProvider = (type, factory) =>
                factory.Create(typeof(SharedResource));
        });
}
```

<span data-ttu-id="88f47-405">В предыдущем коде `SharedResource` — это класс, соответствующий файлу RESX, в котором хранятся сообщения о проверке.</span><span class="sxs-lookup"><span data-stu-id="88f47-405">In the preceding code, `SharedResource` is the class corresponding to the resx where your validation messages are stored.</span></span> <span data-ttu-id="88f47-406">При таком подходе DataAnnotations будут использовать только `SharedResource`, а не ресурс для каждого класса.</span><span class="sxs-lookup"><span data-stu-id="88f47-406">With this approach, DataAnnotations will only use `SharedResource`, rather than the resource for each class.</span></span>

## <a name="provide-localized-resources-for-the-languages-and-cultures-you-support"></a><span data-ttu-id="88f47-407">Предоставление локализованных ресурсов для поддерживаемых языков и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="88f47-407">Provide localized resources for the languages and cultures you support</span></span>

### <a name="supportedcultures-and-supporteduicultures"></a><span data-ttu-id="88f47-408">SupportedCultures и SupportedUICultures</span><span class="sxs-lookup"><span data-stu-id="88f47-408">SupportedCultures and SupportedUICultures</span></span>

<span data-ttu-id="88f47-409">ASP.NET Core позволяет указывать два значения языка и региональных параметров: `SupportedCultures` и `SupportedUICultures`.</span><span class="sxs-lookup"><span data-stu-id="88f47-409">ASP.NET Core allows you to specify two culture values, `SupportedCultures` and `SupportedUICultures`.</span></span> <span data-ttu-id="88f47-410">Объект [CultureInfo](/dotnet/api/system.globalization.cultureinfo) для `SupportedCultures` определяет результаты функций, зависящих от языка и региональных параметров: форматирование дат, времени, чисел, денежных единиц и т. д.</span><span class="sxs-lookup"><span data-stu-id="88f47-410">The [CultureInfo](/dotnet/api/system.globalization.cultureinfo) object for `SupportedCultures` determines the results of culture-dependent functions, such as date, time, number, and currency formatting.</span></span> <span data-ttu-id="88f47-411">`SupportedCultures` также определяет порядок сортировки текста, соглашения о регистре символов и способы сравнения строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-411">`SupportedCultures` also determines the sorting order of text, casing conventions, and string comparisons.</span></span> <span data-ttu-id="88f47-412">Дополнительные сведения о получении сервером значения языка и региональных параметров см. в описании свойства [CultureInfo.CurrentCulture](/dotnet/api/system.stringcomparer.currentculture#System_StringComparer_CurrentCulture).</span><span class="sxs-lookup"><span data-stu-id="88f47-412">See [CultureInfo.CurrentCulture](/dotnet/api/system.stringcomparer.currentculture#System_StringComparer_CurrentCulture) for more info on how the server gets the Culture.</span></span> <span data-ttu-id="88f47-413">Значение `SupportedUICultures` определяет то, какие строки переводов (в файле *RESX*) ищет объект [ResourceManager](/dotnet/api/system.resources.resourcemanager).</span><span class="sxs-lookup"><span data-stu-id="88f47-413">The `SupportedUICultures` determines which translated strings (from *.resx* files) are looked up by the [ResourceManager](/dotnet/api/system.resources.resourcemanager).</span></span> <span data-ttu-id="88f47-414">`ResourceManager` ищет связанные с языком и региональными параметрами строки, которые определяются значением `CurrentUICulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-414">The `ResourceManager` simply looks up culture-specific strings that's determined by `CurrentUICulture`.</span></span> <span data-ttu-id="88f47-415">Каждый поток в .NET имеет объекты `CurrentCulture` и `CurrentUICulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-415">Every thread in .NET has `CurrentCulture` and `CurrentUICulture` objects.</span></span> <span data-ttu-id="88f47-416">ASP.NET Core проверяет эти значения при обработке функций, зависящих от языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-416">ASP.NET Core inspects these values when rendering culture-dependent functions.</span></span> <span data-ttu-id="88f47-417">Например, если для текущего потока заданы язык и региональные параметры "en-US" (английский, США), метод `DateTime.Now.ToLongDateString()` выводит строку "Thursday, February 18, 2016", но если `CurrentCulture` имеет значение "ru-RU" (русский, Россия), выводится строка "четверг, 18 февраля 2016 г."</span><span class="sxs-lookup"><span data-stu-id="88f47-417">For example, if the current thread's culture is set to "en-US" (English, United States), `DateTime.Now.ToLongDateString()` displays "Thursday, February 18, 2016", but if `CurrentCulture` is set to "es-ES" (Spanish, Spain) the output will be "jueves, 18 de febrero de 2016".</span></span>

## <a name="resource-files"></a><span data-ttu-id="88f47-418">Файлы ресурсов</span><span class="sxs-lookup"><span data-stu-id="88f47-418">Resource files</span></span>

<span data-ttu-id="88f47-419">Файл ресурсов — это полезное средство для отделения локализуемых строк от кода.</span><span class="sxs-lookup"><span data-stu-id="88f47-419">A resource file is a useful mechanism for separating localizable strings from code.</span></span> <span data-ttu-id="88f47-420">Переведенные строки на языках, отличных от языка по умолчанию, содержатся в отдельных файлах ресурсов с расширением *RESX*.</span><span class="sxs-lookup"><span data-stu-id="88f47-420">Translated strings for the non-default language are isolated in *.resx* resource files.</span></span> <span data-ttu-id="88f47-421">Например, вам нужно создать файл ресурсов для испанского языка с именем *Welcome.es.resx*, который будет содержать переведенные строки.</span><span class="sxs-lookup"><span data-stu-id="88f47-421">For example, you might want to create Spanish resource file named *Welcome.es.resx* containing translated strings.</span></span> <span data-ttu-id="88f47-422">"es" — это код испанского языка.</span><span class="sxs-lookup"><span data-stu-id="88f47-422">"es" is the language code for Spanish.</span></span> <span data-ttu-id="88f47-423">Чтобы создать этот файл ресурсов в Visual Studio, выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="88f47-423">To create this resource file in Visual Studio:</span></span>

1. <span data-ttu-id="88f47-424">В **обозревателе решений** щелкните правой кнопкой мыши папку, которая будет содержать файл ресурсов, а затем выберите пункты **Добавить** > **Новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="88f47-424">In **Solution Explorer**, right click on the folder which will contain the resource file > **Add** > **New Item**.</span></span>

   ![Вложенное контекстное меню: в обозревателе решений контекстное меню открывается для папки ресурсов.](localization/_static/newi.png)

1. <span data-ttu-id="88f47-427">В поле **Поиск установленных шаблонов** введите слово "ресурс" и укажите имя файла.</span><span class="sxs-lookup"><span data-stu-id="88f47-427">In the **Search installed templates** box, enter "resource" and name the file.</span></span>

   ![Диалоговое окно ''Добавление нового элемента''](localization/_static/res.png)

1. <span data-ttu-id="88f47-429">Введите значение ключа (строку на исходном языке) в столбце **Имя** и переведенную строку в столбце **Значение**.</span><span class="sxs-lookup"><span data-stu-id="88f47-429">Enter the key value (native string) in the **Name** column and the translated string in the **Value** column.</span></span>

   ![Файл Welcome.es.resx (файлов ресурсов с приветствиями на испанском языке) со словом "Hello" в столбце "Имя" и словом "Hol"a ("Hello" на испанском) в столбце "Значение"](localization/_static/hola.png)

   <span data-ttu-id="88f47-431">В Visual Studio отобразится файл *Welcome.es.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-431">Visual Studio shows the *Welcome.es.resx* file.</span></span>

   ![Обозреватель решений с файлом ресурсов на испанском языке](localization/_static/se.png)

## <a name="resource-file-naming"></a><span data-ttu-id="88f47-433">Именование файлов ресурсов</span><span class="sxs-lookup"><span data-stu-id="88f47-433">Resource file naming</span></span>

<span data-ttu-id="88f47-434">Имена ресурсов представляют собой полные имена типов соответствующего класса за исключением имени сборки.</span><span class="sxs-lookup"><span data-stu-id="88f47-434">Resources are named for the full type name of their class minus the assembly name.</span></span> <span data-ttu-id="88f47-435">Например, ресурс на французском языке в проекте, главная сборка которого имеет имя `LocalizationWebsite.Web.dll`, для класса `LocalizationWebsite.Web.Startup` будет иметь имя *Startup.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-435">For example, a French resource in a project whose main assembly is `LocalizationWebsite.Web.dll` for the class `LocalizationWebsite.Web.Startup` would be named *Startup.fr.resx*.</span></span> <span data-ttu-id="88f47-436">Ресурс для класса `LocalizationWebsite.Web.Controllers.HomeController` будет иметь имя *Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-436">A resource for the class `LocalizationWebsite.Web.Controllers.HomeController` would be named *Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-437">Если пространство имен целевого класса не совпадает с именем сборки, необходимо использовать полное имя типа.</span><span class="sxs-lookup"><span data-stu-id="88f47-437">If your targeted class's namespace isn't the same as the assembly name you will need the full type name.</span></span> <span data-ttu-id="88f47-438">Например, в образце проекта ресурс для типа `ExtraNamespace.Tools` будет иметь имя *ExtraNamespace.Tools.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-438">For example, in the sample project a resource for the type `ExtraNamespace.Tools` would be named *ExtraNamespace.Tools.fr.resx*.</span></span>

<span data-ttu-id="88f47-439">В образце проекта метод `ConfigureServices` присваивает свойству `ResourcesPath` значение "Resources", поэтому относительный путь к файлу ресурсов на французском языке для контроллера домашней страницы в проекте будет иметь вид *Resources/Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-439">In the sample project, the `ConfigureServices` method sets the `ResourcesPath` to "Resources", so the project relative path for the home controller's French resource file is *Resources/Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-440">Кроме того, для упорядочения файлов ресурсов можно использовать папки.</span><span class="sxs-lookup"><span data-stu-id="88f47-440">Alternatively, you can use folders to organize resource files.</span></span> <span data-ttu-id="88f47-441">Для контроллера домашней страницы путь будет иметь вид *Resources/Controllers/HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-441">For the home controller, the path would be *Resources/Controllers/HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-442">Если параметр `ResourcesPath` не используется, файл *RESX* будет находиться в базовом каталоге проекта.</span><span class="sxs-lookup"><span data-stu-id="88f47-442">If you don't use the `ResourcesPath` option, the *.resx* file would go in the project base directory.</span></span> <span data-ttu-id="88f47-443">Файл ресурса для `HomeController` будет иметь имя *Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-443">The resource file for `HomeController` would be named *Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-444">Выбор соглашения об именовании на основе точечной нотации или пути зависит от того, как следует упорядочивать файлы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-444">The choice of using the dot or path naming convention depends on how you want to organize your resource files.</span></span>

| <span data-ttu-id="88f47-445">Имя ресурса</span><span class="sxs-lookup"><span data-stu-id="88f47-445">Resource name</span></span> | <span data-ttu-id="88f47-446">Точечная нотация или путь</span><span class="sxs-lookup"><span data-stu-id="88f47-446">Dot or path naming</span></span> |
| ------------   | ------------- |
| <span data-ttu-id="88f47-447">Resources/Controllers.HomeController.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-447">Resources/Controllers.HomeController.fr.resx</span></span> | <span data-ttu-id="88f47-448">Точки</span><span class="sxs-lookup"><span data-stu-id="88f47-448">Dot</span></span>  |
| <span data-ttu-id="88f47-449">Resources/Controllers/HomeController.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-449">Resources/Controllers/HomeController.fr.resx</span></span>  | <span data-ttu-id="88f47-450">Path</span><span class="sxs-lookup"><span data-stu-id="88f47-450">Path</span></span> |

<span data-ttu-id="88f47-451">Файлы ресурсов, для которых используется директива `@inject IViewLocalizer` в представлениях Razor, следуют той же модели.</span><span class="sxs-lookup"><span data-stu-id="88f47-451">Resource files using `@inject IViewLocalizer` in Razor views follow a similar pattern.</span></span> <span data-ttu-id="88f47-452">Файлу ресурсов для представления может присваиваться имя на основе либо точечной нотации, либо пути.</span><span class="sxs-lookup"><span data-stu-id="88f47-452">The resource file for a view can be named using either dot naming or path naming.</span></span> <span data-ttu-id="88f47-453">В файле ресурсов для представления Razor имитируется путь к связанному файлу представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-453">Razor view resource files mimic the path of their associated view file.</span></span> <span data-ttu-id="88f47-454">Допустим, свойству `ResourcesPath` присвоено значение "Resources". В этом случае файл ресурсов на французском языке, связанный с представлением *Views/Home/About.cshtml*, может иметь одно из следующих имен:</span><span class="sxs-lookup"><span data-stu-id="88f47-454">Assuming we set the `ResourcesPath` to "Resources", the French resource file associated with the *Views/Home/About.cshtml* view could be either of the following:</span></span>

* <span data-ttu-id="88f47-455">Resources/Views/Home/About.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-455">Resources/Views/Home/About.fr.resx</span></span>

* <span data-ttu-id="88f47-456">Resources/Views.Home.About.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-456">Resources/Views.Home.About.fr.resx</span></span>

<span data-ttu-id="88f47-457">Если параметр `ResourcesPath` не используется, файл *RESX* для представления будет находиться в той же папке, что и представление.</span><span class="sxs-lookup"><span data-stu-id="88f47-457">If you don't use the `ResourcesPath` option, the *.resx* file for a view would be located in the same folder as the view.</span></span>

### <a name="rootnamespaceattribute"></a><span data-ttu-id="88f47-458">RootNamespaceAttribute</span><span class="sxs-lookup"><span data-stu-id="88f47-458">RootNamespaceAttribute</span></span> 

<span data-ttu-id="88f47-459">Атрибут [RootNamespace](/dotnet/api/microsoft.extensions.localization.rootnamespaceattribute?view=aspnetcore-2.1) содержит корневое пространство имен сборки, если корневое пространство имен сборки отличается от имени сборки.</span><span class="sxs-lookup"><span data-stu-id="88f47-459">The [RootNamespace](/dotnet/api/microsoft.extensions.localization.rootnamespaceattribute?view=aspnetcore-2.1) attribute provides the root namespace of an assembly when the root namespace of an assembly is different than the assembly name.</span></span> 

> [!WARNING]
> <span data-ttu-id="88f47-460">Это может произойти, если имя проекта — недопустимый идентификатор .NET.</span><span class="sxs-lookup"><span data-stu-id="88f47-460">This can occur when a project's name is not a valid .NET identifier.</span></span> <span data-ttu-id="88f47-461">Например, `my-project-name.csproj` будет использовать корневое пространство имен `my_project_name` и имя сборки `my-project-name`, что повлечет эту ошибку.</span><span class="sxs-lookup"><span data-stu-id="88f47-461">For instance `my-project-name.csproj` will use the root namespace `my_project_name` and the assembly name `my-project-name` leading to this error.</span></span> 

<span data-ttu-id="88f47-462">Если корневое пространство имен сборки отличается от имени сборки</span><span class="sxs-lookup"><span data-stu-id="88f47-462">If the root namespace of an assembly is different than the assembly name:</span></span>

* <span data-ttu-id="88f47-463">Локализация не работает по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-463">Localization does not work by default.</span></span>
* <span data-ttu-id="88f47-464">Локализация завершается сбоем из-за метода поиска ресурсов в сборке.</span><span class="sxs-lookup"><span data-stu-id="88f47-464">Localization fails due to the way resources are searched for within the assembly.</span></span> <span data-ttu-id="88f47-465">`RootNamespace` — это значение во время сборки, которое недоступно выполняющемуся процессу.</span><span class="sxs-lookup"><span data-stu-id="88f47-465">`RootNamespace` is a build-time value which is not available to the executing process.</span></span> 

<span data-ttu-id="88f47-466">Если `RootNamespace` отличается от `AssemblyName`, включите следующее в файл *AssemblyInfo.cs* (со значениями параметров, замененными фактическими значениями).</span><span class="sxs-lookup"><span data-stu-id="88f47-466">If the `RootNamespace` is different from the `AssemblyName`, include the following in *AssemblyInfo.cs* (with parameter values replaced with the actual values):</span></span>

```csharp
using System.Reflection;
using Microsoft.Extensions.Localization;

[assembly: ResourceLocation("Resource Folder Name")]
[assembly: RootNamespace("App Root Namespace")]
```

<span data-ttu-id="88f47-467">Приведенный выше код обеспечивает успешное разрешение RESX-файлов.</span><span class="sxs-lookup"><span data-stu-id="88f47-467">The preceding code enables the successful resolution of resx files.</span></span>

## <a name="culture-fallback-behavior"></a><span data-ttu-id="88f47-468">Резервный язык и региональные параметры</span><span class="sxs-lookup"><span data-stu-id="88f47-468">Culture fallback behavior</span></span>

<span data-ttu-id="88f47-469">При поиске ресурса локализации использует резервный язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-469">When searching for a resource, localization engages in "culture fallback".</span></span> <span data-ttu-id="88f47-470">Если запрошенный язык и региональные параметры не найдены, используется родительский язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-470">Starting from the requested culture, if not found, it reverts to the parent culture of that culture.</span></span> <span data-ttu-id="88f47-471">Кстати, родительский язык и региональные параметры представляют свойство [CultureInfo.Parent](/dotnet/api/system.globalization.cultureinfo.parent).</span><span class="sxs-lookup"><span data-stu-id="88f47-471">As an aside, the [CultureInfo.Parent](/dotnet/api/system.globalization.cultureinfo.parent) property represents the parent culture.</span></span> <span data-ttu-id="88f47-472">Обычно (но не всегда) это означает удаление национального символа из ISO.</span><span class="sxs-lookup"><span data-stu-id="88f47-472">This usually (but not always) means removing the national signifier from the ISO.</span></span> <span data-ttu-id="88f47-473">Например, диалект испанского в Мексике — es-MX.</span><span class="sxs-lookup"><span data-stu-id="88f47-473">For example, the dialect of Spanish spoken in Mexico is "es-MX".</span></span> <span data-ttu-id="88f47-474">Родительский элемент "es" (испанский) не относится к той или иной стране.</span><span class="sxs-lookup"><span data-stu-id="88f47-474">It has the parent "es"&mdash;Spanish non-specific to any country.</span></span>

<span data-ttu-id="88f47-475">Допустим, сайт получает запрос на ресурс "Приветствие" с использованием языка и региональных параметров fr-CA.</span><span class="sxs-lookup"><span data-stu-id="88f47-475">Imagine your site receives a request for a "Welcome" resource using culture "fr-CA".</span></span> <span data-ttu-id="88f47-476">Система локализации ищет в следующих ресурсах по порядку и выбирает первое совпадение:</span><span class="sxs-lookup"><span data-stu-id="88f47-476">The localization system looks for the following resources, in order, and selects the first match:</span></span>

* <span data-ttu-id="88f47-477">*Welcome.fr-CA.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-477">*Welcome.fr-CA.resx*</span></span>
* <span data-ttu-id="88f47-478">*Welcome.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-478">*Welcome.fr.resx*</span></span>
* <span data-ttu-id="88f47-479">*Welcome.resx* (если `NeutralResourcesLanguage` — fr-CA)</span><span class="sxs-lookup"><span data-stu-id="88f47-479">*Welcome.resx* (if the `NeutralResourcesLanguage` is "fr-CA")</span></span>

<span data-ttu-id="88f47-480">Если вы удалите указатель языка и региональных параметров ".fr" и при этом задан французский язык и региональные параметры, будет считан файл ресурсов по умолчанию и строки локализуются.</span><span class="sxs-lookup"><span data-stu-id="88f47-480">As an example, if you remove the ".fr" culture designator and you have the culture set to French, the default resource file is read and strings are localized.</span></span> <span data-ttu-id="88f47-481">Диспетчер ресурсов назначает ресурс по умолчанию или резервный ресурс на тот случай, когда соответствия запрошенному языку и региональным параметрам не найдено.</span><span class="sxs-lookup"><span data-stu-id="88f47-481">The Resource manager designates a default or fallback resource for when nothing meets your requested culture.</span></span> <span data-ttu-id="88f47-482">Если нужно, чтобы при отсутствии ресурса для запрошенного языка и региональных параметров просто возвращался ключ, не используйте файл ресурсов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-482">If you want to just return the key when missing a resource for the requested culture you must not have a default resource file.</span></span>

### <a name="generate-resource-files-with-visual-studio"></a><span data-ttu-id="88f47-483">Создание файлов ресурсов с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88f47-483">Generate resource files with Visual Studio</span></span>

<span data-ttu-id="88f47-484">Если вы создаете в Visual Studio файл ресурсов, в имени которого не указаны язык и региональные параметры (например, *Welcome.resx*), Visual Studio создаст класс C# со свойством для каждой строки.</span><span class="sxs-lookup"><span data-stu-id="88f47-484">If you create a resource file in Visual Studio without a culture in the file name (for example, *Welcome.resx*), Visual Studio will create a C# class with a property for each string.</span></span> <span data-ttu-id="88f47-485">В ASP.NET Core обычно требуется иное поведение.</span><span class="sxs-lookup"><span data-stu-id="88f47-485">That's usually not what you want with ASP.NET Core.</span></span> <span data-ttu-id="88f47-486">Как правило, файл ресурсов *RESX* по умолчанию (файл *RESX* без указания языка и региональных параметров) не используется.</span><span class="sxs-lookup"><span data-stu-id="88f47-486">You typically don't have a default *.resx* resource file (a *.resx* file without the culture name).</span></span> <span data-ttu-id="88f47-487">Мы рекомендуем создать файл *RESX* с указанием языка и региональных параметров (например, *Welcome.fr.resx*).</span><span class="sxs-lookup"><span data-stu-id="88f47-487">We suggest you create the *.resx* file with a culture name (for example *Welcome.fr.resx*).</span></span> <span data-ttu-id="88f47-488">При создании файла *RESX* с указанием языка и региональных параметров среда Visual Studio не создает файл класса.</span><span class="sxs-lookup"><span data-stu-id="88f47-488">When you create a *.resx* file with a culture name, Visual Studio won't generate the class file.</span></span>

### <a name="add-other-cultures"></a><span data-ttu-id="88f47-489">Добавление других языков и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="88f47-489">Add other cultures</span></span>

<span data-ttu-id="88f47-490">Каждое сочетание языка и региональных параметров (кроме языка по умолчанию) требует уникального файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-490">Each language and culture combination (other than the default language) requires a unique resource file.</span></span> <span data-ttu-id="88f47-491">Создавая файлы ресурсов для разных языков, языковых стандартов и региональных параметров, вы включаете в их имена коды языков ISO (например, **en-us**, **ru-ru** и **fr-ca**).</span><span class="sxs-lookup"><span data-stu-id="88f47-491">You create resource files for different cultures and locales by creating new resource files in which the ISO language codes are part of the file name (for example, **en-us**, **fr-ca**, and **en-gb**).</span></span> <span data-ttu-id="88f47-492">Эти коды ISO помещаются между именем файла и расширением *RESX*, например *Welcome.es-MX.resx* (испанский, Мексика).</span><span class="sxs-lookup"><span data-stu-id="88f47-492">These ISO codes are placed between the file name and the *.resx* file extension, as in *Welcome.es-MX.resx* (Spanish/Mexico).</span></span>

## <a name="implement-a-strategy-to-select-the-languageculture-for-each-request"></a><span data-ttu-id="88f47-493">реализацию стратегии по выбору языка и региональных параметров для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-493">Implement a strategy to select the language/culture for each request</span></span>

### <a name="configure-localization"></a><span data-ttu-id="88f47-494">Настройка локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-494">Configure localization</span></span>

<span data-ttu-id="88f47-495">Локализация настраивается в методе `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="88f47-495">Localization is configured in the `Startup.ConfigureServices` method:</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Startup.cs?name=snippet1)]

* <span data-ttu-id="88f47-496">Метод `AddLocalization` добавляет службы локализации в контейнер служб.</span><span class="sxs-lookup"><span data-stu-id="88f47-496">`AddLocalization` adds the localization services to the services container.</span></span> <span data-ttu-id="88f47-497">В приведенном выше коде также задается путь к ресурсам "Resources".</span><span class="sxs-lookup"><span data-stu-id="88f47-497">The code above also sets the resources path to "Resources".</span></span>

* <span data-ttu-id="88f47-498">Метод `AddViewLocalization` добавляет поддержку файлов локализованных представлений.</span><span class="sxs-lookup"><span data-stu-id="88f47-498">`AddViewLocalization` adds support for localized view files.</span></span> <span data-ttu-id="88f47-499">В этом примере локализация образца представления основана на суффиксе файла представления,</span><span class="sxs-lookup"><span data-stu-id="88f47-499">In this sample view localization is based on the view file suffix.</span></span> <span data-ttu-id="88f47-500">например "fr" в файле *Index.fr.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="88f47-500">For example "fr" in the *Index.fr.cshtml* file.</span></span>

* <span data-ttu-id="88f47-501">Метод `AddDataAnnotationsLocalization` добавляет поддержку локализованных сообщений проверки `DataAnnotations` посредством абстракций `IStringLocalizer`.</span><span class="sxs-lookup"><span data-stu-id="88f47-501">`AddDataAnnotationsLocalization` adds support for localized `DataAnnotations` validation messages through `IStringLocalizer` abstractions.</span></span>

### <a name="localization-middleware"></a><span data-ttu-id="88f47-502">Промежуточный слой локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-502">Localization middleware</span></span>

<span data-ttu-id="88f47-503">Текущий язык и региональные параметры в запросе задаются в [промежуточном слое](xref:fundamentals/middleware/index) локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-503">The current culture on a request is set in the localization [Middleware](xref:fundamentals/middleware/index).</span></span> <span data-ttu-id="88f47-504">Промежуточный слой локализации включается в методе `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="88f47-504">The localization middleware is enabled in the `Startup.Configure` method.</span></span> <span data-ttu-id="88f47-505">Промежуточный слой локализации должен настраиваться перед другими промежуточными слоями, которые могут проверять язык и региональные параметры запроса (например, `app.UseMvcWithDefaultRoute()`).</span><span class="sxs-lookup"><span data-stu-id="88f47-505">The localization middleware must be configured before any middleware which might check the request culture (for example, `app.UseMvcWithDefaultRoute()`).</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Startup.cs?name=snippet2)]

[!INCLUDE[about the series](~/includes/code-comments-loc.md)]

<span data-ttu-id="88f47-506">`UseRequestLocalization` инициализирует объект `RequestLocalizationOptions`.</span><span class="sxs-lookup"><span data-stu-id="88f47-506">`UseRequestLocalization` initializes a `RequestLocalizationOptions` object.</span></span> <span data-ttu-id="88f47-507">При каждом запросе проверяется список поставщиков `RequestCultureProvider` в объекте `RequestLocalizationOptions` и используется первый поставщик, который может успешно определить язык и региональные параметры запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-507">On every request the list of `RequestCultureProvider` in the `RequestLocalizationOptions` is enumerated and the first provider that can successfully determine the request culture is used.</span></span> <span data-ttu-id="88f47-508">Поставщики по умолчанию берутся из класса `RequestLocalizationOptions`:</span><span class="sxs-lookup"><span data-stu-id="88f47-508">The default providers come from the `RequestLocalizationOptions` class:</span></span>

1. `QueryStringRequestCultureProvider`
1. `CookieRequestCultureProvider`
1. `AcceptLanguageHeaderRequestCultureProvider`

<span data-ttu-id="88f47-509">В списке по умолчанию поставщики следуют от наиболее конкретных до наиболее общих.</span><span class="sxs-lookup"><span data-stu-id="88f47-509">The default list goes from most specific to least specific.</span></span> <span data-ttu-id="88f47-510">Далее в этой статье вы узнаете, как можно изменить этот порядок и даже добавить пользовательский поставщик языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-510">Later in the article we'll see how you can change the order and even add a custom culture provider.</span></span> <span data-ttu-id="88f47-511">Если ни один из поставщиков не может определить язык и региональные параметры запроса, используется `DefaultRequestCulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-511">If none of the providers can determine the request culture, the `DefaultRequestCulture` is used.</span></span>

### <a name="querystringrequestcultureprovider"></a><span data-ttu-id="88f47-512">QueryStringRequestCultureProvider</span><span class="sxs-lookup"><span data-stu-id="88f47-512">QueryStringRequestCultureProvider</span></span>

<span data-ttu-id="88f47-513">Некоторые приложения используют строку запроса для указания <https://docs.microsoft.com/dotnet/api/system.globalization.cultureinfo?view=netcore-3.1>.</span><span class="sxs-lookup"><span data-stu-id="88f47-513">Some apps will use a query string to set the <https://docs.microsoft.com/dotnet/api/system.globalization.cultureinfo?view=netcore-3.1>.</span></span> <span data-ttu-id="88f47-514">Если в приложении для этого применяется файл cookie или заголовок Accept-Language, добавление строки запроса к URL-адресу может быть полезным в целях отладки и тестирования кода.</span><span class="sxs-lookup"><span data-stu-id="88f47-514">For apps that use the cookie or Accept-Language header approach, adding a query string to the URL is useful for debugging and testing code.</span></span> <span data-ttu-id="88f47-515">По умолчанию поставщик `QueryStringRequestCultureProvider` регистрируется в качестве первого поставщика локализации в списке `RequestCultureProvider`.</span><span class="sxs-lookup"><span data-stu-id="88f47-515">By default, the `QueryStringRequestCultureProvider` is registered as the first localization provider in the `RequestCultureProvider` list.</span></span> <span data-ttu-id="88f47-516">Вы передаете параметры строки запроса `culture` и `ui-culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-516">You pass the query string parameters `culture` and `ui-culture`.</span></span> <span data-ttu-id="88f47-517">В следующем примере в качестве языка и региональных параметров (язык и регион) задаются испанский язык и Мексика:</span><span class="sxs-lookup"><span data-stu-id="88f47-517">The following example sets the specific culture (language and region) to Spanish/Mexico:</span></span>

```
http://localhost:5000/?culture=es-MX&ui-culture=es-MX
```

<span data-ttu-id="88f47-518">Если передан только один из двух параметров (`culture` или `ui-culture`), поставщик строки запроса задаст с его помощью оба значения.</span><span class="sxs-lookup"><span data-stu-id="88f47-518">If you only pass in one of the two (`culture` or `ui-culture`), the query string provider will set both values using the one you passed in.</span></span> <span data-ttu-id="88f47-519">Например, если передан только язык и региональные параметры, будут заданы оба значения `Culture` и `UICulture`:</span><span class="sxs-lookup"><span data-stu-id="88f47-519">For example, setting just the culture will set both the `Culture` and the `UICulture`:</span></span>

```
http://localhost:5000/?culture=es-MX
```

### <a name="no-loccookierequestcultureprovider"></a><span data-ttu-id="88f47-520">CookieRequestCultureProvider</span><span class="sxs-lookup"><span data-stu-id="88f47-520">CookieRequestCultureProvider</span></span>

<span data-ttu-id="88f47-521">Рабочие приложения часто предоставляют механизм для указания языка и региональных параметров с помощью соответствующего файла cookie ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88f47-521">Production apps will often provide a mechanism to set the culture with the ASP.NET Core culture cookie.</span></span> <span data-ttu-id="88f47-522">Чтобы создать файл `MakeCookieValue`, используйте метод cookie.</span><span class="sxs-lookup"><span data-stu-id="88f47-522">Use the `MakeCookieValue` method to create a cookie.</span></span>

<span data-ttu-id="88f47-523">`CookieRequestCultureProvider` `DefaultCookieName` возвращает имя файла cookie по умолчанию, с помощью которого отслеживается предпочтительный язык и региональные параметры пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-523">The `CookieRequestCultureProvider` `DefaultCookieName` returns the default cookie name used to track the user's preferred culture information.</span></span> <span data-ttu-id="88f47-524">Имя cookie по умолчанию — `.AspNetCore.Culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-524">The default cookie name is `.AspNetCore.Culture`.</span></span>

<span data-ttu-id="88f47-525">Файл cookie имеет формат `c=%LANGCODE%|uic=%LANGCODE%`, где `c` — это `Culture`, а `uic` — это `UICulture`, например:</span><span class="sxs-lookup"><span data-stu-id="88f47-525">The cookie format is `c=%LANGCODE%|uic=%LANGCODE%`, where `c` is `Culture` and `uic` is `UICulture`, for example:</span></span>

```
c=en-UK|uic=en-US
```

<span data-ttu-id="88f47-526">Если указаны либо только язык и региональные параметры, либо только язык и региональные параметры пользовательского интерфейса, это значение будет использоваться для обоих параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-526">If you only specify one of culture info and UI culture, the specified culture will be used for both culture info and UI culture.</span></span>

### <a name="the-accept-language-http-header"></a><span data-ttu-id="88f47-527">Заголовок HTTP Accept-Language</span><span class="sxs-lookup"><span data-stu-id="88f47-527">The Accept-Language HTTP header</span></span>

<span data-ttu-id="88f47-528">[Заголовок Accept-Language](https://www.w3.org/International/questions/qa-accept-lang-locales) может задаваться в большинстве браузеров и изначально предназначался для указания языка пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-528">The [Accept-Language header](https://www.w3.org/International/questions/qa-accept-lang-locales) is settable in most browsers and was originally intended to specify the user's language.</span></span> <span data-ttu-id="88f47-529">Он показывает, какой язык был выбран в браузере или унаследован от базовой операционной системы.</span><span class="sxs-lookup"><span data-stu-id="88f47-529">This setting indicates what the browser has been set to send or has inherited from the underlying operating system.</span></span> <span data-ttu-id="88f47-530">Заголовок HTTP Accept-Language в запросе из браузера — это не самый надежный способ определения предпочтительного языка пользователя (см. статью [Настройка языковых предпочтений в браузере](https://www.w3.org/International/questions/qa-lang-priorities.en.php)).</span><span class="sxs-lookup"><span data-stu-id="88f47-530">The Accept-Language HTTP header from a browser request isn't an infallible way to detect the user's preferred language (see [Setting language preferences in a browser](https://www.w3.org/International/questions/qa-lang-priorities.en.php)).</span></span> <span data-ttu-id="88f47-531">В рабочем приложении должна быть возможность выбора языка и региональных параметров пользователем.</span><span class="sxs-lookup"><span data-stu-id="88f47-531">A production app should include a way for a user to customize their choice of culture.</span></span>

### <a name="set-the-accept-language-http-header-in-ie"></a><span data-ttu-id="88f47-532">Задание заголовка HTTP Accept-Language в Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="88f47-532">Set the Accept-Language HTTP header in IE</span></span>

1. <span data-ttu-id="88f47-533">Щелкните значок шестеренки и выберите пункт **Свойства браузера**.</span><span class="sxs-lookup"><span data-stu-id="88f47-533">From the gear icon, tap **Internet Options**.</span></span>

1. <span data-ttu-id="88f47-534">Нажмите кнопку **Языки**.</span><span class="sxs-lookup"><span data-stu-id="88f47-534">Tap **Languages**.</span></span>

   ![Свойства браузера](localization/_static/lang.png)

1. <span data-ttu-id="88f47-536">Нажмите **Задать предпочитаемые языки**.</span><span class="sxs-lookup"><span data-stu-id="88f47-536">Tap **Set Language Preferences**.</span></span>

1. <span data-ttu-id="88f47-537">Нажмите **Добавить язык**.</span><span class="sxs-lookup"><span data-stu-id="88f47-537">Tap **Add a language**.</span></span>

1. <span data-ttu-id="88f47-538">Добавьте язык.</span><span class="sxs-lookup"><span data-stu-id="88f47-538">Add the language.</span></span>

1. <span data-ttu-id="88f47-539">Выберите язык, а затем нажмите кнопку **Вверх**.</span><span class="sxs-lookup"><span data-stu-id="88f47-539">Tap the language, then tap **Move Up**.</span></span>

### <a name="use-a-custom-provider"></a><span data-ttu-id="88f47-540">Использование пользовательского поставщика</span><span class="sxs-lookup"><span data-stu-id="88f47-540">Use a custom provider</span></span>

<span data-ttu-id="88f47-541">Предположим, необходимо, чтобы ваши клиенты могли сохранять информацию о своем языке и региональных параметрах в ваших базах данных.</span><span class="sxs-lookup"><span data-stu-id="88f47-541">Suppose you want to let your customers store their language and culture in your databases.</span></span> <span data-ttu-id="88f47-542">Можно написать поставщик, который будет искать эти значения для пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-542">You could write a provider to look up these values for the user.</span></span> <span data-ttu-id="88f47-543">В следующем примере кода показано, как добавить пользовательский поставщик:</span><span class="sxs-lookup"><span data-stu-id="88f47-543">The following code shows how to add a custom provider:</span></span>

```csharp
private const string enUSCulture = "en-US";

services.Configure<RequestLocalizationOptions>(options =>
{
    var supportedCultures = new[]
    {
        new CultureInfo(enUSCulture),
        new CultureInfo("fr")
    };

    options.DefaultRequestCulture = new RequestCulture(culture: enUSCulture, uiCulture: enUSCulture);
    options.SupportedCultures = supportedCultures;
    options.SupportedUICultures = supportedCultures;

    options.RequestCultureProviders.Insert(0, new CustomRequestCultureProvider(async context =>
    {
        // My custom request culture logic
        return new ProviderCultureResult("en");
    }));
});
```

<span data-ttu-id="88f47-544">Для добавления или удаления поставщиков локализации используйте объект `RequestLocalizationOptions`.</span><span class="sxs-lookup"><span data-stu-id="88f47-544">Use `RequestLocalizationOptions` to add or remove localization providers.</span></span>

### <a name="set-the-culture-programmatically"></a><span data-ttu-id="88f47-545">Задание языка и региональных параметров программным образом</span><span class="sxs-lookup"><span data-stu-id="88f47-545">Set the culture programmatically</span></span>

<span data-ttu-id="88f47-546">В образце проекта **Localization.StarterWeb** в [GitHub](https://github.com/aspnet/entropy) есть пользовательский интерфейс для задания значения `Culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-546">This sample **Localization.StarterWeb** project on [GitHub](https://github.com/aspnet/entropy) contains UI to set the `Culture`.</span></span> <span data-ttu-id="88f47-547">Файл *Views/Shared/_SelectLanguagePartial.cshtml* позволяет выбрать язык и региональные параметры из списка поддерживаемых:</span><span class="sxs-lookup"><span data-stu-id="88f47-547">The *Views/Shared/_SelectLanguagePartial.cshtml* file allows you to select the culture from the list of supported cultures:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Shared/_SelectLanguagePartial.cshtml)]

<span data-ttu-id="88f47-548">Файл *Views/Shared/_SelectLanguagePartial.cshtml* добавляется в раздел `footer` файла макета, поэтому он доступен всем представлениям:</span><span class="sxs-lookup"><span data-stu-id="88f47-548">The *Views/Shared/_SelectLanguagePartial.cshtml* file is added to the `footer` section of the layout file so it will be available to all views:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Shared/_Layout.cshtml?range=43-56&highlight=10)]

<span data-ttu-id="88f47-549">Метод `SetLanguage` задает файл cookie языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-549">The `SetLanguage` method sets the culture cookie.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/HomeController.cs?range=57-67)]

<span data-ttu-id="88f47-550">Подключить файл *_SelectLanguagePartial.cshtml* к образцу кода этого проекта нельзя.</span><span class="sxs-lookup"><span data-stu-id="88f47-550">You can't plug in the *_SelectLanguagePartial.cshtml* to sample code for this project.</span></span> <span data-ttu-id="88f47-551">В проекте **Localization.StarterWeb** в [GitHub](https://github.com/aspnet/entropy) есть код для передачи объекта `RequestLocalizationOptions` в частичное представление Razor посредством контейнера [внедрения зависимостей](dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="88f47-551">The **Localization.StarterWeb** project on [GitHub](https://github.com/aspnet/entropy) has code to flow the `RequestLocalizationOptions` to a Razor partial through the [Dependency Injection](dependency-injection.md) container.</span></span>

## <a name="model-binding-route-data-and-query-strings"></a><span data-ttu-id="88f47-552">Данные маршрутов привязки модели и строки запросов</span><span class="sxs-lookup"><span data-stu-id="88f47-552">Model binding route data and query strings</span></span>

<span data-ttu-id="88f47-553">См. раздел [Поведение глобализации для данных маршрутов привязки модели и строк запросов](xref:mvc/models/model-binding#glob).</span><span class="sxs-lookup"><span data-stu-id="88f47-553">See [Globalization behavior of model binding route data and query strings](xref:mvc/models/model-binding#glob).</span></span>

## <a name="globalization-and-localization-terms"></a><span data-ttu-id="88f47-554">Термины, относящиеся к глобализации и локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-554">Globalization and localization terms</span></span>

<span data-ttu-id="88f47-555">Процесс локализации приложения требует базового понимания распространенных кодировок, часто используемых при разработке современного программного обеспечения, и связанных с ними проблем.</span><span class="sxs-lookup"><span data-stu-id="88f47-555">The process of localizing your app also requires a basic understanding of relevant character sets commonly used in modern software development and an understanding of the issues associated with them.</span></span> <span data-ttu-id="88f47-556">Хотя на всех компьютерах текст сохраняется в виде цифр (кодов), в разных системах эти коды для одного и того же текста различаются.</span><span class="sxs-lookup"><span data-stu-id="88f47-556">Although all computers store text as numbers (codes), different systems store the same text using different numbers.</span></span> <span data-ttu-id="88f47-557">Под процессом локализации понимается перевод пользовательского интерфейса приложения для определенного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-557">The localization process refers to translating the app user interface (UI) for a specific culture/locale.</span></span>

<span data-ttu-id="88f47-558">[Возможность локализации](/dotnet/standard/globalization-localization/localizability-review) — это определяемое на промежуточной стадии состояние готовности глобализованного приложения к локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-558">[Localizability](/dotnet/standard/globalization-localization/localizability-review) is an intermediate process for verifying that a globalized app is ready for localization.</span></span>

<span data-ttu-id="88f47-559">Формат [RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) для названия языка и региональных параметров имеет вид `<languagecode2>-<country/regioncode2>`, где `<languagecode2>` — это код языка, а `<country/regioncode2>` — код субкультуры.</span><span class="sxs-lookup"><span data-stu-id="88f47-559">The [RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) format for the culture name is `<languagecode2>-<country/regioncode2>`, where `<languagecode2>` is the language code and `<country/regioncode2>` is the subculture code.</span></span> <span data-ttu-id="88f47-560">Примеры: `es-CL` для испанского языка (Чили), `en-US` для английского языка (США), `en-AU` для английского языка (Австралия).</span><span class="sxs-lookup"><span data-stu-id="88f47-560">For example, `es-CL` for Spanish (Chile), `en-US` for English (United States), and `en-AU` for English (Australia).</span></span> <span data-ttu-id="88f47-561">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) — это комбинация двухбуквенного кода культуры ISO 639 в нижнем регистре (он связан с языком) и двухбуквенного кода субкультуры ISO 3166 в верхнем регистре (он связан со страной или регионом).</span><span class="sxs-lookup"><span data-stu-id="88f47-561">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) is a combination of an ISO 639 two-letter lowercase culture code associated with a language and an ISO 3166 two-letter uppercase subculture code associated with a country or region.</span></span> <span data-ttu-id="88f47-562">См. раздел <https://docs.microsoft.com/previous-versions/commerce-server/ee825488(v=cs.20)>.</span><span class="sxs-lookup"><span data-stu-id="88f47-562">See <https://docs.microsoft.com/previous-versions/commerce-server/ee825488(v=cs.20)>.</span></span>

<span data-ttu-id="88f47-563">Вместо слова "интернационализация" (internationalization) часто используют аббревиатуру "I18N".</span><span class="sxs-lookup"><span data-stu-id="88f47-563">Internationalization is often abbreviated to "I18N".</span></span> <span data-ttu-id="88f47-564">В аббревиатуру включаются первая и последняя буквы слова, а также число букв между ними, то есть 18 — это число букв между первой ("I") и последней ("N") буквами.</span><span class="sxs-lookup"><span data-stu-id="88f47-564">The abbreviation takes the first and last letters and the number of letters between them, so 18 stands for the number of letters between the first "I" and the last "N".</span></span> <span data-ttu-id="88f47-565">То же самое касается глобализации (Globalization — G11N) и локализации (Localization — L10N).</span><span class="sxs-lookup"><span data-stu-id="88f47-565">The same applies to Globalization (G11N), and Localization (L10N).</span></span>

<span data-ttu-id="88f47-566">Термины:</span><span class="sxs-lookup"><span data-stu-id="88f47-566">Terms:</span></span>

* <span data-ttu-id="88f47-567">Глобализация (G11N): процесс подготовки приложения к поддержке различных языков и регионов.</span><span class="sxs-lookup"><span data-stu-id="88f47-567">Globalization (G11N): The process of making an app support different languages and regions.</span></span>
* <span data-ttu-id="88f47-568">Локализация (L10N): процесс настройки приложения для работы с конкретным языком и регионом.</span><span class="sxs-lookup"><span data-stu-id="88f47-568">Localization (L10N): The process of customizing an app for a given language and region.</span></span>
* <span data-ttu-id="88f47-569">Интернационализация (I18N): описывает глобализацию и локализацию.</span><span class="sxs-lookup"><span data-stu-id="88f47-569">Internationalization (I18N): Describes both globalization and localization.</span></span>
* <span data-ttu-id="88f47-570">Язык и региональные параметры: обозначает язык и (необязательно) регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-570">Culture: It's a language and, optionally, a region.</span></span>
* <span data-ttu-id="88f47-571">Нейтральный язык и региональные параметры: язык и региональные параметры, для которых указан язык, но не регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-571">Neutral culture: A culture that has a specified language, but not a region.</span></span> <span data-ttu-id="88f47-572">(например, "en", "es").</span><span class="sxs-lookup"><span data-stu-id="88f47-572">(for example "en", "es")</span></span>
* <span data-ttu-id="88f47-573">Конкретный язык и региональные параметры: язык и региональные параметры, для которых указаны язык и регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-573">Specific culture: A culture that has a specified language and region.</span></span> <span data-ttu-id="88f47-574">(например, "en-US", "en-GB", "es-CL").</span><span class="sxs-lookup"><span data-stu-id="88f47-574">(for example "en-US", "en-GB", "es-CL")</span></span>
* <span data-ttu-id="88f47-575">Родительский язык и региональные параметры: нейтральные язык и региональные параметры, содержащие конкретные язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-575">Parent culture: The neutral culture that contains a specific culture.</span></span> <span data-ttu-id="88f47-576">(например, "en" — это родительские язык и региональные параметры для "en-US" и "en-GB").</span><span class="sxs-lookup"><span data-stu-id="88f47-576">(for example, "en" is the parent culture of "en-US" and "en-GB")</span></span>
* <span data-ttu-id="88f47-577">Языковой стандарт: тот же, что и язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-577">Locale: A locale is the same as a culture.</span></span>

[!INCLUDE[](~/includes/localization/currency.md)]

## <a name="additional-resources"></a><span data-ttu-id="88f47-578">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="88f47-578">Additional resources</span></span>

* <xref:fundamentals/troubleshoot-aspnet-core-localization>
* <span data-ttu-id="88f47-579">[Проект Localization.StarterWeb](https://github.com/aspnet/Entropy/tree/master/samples/Localization.StarterWeb), используемый в этой статье.</span><span class="sxs-lookup"><span data-stu-id="88f47-579">[Localization.StarterWeb project](https://github.com/aspnet/Entropy/tree/master/samples/Localization.StarterWeb) used in the article.</span></span>
* [<span data-ttu-id="88f47-580">Глобализация и локализация приложений .NET</span><span class="sxs-lookup"><span data-stu-id="88f47-580">Globalizing and localizing .NET applications</span></span>](/dotnet/standard/globalization-localization/index)
* [<span data-ttu-id="88f47-581">Ресурсы в RESX-файлах</span><span class="sxs-lookup"><span data-stu-id="88f47-581">Resources in .resx Files</span></span>](/dotnet/framework/resources/working-with-resx-files-programmatically)
* [<span data-ttu-id="88f47-582">Набор средств многоязычных приложений Майкрософт</span><span class="sxs-lookup"><span data-stu-id="88f47-582">Microsoft Multilingual App Toolkit</span></span>](https://marketplace.visualstudio.com/items?itemName=MultilingualAppToolkit.MultilingualAppToolkit-18308)
* [<span data-ttu-id="88f47-583">Локализация и универсальные шаблоны</span><span class="sxs-lookup"><span data-stu-id="88f47-583">Localization & Generics</span></span>](http://hishambinateya.com/localization-and-generics)

::: moniker-end

<!-- ASP.NET Core 5.x starts here -->
::: moniker range="> aspnetcore-3.1"

<span data-ttu-id="88f47-584">Авторы: [Рик Андерсон](https://twitter.com/RickAndMSFT) (Rick Anderson), [Дэмиен Боуден](https://twitter.com/damien_bod) (Damien Bowden), [Барт Каликсто](https://twitter.com/bartmax) (Bart Calixto), [Надим Афана](https://afana.me/) (Nadeem Afana) и [Хишам Бин Атея](https://twitter.com/hishambinateya) (Hisham Bin Ateya)</span><span class="sxs-lookup"><span data-stu-id="88f47-584">By [Rick Anderson](https://twitter.com/RickAndMSFT), [Damien Bowden](https://twitter.com/damien_bod), [Bart Calixto](https://twitter.com/bartmax), [Nadeem Afana](https://afana.me/), and [Hisham Bin Ateya](https://twitter.com/hishambinateya)</span></span>

<span data-ttu-id="88f47-585">Создание многоязычного веб-сайта позволит расширить аудиторию.</span><span class="sxs-lookup"><span data-stu-id="88f47-585">A multilingual website allows the site to reach a wider audience.</span></span> <span data-ttu-id="88f47-586">ASP.NET Core предоставляет службы и ПО промежуточного слоя для локализации на разные языки и для разных региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-586">ASP.NET Core provides services and middleware for localizing into different languages and cultures.</span></span>

<span data-ttu-id="88f47-587">Интернационализация предполагает [глобализацию](/dotnet/api/system.globalization) и [локализацию](/dotnet/standard/globalization-localization/localization).</span><span class="sxs-lookup"><span data-stu-id="88f47-587">Internationalization involves [Globalization](/dotnet/api/system.globalization) and [Localization](/dotnet/standard/globalization-localization/localization).</span></span> <span data-ttu-id="88f47-588">Глобализация — это процесс разработки приложений, которые поддерживают разные языки и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-588">Globalization is the process of designing apps that support different cultures.</span></span> <span data-ttu-id="88f47-589">Глобализация добавляет поддержку ввода отображения и вывода определенного набора языковых сценариев, относящихся к конкретным регионам.</span><span class="sxs-lookup"><span data-stu-id="88f47-589">Globalization adds support for input, display, and output of a defined set of language scripts that relate to specific geographic areas.</span></span>

<span data-ttu-id="88f47-590">Локализация — это процесс адаптации глобализованного приложения, уже подготовленного к локализации, к определенному языку, языковому стандарту и региональным параметрам.</span><span class="sxs-lookup"><span data-stu-id="88f47-590">Localization is the process of adapting a globalized app, which you have already processed for localizability, to a particular culture/locale.</span></span> <span data-ttu-id="88f47-591">Дополнительные сведения см. в разделе **Термины, относящиеся к глобализации и локализации** ближе к концу этого документа.</span><span class="sxs-lookup"><span data-stu-id="88f47-591">For more information see **Globalization and localization terms** near the end of this document.</span></span>

<span data-ttu-id="88f47-592">Локализация приложения включает следующие задачи:</span><span class="sxs-lookup"><span data-stu-id="88f47-592">App localization involves the following:</span></span>

1. <span data-ttu-id="88f47-593">обеспечение возможности локализации для содержимого приложения;</span><span class="sxs-lookup"><span data-stu-id="88f47-593">Make the app's content localizable</span></span>
1. <span data-ttu-id="88f47-594">предоставление локализованных ресурсов для поддерживаемых языков и региональных параметров;</span><span class="sxs-lookup"><span data-stu-id="88f47-594">Provide localized resources for the languages and cultures you support</span></span>
1. <span data-ttu-id="88f47-595">реализацию стратегии по выбору языка и региональных параметров для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-595">Implement a strategy to select the language/culture for each request</span></span>

<span data-ttu-id="88f47-596">[Просмотреть или скачать образец кода](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/localization/sample/2.x/) ([как скачивать](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="88f47-596">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/localization/sample/2.x/) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="make-the-apps-content-localizable"></a><span data-ttu-id="88f47-597">Обеспечение возможности локализации для содержимого приложения</span><span class="sxs-lookup"><span data-stu-id="88f47-597">Make the app's content localizable</span></span>

<span data-ttu-id="88f47-598"><xref:Microsoft.Extensions.Localization.IStringLocalizer> и <xref:Microsoft.Extensions.Localization.IStringLocalizer%601> создавались для повышения производительность при разработке локализованных приложений.</span><span class="sxs-lookup"><span data-stu-id="88f47-598"><xref:Microsoft.Extensions.Localization.IStringLocalizer> and <xref:Microsoft.Extensions.Localization.IStringLocalizer%601> were architected to improve productivity when developing localized apps.</span></span> <span data-ttu-id="88f47-599">`IStringLocalizer` использует классы <xref:System.Resources.ResourceManager> и <xref:System.Resources.ResourceReader> для предоставления ресурсов, связанных с определенным языком и региональными параметрами, во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="88f47-599">`IStringLocalizer` uses the <xref:System.Resources.ResourceManager> and <xref:System.Resources.ResourceReader> to provide culture-specific resources at run time.</span></span> <span data-ttu-id="88f47-600">Этот интерфейс имеет индексатор и интерфейс `IEnumerable` для возврата локализованных строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-600">The interface has an indexer and an `IEnumerable` for returning localized strings.</span></span> <span data-ttu-id="88f47-601">`IStringLocalizer` не требует сохранять строки на языке по умолчанию в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-601">`IStringLocalizer` doesn't require storing the default language strings in a resource file.</span></span> <span data-ttu-id="88f47-602">Вы можете разрабатывать приложение, предназначенное для локализации, не создавая файлы ресурсов на ранних этапах разработки.</span><span class="sxs-lookup"><span data-stu-id="88f47-602">You can develop an app targeted for localization and not need to create resource files early in development.</span></span> <span data-ttu-id="88f47-603">В приведенном ниже коде показано, как подготовить строку "About Title" для локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-603">The code below shows how to wrap the string "About Title" for localization.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/AboutController.cs)]

<span data-ttu-id="88f47-604">В предыдущем коде реализация `IStringLocalizer<T>` получена в результате [внедрения зависимостей](dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="88f47-604">In the preceding code, the `IStringLocalizer<T>` implementation comes from [Dependency Injection](dependency-injection.md).</span></span> <span data-ttu-id="88f47-605">Если локализованное значение для строки "About Title" не найдено, возвращается ключ индексатора, то есть строка "About Title".</span><span class="sxs-lookup"><span data-stu-id="88f47-605">If the localized value of "About Title" isn't found, then the indexer key is returned, that is, the string "About Title".</span></span> <span data-ttu-id="88f47-606">Вы можете оставить литеральные строки на языке по умолчанию и заключить их в средство локализации, чтобы сосредоточиться на разработке приложения.</span><span class="sxs-lookup"><span data-stu-id="88f47-606">You can leave the default language literal strings in the app and wrap them in the localizer, so that you can focus on developing the app.</span></span> <span data-ttu-id="88f47-607">Вы разрабатываете приложение на языке по умолчанию и подготавливаете его к локализации, не создавая предварительно файл ресурсов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-607">You develop your app with your default language and prepare it for the localization step without first creating a default resource file.</span></span> <span data-ttu-id="88f47-608">Вы также можете выбрать традиционный подход и предоставить ключ для извлечения строки на языке по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-608">Alternatively, you can use the traditional approach and provide a key to retrieve the default language string.</span></span> <span data-ttu-id="88f47-609">Для многих разработчиков новый рабочий процесс, который не требует наличия файла *RESX* на языке по умолчанию и позволяет просто заключать строки для дальнейшей обработки, может помочь снизить затраты на локализацию приложения.</span><span class="sxs-lookup"><span data-stu-id="88f47-609">For many developers the new workflow of not having a default language *.resx* file and simply wrapping the string literals can reduce the overhead of localizing an app.</span></span> <span data-ttu-id="88f47-610">Другие разработчики могут предпочесть традиционный рабочий процесс, так как он упрощает работу с более длинными строками и обновление локализованных строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-610">Other developers will prefer the traditional work flow as it can make it easier to work with longer string literals and make it easier to update localized strings.</span></span>

<span data-ttu-id="88f47-611">Используйте реализацию `IHtmlLocalizer<T>` для ресурсов, содержащих код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-611">Use the `IHtmlLocalizer<T>` implementation for resources that contain HTML.</span></span> <span data-ttu-id="88f47-612">Интерфейс `IHtmlLocalizer` кодирует в HTML аргументы, отформатированные в строке ресурса, но не кодирует в HTML саму строку.</span><span class="sxs-lookup"><span data-stu-id="88f47-612">`IHtmlLocalizer` HTML encodes arguments that are formatted in the resource string, but doesn't HTML encode the resource string itself.</span></span> <span data-ttu-id="88f47-613">В выделенной ниже строке в HTML кодируется только значение параметра `name`.</span><span class="sxs-lookup"><span data-stu-id="88f47-613">In the sample highlighted below, only the value of `name` parameter is HTML encoded.</span></span>

[!code-csharp[](~/fundamentals/localization/sample/3.x/Localization/Controllers/BookController.cs?highlight=3,5,20&start=1&end=24)]

> [!NOTE]
> <span data-ttu-id="88f47-614">Как правило, требуется локализовать только текст, но не код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-614">Generally, only localize text, not HTML.</span></span>

<span data-ttu-id="88f47-615">На самом нижнем уровне интерфейс `IStringLocalizerFactory` можно получить из [внедрения зависимостей](dependency-injection.md):</span><span class="sxs-lookup"><span data-stu-id="88f47-615">At the lowest level, you can get `IStringLocalizerFactory` out of [Dependency Injection](dependency-injection.md):</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/TestController.cs?start=9&end=26&highlight=7-13)]

<span data-ttu-id="88f47-616">В приведенном выше коде демонстрируются оба фабричных метода создания.</span><span class="sxs-lookup"><span data-stu-id="88f47-616">The code above demonstrates each of the two factory create methods.</span></span>

<span data-ttu-id="88f47-617">Вы можете разбивать локализованные строки по контроллеру, области или использовать всего один конвейер.</span><span class="sxs-lookup"><span data-stu-id="88f47-617">You can partition your localized strings by controller, area, or have just one container.</span></span> <span data-ttu-id="88f47-618">В образце приложения для общих ресурсов применяется класс-заглушка с именем `SharedResource`.</span><span class="sxs-lookup"><span data-stu-id="88f47-618">In the sample app, a dummy class named `SharedResource` is used for shared resources.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/SharedResource.cs)]

<span data-ttu-id="88f47-619">Некоторые разработчики используют класс `Startup` для хранения глобальных или общих строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-619">Some developers use the `Startup` class to contain global or shared strings.</span></span> <span data-ttu-id="88f47-620">В примере ниже используются средства локализации `InfoController` и `SharedResource`.</span><span class="sxs-lookup"><span data-stu-id="88f47-620">In the sample below, the `InfoController` and the `SharedResource` localizers are used:</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/InfoController.cs?range=9-26)]

## <a name="view-localization"></a><span data-ttu-id="88f47-621">Локализация представления</span><span class="sxs-lookup"><span data-stu-id="88f47-621">View localization</span></span>

<span data-ttu-id="88f47-622">Служба `IViewLocalizer` предоставляет локализованные строки для [представления](xref:mvc/views/overview).</span><span class="sxs-lookup"><span data-stu-id="88f47-622">The `IViewLocalizer` service provides localized strings for a [view](xref:mvc/views/overview).</span></span> <span data-ttu-id="88f47-623">Класс `ViewLocalizer` реализует этот интерфейс и находит расположение ресурсов по пути к файлу представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-623">The `ViewLocalizer` class implements this interface and finds the resource location from the view file path.</span></span> <span data-ttu-id="88f47-624">В следующем примере кода демонстрируется использование реализации `IViewLocalizer` по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="88f47-624">The following code shows how to use the default implementation of `IViewLocalizer`:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Home/About.cshtml)]

<span data-ttu-id="88f47-625">Реализация `IViewLocalizer` по умолчанию находит файл ресурсов по имени файла представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-625">The default implementation of `IViewLocalizer` finds the resource file based on the view's file name.</span></span> <span data-ttu-id="88f47-626">Возможности использовать глобальный общий файл ресурсов нет.</span><span class="sxs-lookup"><span data-stu-id="88f47-626">There's no option to use a global shared resource file.</span></span> <span data-ttu-id="88f47-627">`ViewLocalizer` реализует средство локализации с помощью интерфейса `IHtmlLocalizer`, поэтому Razor не кодирует локализованную строку в HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-627">`ViewLocalizer` implements the localizer using `IHtmlLocalizer`, so Razor doesn't HTML encode the localized string.</span></span> <span data-ttu-id="88f47-628">Вы можете параметризовать строки ресурсов, и `IViewLocalizer` будет кодировать в HTML параметры, но не строки ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-628">You can parameterize resource strings and `IViewLocalizer` will HTML encode the parameters, but not the resource string.</span></span> <span data-ttu-id="88f47-629">Рассмотрим следующую разметку Razor:</span><span class="sxs-lookup"><span data-stu-id="88f47-629">Consider the following Razor markup:</span></span>

```cshtml
@Localizer["<i>Hello</i> <b>{0}!</b>", UserManager.GetUserName(User)]
```

<span data-ttu-id="88f47-630">Файл ресурсов на французском языке может содержать следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="88f47-630">A French resource file could contain the following:</span></span>

| <span data-ttu-id="88f47-631">Ключ</span><span class="sxs-lookup"><span data-stu-id="88f47-631">Key</span></span> | <span data-ttu-id="88f47-632">Значение</span><span class="sxs-lookup"><span data-stu-id="88f47-632">Value</span></span> |
| --- | ----- |
| `<i>Hello</i> <b>{0}!</b>` | `<i>Bonjour</i> <b>{0} !</b>` |

<span data-ttu-id="88f47-633">Преобразованное для просмотра представление будет содержать разметку HTML из файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-633">The rendered view would contain the HTML markup from the resource file.</span></span>

> [!NOTE]
> <span data-ttu-id="88f47-634">Как правило, требуется локализовать только текст, но не код HTML.</span><span class="sxs-lookup"><span data-stu-id="88f47-634">Generally, only localize text, not HTML.</span></span>

<span data-ttu-id="88f47-635">Чтобы использовать в представлении общий файл ресурсов, внедрите `IHtmlLocalizer<T>`:</span><span class="sxs-lookup"><span data-stu-id="88f47-635">To use a shared resource file in a view, inject `IHtmlLocalizer<T>`:</span></span>

[!code-cshtml[](~/fundamentals/localization/sample/3.x/Localization/Views/Test/About.cshtml?highlight=5,12)]

## <a name="dataannotations-localization"></a><span data-ttu-id="88f47-636">Локализация DataAnnotations</span><span class="sxs-lookup"><span data-stu-id="88f47-636">DataAnnotations localization</span></span>

<span data-ttu-id="88f47-637">Сообщения об ошибках DataAnnotations локализуются с помощью `IStringLocalizer<T>`.</span><span class="sxs-lookup"><span data-stu-id="88f47-637">DataAnnotations error messages are localized with `IStringLocalizer<T>`.</span></span> <span data-ttu-id="88f47-638">При использовании параметра `ResourcesPath = "Resources"` сообщения об ошибках в `RegisterViewModel` могут сохраняться по одному из следующих путей:</span><span class="sxs-lookup"><span data-stu-id="88f47-638">Using the option `ResourcesPath = "Resources"`, the error messages in `RegisterViewModel` can be stored in either of the following paths:</span></span>

* <span data-ttu-id="88f47-639">*Resources/ViewModels.Account.RegisterViewModel.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-639">*Resources/ViewModels.Account.RegisterViewModel.fr.resx*</span></span>
* <span data-ttu-id="88f47-640">*Resources/ViewModels/Account/RegisterViewModel.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-640">*Resources/ViewModels/Account/RegisterViewModel.fr.resx*</span></span>

[!code-csharp[](localization/sample/3.x/Localization/ViewModels/Account/RegisterViewModel.cs?start=9&end=26)]

<span data-ttu-id="88f47-641">В ASP.NET Core MVC 1.1.0 и более поздних версиях атрибуты, не относящиеся в проверке, локализуются.</span><span class="sxs-lookup"><span data-stu-id="88f47-641">In ASP.NET Core MVC 1.1.0 and higher, non-validation attributes are localized.</span></span> <span data-ttu-id="88f47-642">В ASP.NET Core MVC 1.0 **не** производится поиск локализованных строк для атрибутов, не относящихся к проверке.</span><span class="sxs-lookup"><span data-stu-id="88f47-642">ASP.NET Core MVC 1.0 does **not** look up localized strings for non-validation attributes.</span></span>

<a name="one-resource-string-multiple-classes"></a>

### <a name="using-one-resource-string-for-multiple-classes"></a><span data-ttu-id="88f47-643">Использование одной строки ресурса для нескольких классов</span><span class="sxs-lookup"><span data-stu-id="88f47-643">Using one resource string for multiple classes</span></span>

<span data-ttu-id="88f47-644">В следующем коде показано, как использовать одну строку ресурса для атрибутов проверки с несколькими классами:</span><span class="sxs-lookup"><span data-stu-id="88f47-644">The following code shows how to use one resource string for validation attributes with multiple classes:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc()
        .AddDataAnnotationsLocalization(options => {
            options.DataAnnotationLocalizerProvider = (type, factory) =>
                factory.Create(typeof(SharedResource));
        });
}
```

<span data-ttu-id="88f47-645">В предыдущем коде `SharedResource` — это класс, соответствующий файлу RESX, в котором хранятся сообщения о проверке.</span><span class="sxs-lookup"><span data-stu-id="88f47-645">In the preceding code, `SharedResource` is the class corresponding to the resx where your validation messages are stored.</span></span> <span data-ttu-id="88f47-646">При таком подходе DataAnnotations будут использовать только `SharedResource`, а не ресурс для каждого класса.</span><span class="sxs-lookup"><span data-stu-id="88f47-646">With this approach, DataAnnotations will only use `SharedResource`, rather than the resource for each class.</span></span>

## <a name="provide-localized-resources-for-the-languages-and-cultures-you-support"></a><span data-ttu-id="88f47-647">Предоставление локализованных ресурсов для поддерживаемых языков и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="88f47-647">Provide localized resources for the languages and cultures you support</span></span>

### <a name="supportedcultures-and-supporteduicultures"></a><span data-ttu-id="88f47-648">SupportedCultures и SupportedUICultures</span><span class="sxs-lookup"><span data-stu-id="88f47-648">SupportedCultures and SupportedUICultures</span></span>

<span data-ttu-id="88f47-649">ASP.NET Core позволяет указывать два значения языка и региональных параметров: `SupportedCultures` и `SupportedUICultures`.</span><span class="sxs-lookup"><span data-stu-id="88f47-649">ASP.NET Core allows you to specify two culture values, `SupportedCultures` and `SupportedUICultures`.</span></span> <span data-ttu-id="88f47-650">Объект [CultureInfo](/dotnet/api/system.globalization.cultureinfo) для `SupportedCultures` определяет результаты функций, зависящих от языка и региональных параметров: форматирование дат, времени, чисел, денежных единиц и т. д.</span><span class="sxs-lookup"><span data-stu-id="88f47-650">The [CultureInfo](/dotnet/api/system.globalization.cultureinfo) object for `SupportedCultures` determines the results of culture-dependent functions, such as date, time, number, and currency formatting.</span></span> <span data-ttu-id="88f47-651">`SupportedCultures` также определяет порядок сортировки текста, соглашения о регистре символов и способы сравнения строк.</span><span class="sxs-lookup"><span data-stu-id="88f47-651">`SupportedCultures` also determines the sorting order of text, casing conventions, and string comparisons.</span></span> <span data-ttu-id="88f47-652">Дополнительные сведения о получении сервером значения языка и региональных параметров см. в описании свойства [CultureInfo.CurrentCulture](/dotnet/api/system.stringcomparer.currentculture#System_StringComparer_CurrentCulture).</span><span class="sxs-lookup"><span data-stu-id="88f47-652">See [CultureInfo.CurrentCulture](/dotnet/api/system.stringcomparer.currentculture#System_StringComparer_CurrentCulture) for more info on how the server gets the Culture.</span></span> <span data-ttu-id="88f47-653">Значение `SupportedUICultures` определяет то, какие строки переводов (в файле *RESX*) ищет объект [ResourceManager](/dotnet/api/system.resources.resourcemanager).</span><span class="sxs-lookup"><span data-stu-id="88f47-653">The `SupportedUICultures` determines which translated strings (from *.resx* files) are looked up by the [ResourceManager](/dotnet/api/system.resources.resourcemanager).</span></span> <span data-ttu-id="88f47-654">`ResourceManager` ищет связанные с языком и региональными параметрами строки, которые определяются значением `CurrentUICulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-654">The `ResourceManager` simply looks up culture-specific strings that's determined by `CurrentUICulture`.</span></span> <span data-ttu-id="88f47-655">Каждый поток в .NET имеет объекты `CurrentCulture` и `CurrentUICulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-655">Every thread in .NET has `CurrentCulture` and `CurrentUICulture` objects.</span></span> <span data-ttu-id="88f47-656">ASP.NET Core проверяет эти значения при обработке функций, зависящих от языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-656">ASP.NET Core inspects these values when rendering culture-dependent functions.</span></span> <span data-ttu-id="88f47-657">Например, если для текущего потока заданы язык и региональные параметры "en-US" (английский, США), метод `DateTime.Now.ToLongDateString()` выводит строку "Thursday, February 18, 2016", но если `CurrentCulture` имеет значение "ru-RU" (русский, Россия), выводится строка "четверг, 18 февраля 2016 г."</span><span class="sxs-lookup"><span data-stu-id="88f47-657">For example, if the current thread's culture is set to "en-US" (English, United States), `DateTime.Now.ToLongDateString()` displays "Thursday, February 18, 2016", but if `CurrentCulture` is set to "es-ES" (Spanish, Spain) the output will be "jueves, 18 de febrero de 2016".</span></span>

## <a name="resource-files"></a><span data-ttu-id="88f47-658">Файлы ресурсов</span><span class="sxs-lookup"><span data-stu-id="88f47-658">Resource files</span></span>

<span data-ttu-id="88f47-659">Файл ресурсов — это полезное средство для отделения локализуемых строк от кода.</span><span class="sxs-lookup"><span data-stu-id="88f47-659">A resource file is a useful mechanism for separating localizable strings from code.</span></span> <span data-ttu-id="88f47-660">Переведенные строки на языках, отличных от языка по умолчанию, содержатся в отдельных файлах ресурсов с расширением *RESX*.</span><span class="sxs-lookup"><span data-stu-id="88f47-660">Translated strings for the non-default language are isolated in *.resx* resource files.</span></span> <span data-ttu-id="88f47-661">Например, вам нужно создать файл ресурсов для испанского языка с именем *Welcome.es.resx*, который будет содержать переведенные строки.</span><span class="sxs-lookup"><span data-stu-id="88f47-661">For example, you might want to create Spanish resource file named *Welcome.es.resx* containing translated strings.</span></span> <span data-ttu-id="88f47-662">"es" — это код испанского языка.</span><span class="sxs-lookup"><span data-stu-id="88f47-662">"es" is the language code for Spanish.</span></span> <span data-ttu-id="88f47-663">Чтобы создать этот файл ресурсов в Visual Studio, выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="88f47-663">To create this resource file in Visual Studio:</span></span>

1. <span data-ttu-id="88f47-664">В **обозревателе решений** щелкните правой кнопкой мыши папку, которая будет содержать файл ресурсов, а затем выберите пункты **Добавить** > **Новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="88f47-664">In **Solution Explorer**, right click on the folder which will contain the resource file > **Add** > **New Item**.</span></span>

   ![Вложенное контекстное меню: в обозревателе решений контекстное меню открывается для папки ресурсов.](localization/_static/newi.png)

1. <span data-ttu-id="88f47-667">В поле **Поиск установленных шаблонов** введите слово "ресурс" и укажите имя файла.</span><span class="sxs-lookup"><span data-stu-id="88f47-667">In the **Search installed templates** box, enter "resource" and name the file.</span></span>

   ![Диалоговое окно ''Добавление нового элемента''](localization/_static/res.png)

1. <span data-ttu-id="88f47-669">Введите значение ключа (строку на исходном языке) в столбце **Имя** и переведенную строку в столбце **Значение**.</span><span class="sxs-lookup"><span data-stu-id="88f47-669">Enter the key value (native string) in the **Name** column and the translated string in the **Value** column.</span></span>

   ![Файл Welcome.es.resx (файлов ресурсов с приветствиями на испанском языке) со словом "Hello" в столбце "Имя" и словом "Hol"a ("Hello" на испанском) в столбце "Значение"](localization/_static/hola.png)

   <span data-ttu-id="88f47-671">В Visual Studio отобразится файл *Welcome.es.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-671">Visual Studio shows the *Welcome.es.resx* file.</span></span>

   ![Обозреватель решений с файлом ресурсов на испанском языке](localization/_static/se.png)

## <a name="resource-file-naming"></a><span data-ttu-id="88f47-673">Именование файлов ресурсов</span><span class="sxs-lookup"><span data-stu-id="88f47-673">Resource file naming</span></span>

<span data-ttu-id="88f47-674">Имена ресурсов представляют собой полные имена типов соответствующего класса за исключением имени сборки.</span><span class="sxs-lookup"><span data-stu-id="88f47-674">Resources are named for the full type name of their class minus the assembly name.</span></span> <span data-ttu-id="88f47-675">Например, ресурс на французском языке в проекте, главная сборка которого имеет имя `LocalizationWebsite.Web.dll`, для класса `LocalizationWebsite.Web.Startup` будет иметь имя *Startup.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-675">For example, a French resource in a project whose main assembly is `LocalizationWebsite.Web.dll` for the class `LocalizationWebsite.Web.Startup` would be named *Startup.fr.resx*.</span></span> <span data-ttu-id="88f47-676">Ресурс для класса `LocalizationWebsite.Web.Controllers.HomeController` будет иметь имя *Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-676">A resource for the class `LocalizationWebsite.Web.Controllers.HomeController` would be named *Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-677">Если пространство имен целевого класса не совпадает с именем сборки, необходимо использовать полное имя типа.</span><span class="sxs-lookup"><span data-stu-id="88f47-677">If your targeted class's namespace isn't the same as the assembly name you will need the full type name.</span></span> <span data-ttu-id="88f47-678">Например, в образце проекта ресурс для типа `ExtraNamespace.Tools` будет иметь имя *ExtraNamespace.Tools.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-678">For example, in the sample project a resource for the type `ExtraNamespace.Tools` would be named *ExtraNamespace.Tools.fr.resx*.</span></span>

<span data-ttu-id="88f47-679">В образце проекта метод `ConfigureServices` присваивает свойству `ResourcesPath` значение "Resources", поэтому относительный путь к файлу ресурсов на французском языке для контроллера домашней страницы в проекте будет иметь вид *Resources/Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-679">In the sample project, the `ConfigureServices` method sets the `ResourcesPath` to "Resources", so the project relative path for the home controller's French resource file is *Resources/Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-680">Кроме того, для упорядочения файлов ресурсов можно использовать папки.</span><span class="sxs-lookup"><span data-stu-id="88f47-680">Alternatively, you can use folders to organize resource files.</span></span> <span data-ttu-id="88f47-681">Для контроллера домашней страницы путь будет иметь вид *Resources/Controllers/HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-681">For the home controller, the path would be *Resources/Controllers/HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-682">Если параметр `ResourcesPath` не используется, файл *RESX* будет находиться в базовом каталоге проекта.</span><span class="sxs-lookup"><span data-stu-id="88f47-682">If you don't use the `ResourcesPath` option, the *.resx* file would go in the project base directory.</span></span> <span data-ttu-id="88f47-683">Файл ресурса для `HomeController` будет иметь имя *Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="88f47-683">The resource file for `HomeController` would be named *Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="88f47-684">Выбор соглашения об именовании на основе точечной нотации или пути зависит от того, как следует упорядочивать файлы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-684">The choice of using the dot or path naming convention depends on how you want to organize your resource files.</span></span>

| <span data-ttu-id="88f47-685">Имя ресурса</span><span class="sxs-lookup"><span data-stu-id="88f47-685">Resource name</span></span> | <span data-ttu-id="88f47-686">Точечная нотация или путь</span><span class="sxs-lookup"><span data-stu-id="88f47-686">Dot or path naming</span></span> |
| ------------   | ------------- |
| <span data-ttu-id="88f47-687">Resources/Controllers.HomeController.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-687">Resources/Controllers.HomeController.fr.resx</span></span> | <span data-ttu-id="88f47-688">Точки</span><span class="sxs-lookup"><span data-stu-id="88f47-688">Dot</span></span>  |
| <span data-ttu-id="88f47-689">Resources/Controllers/HomeController.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-689">Resources/Controllers/HomeController.fr.resx</span></span>  | <span data-ttu-id="88f47-690">Path</span><span class="sxs-lookup"><span data-stu-id="88f47-690">Path</span></span> |

<span data-ttu-id="88f47-691">Файлы ресурсов, для которых используется директива `@inject IViewLocalizer` в представлениях Razor, следуют той же модели.</span><span class="sxs-lookup"><span data-stu-id="88f47-691">Resource files using `@inject IViewLocalizer` in Razor views follow a similar pattern.</span></span> <span data-ttu-id="88f47-692">Файлу ресурсов для представления может присваиваться имя на основе либо точечной нотации, либо пути.</span><span class="sxs-lookup"><span data-stu-id="88f47-692">The resource file for a view can be named using either dot naming or path naming.</span></span> <span data-ttu-id="88f47-693">В файле ресурсов для представления Razor имитируется путь к связанному файлу представления.</span><span class="sxs-lookup"><span data-stu-id="88f47-693">Razor view resource files mimic the path of their associated view file.</span></span> <span data-ttu-id="88f47-694">Допустим, свойству `ResourcesPath` присвоено значение "Resources". В этом случае файл ресурсов на французском языке, связанный с представлением *Views/Home/About.cshtml*, может иметь одно из следующих имен:</span><span class="sxs-lookup"><span data-stu-id="88f47-694">Assuming we set the `ResourcesPath` to "Resources", the French resource file associated with the *Views/Home/About.cshtml* view could be either of the following:</span></span>

* <span data-ttu-id="88f47-695">Resources/Views/Home/About.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-695">Resources/Views/Home/About.fr.resx</span></span>

* <span data-ttu-id="88f47-696">Resources/Views.Home.About.fr.resx</span><span class="sxs-lookup"><span data-stu-id="88f47-696">Resources/Views.Home.About.fr.resx</span></span>

<span data-ttu-id="88f47-697">Если параметр `ResourcesPath` не используется, файл *RESX* для представления будет находиться в той же папке, что и представление.</span><span class="sxs-lookup"><span data-stu-id="88f47-697">If you don't use the `ResourcesPath` option, the *.resx* file for a view would be located in the same folder as the view.</span></span>

### <a name="rootnamespaceattribute"></a><span data-ttu-id="88f47-698">RootNamespaceAttribute</span><span class="sxs-lookup"><span data-stu-id="88f47-698">RootNamespaceAttribute</span></span> 

<span data-ttu-id="88f47-699">Атрибут [RootNamespace](/dotnet/api/microsoft.extensions.localization.rootnamespaceattribute?view=aspnetcore-2.1) содержит корневое пространство имен сборки, если корневое пространство имен сборки отличается от имени сборки.</span><span class="sxs-lookup"><span data-stu-id="88f47-699">The [RootNamespace](/dotnet/api/microsoft.extensions.localization.rootnamespaceattribute?view=aspnetcore-2.1) attribute provides the root namespace of an assembly when the root namespace of an assembly is different than the assembly name.</span></span> 

> [!WARNING]
> <span data-ttu-id="88f47-700">Это может произойти, если имя проекта — недопустимый идентификатор .NET.</span><span class="sxs-lookup"><span data-stu-id="88f47-700">This can occur when a project's name is not a valid .NET identifier.</span></span> <span data-ttu-id="88f47-701">Например, `my-project-name.csproj` будет использовать корневое пространство имен `my_project_name` и имя сборки `my-project-name`, что повлечет эту ошибку.</span><span class="sxs-lookup"><span data-stu-id="88f47-701">For instance `my-project-name.csproj` will use the root namespace `my_project_name` and the assembly name `my-project-name` leading to this error.</span></span> 

<span data-ttu-id="88f47-702">Если корневое пространство имен сборки отличается от имени сборки</span><span class="sxs-lookup"><span data-stu-id="88f47-702">If the root namespace of an assembly is different than the assembly name:</span></span>

* <span data-ttu-id="88f47-703">Локализация не работает по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-703">Localization does not work by default.</span></span>
* <span data-ttu-id="88f47-704">Локализация завершается сбоем из-за метода поиска ресурсов в сборке.</span><span class="sxs-lookup"><span data-stu-id="88f47-704">Localization fails due to the way resources are searched for within the assembly.</span></span> <span data-ttu-id="88f47-705">`RootNamespace` — это значение во время сборки, которое недоступно выполняющемуся процессу.</span><span class="sxs-lookup"><span data-stu-id="88f47-705">`RootNamespace` is a build-time value which is not available to the executing process.</span></span> 

<span data-ttu-id="88f47-706">Если `RootNamespace` отличается от `AssemblyName`, включите следующее в файл *AssemblyInfo.cs* (со значениями параметров, замененными фактическими значениями).</span><span class="sxs-lookup"><span data-stu-id="88f47-706">If the `RootNamespace` is different from the `AssemblyName`, include the following in *AssemblyInfo.cs* (with parameter values replaced with the actual values):</span></span>

```csharp
using System.Reflection;
using Microsoft.Extensions.Localization;

[assembly: ResourceLocation("Resource Folder Name")]
[assembly: RootNamespace("App Root Namespace")]
```

<span data-ttu-id="88f47-707">Приведенный выше код обеспечивает успешное разрешение RESX-файлов.</span><span class="sxs-lookup"><span data-stu-id="88f47-707">The preceding code enables the successful resolution of resx files.</span></span>

## <a name="culture-fallback-behavior"></a><span data-ttu-id="88f47-708">Резервный язык и региональные параметры</span><span class="sxs-lookup"><span data-stu-id="88f47-708">Culture fallback behavior</span></span>

<span data-ttu-id="88f47-709">При поиске ресурса локализации использует резервный язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-709">When searching for a resource, localization engages in "culture fallback".</span></span> <span data-ttu-id="88f47-710">Если запрошенный язык и региональные параметры не найдены, используется родительский язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-710">Starting from the requested culture, if not found, it reverts to the parent culture of that culture.</span></span> <span data-ttu-id="88f47-711">Кстати, родительский язык и региональные параметры представляют свойство [CultureInfo.Parent](/dotnet/api/system.globalization.cultureinfo.parent).</span><span class="sxs-lookup"><span data-stu-id="88f47-711">As an aside, the [CultureInfo.Parent](/dotnet/api/system.globalization.cultureinfo.parent) property represents the parent culture.</span></span> <span data-ttu-id="88f47-712">Обычно (но не всегда) это означает удаление национального символа из ISO.</span><span class="sxs-lookup"><span data-stu-id="88f47-712">This usually (but not always) means removing the national signifier from the ISO.</span></span> <span data-ttu-id="88f47-713">Например, диалект испанского в Мексике — es-MX.</span><span class="sxs-lookup"><span data-stu-id="88f47-713">For example, the dialect of Spanish spoken in Mexico is "es-MX".</span></span> <span data-ttu-id="88f47-714">Родительский элемент "es" (испанский) не относится к той или иной стране.</span><span class="sxs-lookup"><span data-stu-id="88f47-714">It has the parent "es"&mdash;Spanish non-specific to any country.</span></span>

<span data-ttu-id="88f47-715">Допустим, сайт получает запрос на ресурс "Приветствие" с использованием языка и региональных параметров fr-CA.</span><span class="sxs-lookup"><span data-stu-id="88f47-715">Imagine your site receives a request for a "Welcome" resource using culture "fr-CA".</span></span> <span data-ttu-id="88f47-716">Система локализации ищет в следующих ресурсах по порядку и выбирает первое совпадение:</span><span class="sxs-lookup"><span data-stu-id="88f47-716">The localization system looks for the following resources, in order, and selects the first match:</span></span>

* <span data-ttu-id="88f47-717">*Welcome.fr-CA.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-717">*Welcome.fr-CA.resx*</span></span>
* <span data-ttu-id="88f47-718">*Welcome.fr.resx*</span><span class="sxs-lookup"><span data-stu-id="88f47-718">*Welcome.fr.resx*</span></span>
* <span data-ttu-id="88f47-719">*Welcome.resx* (если `NeutralResourcesLanguage` — fr-CA)</span><span class="sxs-lookup"><span data-stu-id="88f47-719">*Welcome.resx* (if the `NeutralResourcesLanguage` is "fr-CA")</span></span>

<span data-ttu-id="88f47-720">Если вы удалите указатель языка и региональных параметров ".fr" и при этом задан французский язык и региональные параметры, будет считан файл ресурсов по умолчанию и строки локализуются.</span><span class="sxs-lookup"><span data-stu-id="88f47-720">As an example, if you remove the ".fr" culture designator and you have the culture set to French, the default resource file is read and strings are localized.</span></span> <span data-ttu-id="88f47-721">Диспетчер ресурсов назначает ресурс по умолчанию или резервный ресурс на тот случай, когда соответствия запрошенному языку и региональным параметрам не найдено.</span><span class="sxs-lookup"><span data-stu-id="88f47-721">The Resource manager designates a default or fallback resource for when nothing meets your requested culture.</span></span> <span data-ttu-id="88f47-722">Если нужно, чтобы при отсутствии ресурса для запрошенного языка и региональных параметров просто возвращался ключ, не используйте файл ресурсов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="88f47-722">If you want to just return the key when missing a resource for the requested culture you must not have a default resource file.</span></span>

### <a name="generate-resource-files-with-visual-studio"></a><span data-ttu-id="88f47-723">Создание файлов ресурсов с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88f47-723">Generate resource files with Visual Studio</span></span>

<span data-ttu-id="88f47-724">Если вы создаете в Visual Studio файл ресурсов, в имени которого не указаны язык и региональные параметры (например, *Welcome.resx*), Visual Studio создаст класс C# со свойством для каждой строки.</span><span class="sxs-lookup"><span data-stu-id="88f47-724">If you create a resource file in Visual Studio without a culture in the file name (for example, *Welcome.resx*), Visual Studio will create a C# class with a property for each string.</span></span> <span data-ttu-id="88f47-725">В ASP.NET Core обычно требуется иное поведение.</span><span class="sxs-lookup"><span data-stu-id="88f47-725">That's usually not what you want with ASP.NET Core.</span></span> <span data-ttu-id="88f47-726">Как правило, файл ресурсов *RESX* по умолчанию (файл *RESX* без указания языка и региональных параметров) не используется.</span><span class="sxs-lookup"><span data-stu-id="88f47-726">You typically don't have a default *.resx* resource file (a *.resx* file without the culture name).</span></span> <span data-ttu-id="88f47-727">Мы рекомендуем создать файл *RESX* с указанием языка и региональных параметров (например, *Welcome.fr.resx*).</span><span class="sxs-lookup"><span data-stu-id="88f47-727">We suggest you create the *.resx* file with a culture name (for example *Welcome.fr.resx*).</span></span> <span data-ttu-id="88f47-728">При создании файла *RESX* с указанием языка и региональных параметров среда Visual Studio не создает файл класса.</span><span class="sxs-lookup"><span data-stu-id="88f47-728">When you create a *.resx* file with a culture name, Visual Studio won't generate the class file.</span></span>

### <a name="add-other-cultures"></a><span data-ttu-id="88f47-729">Добавление других языков и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="88f47-729">Add other cultures</span></span>

<span data-ttu-id="88f47-730">Каждое сочетание языка и региональных параметров (кроме языка по умолчанию) требует уникального файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="88f47-730">Each language and culture combination (other than the default language) requires a unique resource file.</span></span> <span data-ttu-id="88f47-731">Создавая файлы ресурсов для разных языков, языковых стандартов и региональных параметров, вы включаете в их имена коды языков ISO (например, **en-us**, **ru-ru** и **fr-ca**).</span><span class="sxs-lookup"><span data-stu-id="88f47-731">You create resource files for different cultures and locales by creating new resource files in which the ISO language codes are part of the file name (for example, **en-us**, **fr-ca**, and **en-gb**).</span></span> <span data-ttu-id="88f47-732">Эти коды ISO помещаются между именем файла и расширением *RESX*, например *Welcome.es-MX.resx* (испанский, Мексика).</span><span class="sxs-lookup"><span data-stu-id="88f47-732">These ISO codes are placed between the file name and the *.resx* file extension, as in *Welcome.es-MX.resx* (Spanish/Mexico).</span></span>

## <a name="implement-a-strategy-to-select-the-languageculture-for-each-request"></a><span data-ttu-id="88f47-733">реализацию стратегии по выбору языка и региональных параметров для каждого запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-733">Implement a strategy to select the language/culture for each request</span></span>

### <a name="configure-localization"></a><span data-ttu-id="88f47-734">Настройка локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-734">Configure localization</span></span>

<span data-ttu-id="88f47-735">Локализация настраивается в методе `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="88f47-735">Localization is configured in the `Startup.ConfigureServices` method:</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Startup.cs?name=snippet1)]

* <span data-ttu-id="88f47-736">Метод `AddLocalization` добавляет службы локализации в контейнер служб.</span><span class="sxs-lookup"><span data-stu-id="88f47-736">`AddLocalization` adds the localization services to the services container.</span></span> <span data-ttu-id="88f47-737">В приведенном выше коде также задается путь к ресурсам "Resources".</span><span class="sxs-lookup"><span data-stu-id="88f47-737">The code above also sets the resources path to "Resources".</span></span>

* <span data-ttu-id="88f47-738">Метод `AddViewLocalization` добавляет поддержку файлов локализованных представлений.</span><span class="sxs-lookup"><span data-stu-id="88f47-738">`AddViewLocalization` adds support for localized view files.</span></span> <span data-ttu-id="88f47-739">В этом примере локализация образца представления основана на суффиксе файла представления,</span><span class="sxs-lookup"><span data-stu-id="88f47-739">In this sample view localization is based on the view file suffix.</span></span> <span data-ttu-id="88f47-740">например "fr" в файле *Index.fr.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="88f47-740">For example "fr" in the *Index.fr.cshtml* file.</span></span>

* <span data-ttu-id="88f47-741">Метод `AddDataAnnotationsLocalization` добавляет поддержку локализованных сообщений проверки `DataAnnotations` посредством абстракций `IStringLocalizer`.</span><span class="sxs-lookup"><span data-stu-id="88f47-741">`AddDataAnnotationsLocalization` adds support for localized `DataAnnotations` validation messages through `IStringLocalizer` abstractions.</span></span>

### <a name="localization-middleware"></a><span data-ttu-id="88f47-742">Промежуточный слой локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-742">Localization middleware</span></span>

<span data-ttu-id="88f47-743">Текущий язык и региональные параметры в запросе задаются в [промежуточном слое](xref:fundamentals/middleware/index) локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-743">The current culture on a request is set in the localization [Middleware](xref:fundamentals/middleware/index).</span></span> <span data-ttu-id="88f47-744">Промежуточный слой локализации включается в методе `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="88f47-744">The localization middleware is enabled in the `Startup.Configure` method.</span></span> <span data-ttu-id="88f47-745">Промежуточный слой локализации должен настраиваться перед другими промежуточными слоями, которые могут проверять язык и региональные параметры запроса (например, `app.UseMvcWithDefaultRoute()`).</span><span class="sxs-lookup"><span data-stu-id="88f47-745">The localization middleware must be configured before any middleware which might check the request culture (for example, `app.UseMvcWithDefaultRoute()`).</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Startup.cs?name=snippet2)]

[!INCLUDE[about the series](~/includes/code-comments-loc.md)]

<span data-ttu-id="88f47-746">`UseRequestLocalization` инициализирует объект `RequestLocalizationOptions`.</span><span class="sxs-lookup"><span data-stu-id="88f47-746">`UseRequestLocalization` initializes a `RequestLocalizationOptions` object.</span></span> <span data-ttu-id="88f47-747">При каждом запросе проверяется список поставщиков `RequestCultureProvider` в объекте `RequestLocalizationOptions` и используется первый поставщик, который может успешно определить язык и региональные параметры запроса.</span><span class="sxs-lookup"><span data-stu-id="88f47-747">On every request the list of `RequestCultureProvider` in the `RequestLocalizationOptions` is enumerated and the first provider that can successfully determine the request culture is used.</span></span> <span data-ttu-id="88f47-748">Поставщики по умолчанию берутся из класса `RequestLocalizationOptions`:</span><span class="sxs-lookup"><span data-stu-id="88f47-748">The default providers come from the `RequestLocalizationOptions` class:</span></span>

1. `QueryStringRequestCultureProvider`
1. `CookieRequestCultureProvider`
1. `AcceptLanguageHeaderRequestCultureProvider`

<span data-ttu-id="88f47-749">В списке по умолчанию поставщики следуют от наиболее конкретных до наиболее общих.</span><span class="sxs-lookup"><span data-stu-id="88f47-749">The default list goes from most specific to least specific.</span></span> <span data-ttu-id="88f47-750">Далее в этой статье вы узнаете, как можно изменить этот порядок и даже добавить пользовательский поставщик языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-750">Later in the article we'll see how you can change the order and even add a custom culture provider.</span></span> <span data-ttu-id="88f47-751">Если ни один из поставщиков не может определить язык и региональные параметры запроса, используется `DefaultRequestCulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-751">If none of the providers can determine the request culture, the `DefaultRequestCulture` is used.</span></span>

### <a name="querystringrequestcultureprovider"></a><span data-ttu-id="88f47-752">QueryStringRequestCultureProvider</span><span class="sxs-lookup"><span data-stu-id="88f47-752">QueryStringRequestCultureProvider</span></span>

<span data-ttu-id="88f47-753">Некоторые приложения используют строку запроса для указания <xref:System.Globalization.CultureInfo>.</span><span class="sxs-lookup"><span data-stu-id="88f47-753">Some apps will use a query string to set the <xref:System.Globalization.CultureInfo>.</span></span> <span data-ttu-id="88f47-754">Если в приложении для этого применяется файл cookie или заголовок Accept-Language, добавление строки запроса к URL-адресу может быть полезным в целях отладки и тестирования кода.</span><span class="sxs-lookup"><span data-stu-id="88f47-754">For apps that use the cookie or Accept-Language header approach, adding a query string to the URL is useful for debugging and testing code.</span></span> <span data-ttu-id="88f47-755">По умолчанию поставщик `QueryStringRequestCultureProvider` регистрируется в качестве первого поставщика локализации в списке `RequestCultureProvider`.</span><span class="sxs-lookup"><span data-stu-id="88f47-755">By default, the `QueryStringRequestCultureProvider` is registered as the first localization provider in the `RequestCultureProvider` list.</span></span> <span data-ttu-id="88f47-756">Вы передаете параметры строки запроса `culture` и `ui-culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-756">You pass the query string parameters `culture` and `ui-culture`.</span></span> <span data-ttu-id="88f47-757">В следующем примере в качестве языка и региональных параметров (язык и регион) задаются испанский язык и Мексика:</span><span class="sxs-lookup"><span data-stu-id="88f47-757">The following example sets the specific culture (language and region) to Spanish/Mexico:</span></span>

```
http://localhost:5000/?culture=es-MX&ui-culture=es-MX
```

<span data-ttu-id="88f47-758">Если передан только один из двух параметров (`culture` или `ui-culture`), поставщик строки запроса задаст с его помощью оба значения.</span><span class="sxs-lookup"><span data-stu-id="88f47-758">If you only pass in one of the two (`culture` or `ui-culture`), the query string provider will set both values using the one you passed in.</span></span> <span data-ttu-id="88f47-759">Например, если передан только язык и региональные параметры, будут заданы оба значения `Culture` и `UICulture`:</span><span class="sxs-lookup"><span data-stu-id="88f47-759">For example, setting just the culture will set both the `Culture` and the `UICulture`:</span></span>

```
http://localhost:5000/?culture=es-MX
```

### <a name="no-loccookierequestcultureprovider"></a><span data-ttu-id="88f47-760">CookieRequestCultureProvider</span><span class="sxs-lookup"><span data-stu-id="88f47-760">CookieRequestCultureProvider</span></span>

<span data-ttu-id="88f47-761">Рабочие приложения часто предоставляют механизм для указания языка и региональных параметров с помощью соответствующего файла cookie ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88f47-761">Production apps will often provide a mechanism to set the culture with the ASP.NET Core culture cookie.</span></span> <span data-ttu-id="88f47-762">Чтобы создать файл `MakeCookieValue`, используйте метод cookie.</span><span class="sxs-lookup"><span data-stu-id="88f47-762">Use the `MakeCookieValue` method to create a cookie.</span></span>

<span data-ttu-id="88f47-763">`CookieRequestCultureProvider` `DefaultCookieName` возвращает имя файла cookie по умолчанию, с помощью которого отслеживается предпочтительный язык и региональные параметры пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-763">The `CookieRequestCultureProvider` `DefaultCookieName` returns the default cookie name used to track the user's preferred culture information.</span></span> <span data-ttu-id="88f47-764">Имя cookie по умолчанию — `.AspNetCore.Culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-764">The default cookie name is `.AspNetCore.Culture`.</span></span>

<span data-ttu-id="88f47-765">Файл cookie имеет формат `c=%LANGCODE%|uic=%LANGCODE%`, где `c` — это `Culture`, а `uic` — это `UICulture`, например:</span><span class="sxs-lookup"><span data-stu-id="88f47-765">The cookie format is `c=%LANGCODE%|uic=%LANGCODE%`, where `c` is `Culture` and `uic` is `UICulture`, for example:</span></span>

```
c=en-UK|uic=en-US
```

<span data-ttu-id="88f47-766">Если указаны либо только язык и региональные параметры, либо только язык и региональные параметры пользовательского интерфейса, это значение будет использоваться для обоих параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-766">If you only specify one of culture info and UI culture, the specified culture will be used for both culture info and UI culture.</span></span>

### <a name="the-accept-language-http-header"></a><span data-ttu-id="88f47-767">Заголовок HTTP Accept-Language</span><span class="sxs-lookup"><span data-stu-id="88f47-767">The Accept-Language HTTP header</span></span>

<span data-ttu-id="88f47-768">[Заголовок Accept-Language](https://www.w3.org/International/questions/qa-accept-lang-locales) может задаваться в большинстве браузеров и изначально предназначался для указания языка пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-768">The [Accept-Language header](https://www.w3.org/International/questions/qa-accept-lang-locales) is settable in most browsers and was originally intended to specify the user's language.</span></span> <span data-ttu-id="88f47-769">Он показывает, какой язык был выбран в браузере или унаследован от базовой операционной системы.</span><span class="sxs-lookup"><span data-stu-id="88f47-769">This setting indicates what the browser has been set to send or has inherited from the underlying operating system.</span></span> <span data-ttu-id="88f47-770">Заголовок HTTP Accept-Language в запросе из браузера — это не самый надежный способ определения предпочтительного языка пользователя (см. статью [Настройка языковых предпочтений в браузере](https://www.w3.org/International/questions/qa-lang-priorities.en.php)).</span><span class="sxs-lookup"><span data-stu-id="88f47-770">The Accept-Language HTTP header from a browser request isn't an infallible way to detect the user's preferred language (see [Setting language preferences in a browser](https://www.w3.org/International/questions/qa-lang-priorities.en.php)).</span></span> <span data-ttu-id="88f47-771">В рабочем приложении должна быть возможность выбора языка и региональных параметров пользователем.</span><span class="sxs-lookup"><span data-stu-id="88f47-771">A production app should include a way for a user to customize their choice of culture.</span></span>

### <a name="set-the-accept-language-http-header-in-ie"></a><span data-ttu-id="88f47-772">Задание заголовка HTTP Accept-Language в Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="88f47-772">Set the Accept-Language HTTP header in IE</span></span>

1. <span data-ttu-id="88f47-773">Щелкните значок шестеренки и выберите пункт **Свойства браузера**.</span><span class="sxs-lookup"><span data-stu-id="88f47-773">From the gear icon, tap **Internet Options**.</span></span>

1. <span data-ttu-id="88f47-774">Нажмите кнопку **Языки**.</span><span class="sxs-lookup"><span data-stu-id="88f47-774">Tap **Languages**.</span></span>

   ![Свойства браузера](localization/_static/lang.png)

1. <span data-ttu-id="88f47-776">Нажмите **Задать предпочитаемые языки**.</span><span class="sxs-lookup"><span data-stu-id="88f47-776">Tap **Set Language Preferences**.</span></span>

1. <span data-ttu-id="88f47-777">Нажмите **Добавить язык**.</span><span class="sxs-lookup"><span data-stu-id="88f47-777">Tap **Add a language**.</span></span>

1. <span data-ttu-id="88f47-778">Добавьте язык.</span><span class="sxs-lookup"><span data-stu-id="88f47-778">Add the language.</span></span>

1. <span data-ttu-id="88f47-779">Выберите язык, а затем нажмите кнопку **Вверх**.</span><span class="sxs-lookup"><span data-stu-id="88f47-779">Tap the language, then tap **Move Up**.</span></span>

### <a name="the-content-language-http-header"></a><span data-ttu-id="88f47-780">Заголовок HTTP Content-Language</span><span class="sxs-lookup"><span data-stu-id="88f47-780">The Content-Language HTTP header</span></span>

<span data-ttu-id="88f47-781">Заголовок сущности [Content-Language](https://developer.mozilla.org/docs/Web/HTTP/Headers/Content-Language):</span><span class="sxs-lookup"><span data-stu-id="88f47-781">The [Content-Language](https://developer.mozilla.org/docs/Web/HTTP/Headers/Content-Language) entity header:</span></span>

* <span data-ttu-id="88f47-782">Используется для описания языков, предназначенных для аудитории.</span><span class="sxs-lookup"><span data-stu-id="88f47-782">Is used to describe the language(s) intended for the audience.</span></span>
* <span data-ttu-id="88f47-783">Позволяет пользователю различать в соответствии с предпочтительным языком пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-783">Allows a user to differentiate according to the users' own preferred language.</span></span>

<span data-ttu-id="88f47-784">Заголовки сущностей используются как в HTTP-запросах, так и в ответах.</span><span class="sxs-lookup"><span data-stu-id="88f47-784">Entity headers are used in both HTTP requests and responses.</span></span>

<span data-ttu-id="88f47-785">Заголовок `Content-Language` можно добавить, задав свойство `ApplyCurrentCultureToResponseHeaders`.</span><span class="sxs-lookup"><span data-stu-id="88f47-785">The `Content-Language` header can be added by setting the property `ApplyCurrentCultureToResponseHeaders`.</span></span>

<span data-ttu-id="88f47-786">Добавление заголовка `Content-Language`:</span><span class="sxs-lookup"><span data-stu-id="88f47-786">Adding the `Content-Language` header:</span></span>

* <span data-ttu-id="88f47-787">Позволяет RequestLocalizationMiddleware задать заголовок `Content-Language` с `CurrentUICulture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-787">Allows the RequestLocalizationMiddleware to set the `Content-Language` header with the `CurrentUICulture`.</span></span>
* <span data-ttu-id="88f47-788">Устраняет необходимость явной установки заголовка ответа `Content-Language`.</span><span class="sxs-lookup"><span data-stu-id="88f47-788">Eliminates the need to set the response header `Content-Language` explicitly.</span></span>

```csharp
app.UseRequestLocalization(new RequestLocalizationOptions
{
    ApplyCurrentCultureToResponseHeaders = true
});
```

### <a name="use-a-custom-provider"></a><span data-ttu-id="88f47-789">Использование пользовательского поставщика</span><span class="sxs-lookup"><span data-stu-id="88f47-789">Use a custom provider</span></span>

<span data-ttu-id="88f47-790">Предположим, необходимо, чтобы ваши клиенты могли сохранять информацию о своем языке и региональных параметрах в ваших базах данных.</span><span class="sxs-lookup"><span data-stu-id="88f47-790">Suppose you want to let your customers store their language and culture in your databases.</span></span> <span data-ttu-id="88f47-791">Можно написать поставщик, который будет искать эти значения для пользователя.</span><span class="sxs-lookup"><span data-stu-id="88f47-791">You could write a provider to look up these values for the user.</span></span> <span data-ttu-id="88f47-792">В следующем примере кода показано, как добавить пользовательский поставщик:</span><span class="sxs-lookup"><span data-stu-id="88f47-792">The following code shows how to add a custom provider:</span></span>

```csharp
private const string enUSCulture = "en-US";

services.Configure<RequestLocalizationOptions>(options =>
{
    var supportedCultures = new[]
    {
        new CultureInfo(enUSCulture),
        new CultureInfo("fr")
    };

    options.DefaultRequestCulture = new RequestCulture(culture: enUSCulture, uiCulture: enUSCulture);
    options.SupportedCultures = supportedCultures;
    options.SupportedUICultures = supportedCultures;

    options.AddInitialRequestCultureProvider(new CustomRequestCultureProvider(async context =>
    {
        // My custom request culture logic
        return new ProviderCultureResult("en");
    }));
});
```

<span data-ttu-id="88f47-793">Для добавления или удаления поставщиков локализации используйте объект `RequestLocalizationOptions`.</span><span class="sxs-lookup"><span data-stu-id="88f47-793">Use `RequestLocalizationOptions` to add or remove localization providers.</span></span>

### <a name="set-the-culture-programmatically"></a><span data-ttu-id="88f47-794">Задание языка и региональных параметров программным образом</span><span class="sxs-lookup"><span data-stu-id="88f47-794">Set the culture programmatically</span></span>

<span data-ttu-id="88f47-795">В образце проекта **Localization.StarterWeb** в [GitHub](https://github.com/aspnet/entropy) есть пользовательский интерфейс для задания значения `Culture`.</span><span class="sxs-lookup"><span data-stu-id="88f47-795">This sample **Localization.StarterWeb** project on [GitHub](https://github.com/aspnet/entropy) contains UI to set the `Culture`.</span></span> <span data-ttu-id="88f47-796">Файл *Views/Shared/_SelectLanguagePartial.cshtml* позволяет выбрать язык и региональные параметры из списка поддерживаемых:</span><span class="sxs-lookup"><span data-stu-id="88f47-796">The *Views/Shared/_SelectLanguagePartial.cshtml* file allows you to select the culture from the list of supported cultures:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Shared/_SelectLanguagePartial.cshtml)]

<span data-ttu-id="88f47-797">Файл *Views/Shared/_SelectLanguagePartial.cshtml* добавляется в раздел `footer` файла макета, поэтому он доступен всем представлениям:</span><span class="sxs-lookup"><span data-stu-id="88f47-797">The *Views/Shared/_SelectLanguagePartial.cshtml* file is added to the `footer` section of the layout file so it will be available to all views:</span></span>

[!code-cshtml[](localization/sample/3.x/Localization/Views/Shared/_Layout.cshtml?range=43-56&highlight=10)]

<span data-ttu-id="88f47-798">Метод `SetLanguage` задает файл cookie языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-798">The `SetLanguage` method sets the culture cookie.</span></span>

[!code-csharp[](localization/sample/3.x/Localization/Controllers/HomeController.cs?range=57-67)]

<span data-ttu-id="88f47-799">Подключить файл *_SelectLanguagePartial.cshtml* к образцу кода этого проекта нельзя.</span><span class="sxs-lookup"><span data-stu-id="88f47-799">You can't plug in the *_SelectLanguagePartial.cshtml* to sample code for this project.</span></span> <span data-ttu-id="88f47-800">В проекте **Localization.StarterWeb** в [GitHub](https://github.com/aspnet/entropy) есть код для передачи объекта `RequestLocalizationOptions` в частичное представление Razor посредством контейнера [внедрения зависимостей](dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="88f47-800">The **Localization.StarterWeb** project on [GitHub](https://github.com/aspnet/entropy) has code to flow the `RequestLocalizationOptions` to a Razor partial through the [Dependency Injection](dependency-injection.md) container.</span></span>

## <a name="model-binding-route-data-and-query-strings"></a><span data-ttu-id="88f47-801">Данные маршрутов привязки модели и строки запросов</span><span class="sxs-lookup"><span data-stu-id="88f47-801">Model binding route data and query strings</span></span>

<span data-ttu-id="88f47-802">См. раздел [Поведение глобализации для данных маршрутов привязки модели и строк запросов](xref:mvc/models/model-binding#glob).</span><span class="sxs-lookup"><span data-stu-id="88f47-802">See [Globalization behavior of model binding route data and query strings](xref:mvc/models/model-binding#glob).</span></span>

## <a name="globalization-and-localization-terms"></a><span data-ttu-id="88f47-803">Термины, относящиеся к глобализации и локализации</span><span class="sxs-lookup"><span data-stu-id="88f47-803">Globalization and localization terms</span></span>

<span data-ttu-id="88f47-804">Процесс локализации приложения требует базового понимания распространенных кодировок, часто используемых при разработке современного программного обеспечения, и связанных с ними проблем.</span><span class="sxs-lookup"><span data-stu-id="88f47-804">The process of localizing your app also requires a basic understanding of relevant character sets commonly used in modern software development and an understanding of the issues associated with them.</span></span> <span data-ttu-id="88f47-805">Хотя на всех компьютерах текст сохраняется в виде цифр (кодов), в разных системах эти коды для одного и того же текста различаются.</span><span class="sxs-lookup"><span data-stu-id="88f47-805">Although all computers store text as numbers (codes), different systems store the same text using different numbers.</span></span> <span data-ttu-id="88f47-806">Под процессом локализации понимается перевод пользовательского интерфейса приложения для определенного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="88f47-806">The localization process refers to translating the app user interface (UI) for a specific culture/locale.</span></span>

<span data-ttu-id="88f47-807">[Возможность локализации](/dotnet/standard/globalization-localization/localizability-review) — это определяемое на промежуточной стадии состояние готовности глобализованного приложения к локализации.</span><span class="sxs-lookup"><span data-stu-id="88f47-807">[Localizability](/dotnet/standard/globalization-localization/localizability-review) is an intermediate process for verifying that a globalized app is ready for localization.</span></span>

<span data-ttu-id="88f47-808">Формат [RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) для названия языка и региональных параметров имеет вид `<languagecode2>-<country/regioncode2>`, где `<languagecode2>` — это код языка, а `<country/regioncode2>` — код субкультуры.</span><span class="sxs-lookup"><span data-stu-id="88f47-808">The [RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) format for the culture name is `<languagecode2>-<country/regioncode2>`, where `<languagecode2>` is the language code and `<country/regioncode2>` is the subculture code.</span></span> <span data-ttu-id="88f47-809">Примеры: `es-CL` для испанского языка (Чили), `en-US` для английского языка (США), `en-AU` для английского языка (Австралия).</span><span class="sxs-lookup"><span data-stu-id="88f47-809">For example, `es-CL` for Spanish (Chile), `en-US` for English (United States), and `en-AU` for English (Australia).</span></span> <span data-ttu-id="88f47-810">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) — это комбинация двухбуквенного кода культуры ISO 639 в нижнем регистре (он связан с языком) и двухбуквенного кода субкультуры ISO 3166 в верхнем регистре (он связан со страной или регионом).</span><span class="sxs-lookup"><span data-stu-id="88f47-810">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) is a combination of an ISO 639 two-letter lowercase culture code associated with a language and an ISO 3166 two-letter uppercase subculture code associated with a country or region.</span></span> <span data-ttu-id="88f47-811">См. раздел <https://docs.microsoft.com/previous-versions/commerce-server/ee825488(v=cs.20)>.</span><span class="sxs-lookup"><span data-stu-id="88f47-811">See <https://docs.microsoft.com/previous-versions/commerce-server/ee825488(v=cs.20)>.</span></span>

<span data-ttu-id="88f47-812">Вместо слова "интернационализация" (internationalization) часто используют аббревиатуру "I18N".</span><span class="sxs-lookup"><span data-stu-id="88f47-812">Internationalization is often abbreviated to "I18N".</span></span> <span data-ttu-id="88f47-813">В аббревиатуру включаются первая и последняя буквы слова, а также число букв между ними, то есть 18 — это число букв между первой ("I") и последней ("N") буквами.</span><span class="sxs-lookup"><span data-stu-id="88f47-813">The abbreviation takes the first and last letters and the number of letters between them, so 18 stands for the number of letters between the first "I" and the last "N".</span></span> <span data-ttu-id="88f47-814">То же самое касается глобализации (Globalization — G11N) и локализации (Localization — L10N).</span><span class="sxs-lookup"><span data-stu-id="88f47-814">The same applies to Globalization (G11N), and Localization (L10N).</span></span>

<span data-ttu-id="88f47-815">Термины:</span><span class="sxs-lookup"><span data-stu-id="88f47-815">Terms:</span></span>

* <span data-ttu-id="88f47-816">Глобализация (G11N): процесс подготовки приложения к поддержке различных языков и регионов.</span><span class="sxs-lookup"><span data-stu-id="88f47-816">Globalization (G11N): The process of making an app support different languages and regions.</span></span>
* <span data-ttu-id="88f47-817">Локализация (L10N): процесс настройки приложения для работы с конкретным языком и регионом.</span><span class="sxs-lookup"><span data-stu-id="88f47-817">Localization (L10N): The process of customizing an app for a given language and region.</span></span>
* <span data-ttu-id="88f47-818">Интернационализация (I18N): описывает глобализацию и локализацию.</span><span class="sxs-lookup"><span data-stu-id="88f47-818">Internationalization (I18N): Describes both globalization and localization.</span></span>
* <span data-ttu-id="88f47-819">Язык и региональные параметры: обозначает язык и (необязательно) регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-819">Culture: It's a language and, optionally, a region.</span></span>
* <span data-ttu-id="88f47-820">Нейтральный язык и региональные параметры: язык и региональные параметры, для которых указан язык, но не регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-820">Neutral culture: A culture that has a specified language, but not a region.</span></span> <span data-ttu-id="88f47-821">(например, "en", "es").</span><span class="sxs-lookup"><span data-stu-id="88f47-821">(for example "en", "es")</span></span>
* <span data-ttu-id="88f47-822">Конкретный язык и региональные параметры: язык и региональные параметры, для которых указаны язык и регион.</span><span class="sxs-lookup"><span data-stu-id="88f47-822">Specific culture: A culture that has a specified language and region.</span></span> <span data-ttu-id="88f47-823">(например, "en-US", "en-GB", "es-CL").</span><span class="sxs-lookup"><span data-stu-id="88f47-823">(for example "en-US", "en-GB", "es-CL")</span></span>
* <span data-ttu-id="88f47-824">Родительский язык и региональные параметры: нейтральные язык и региональные параметры, содержащие конкретные язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-824">Parent culture: The neutral culture that contains a specific culture.</span></span> <span data-ttu-id="88f47-825">(например, "en" — это родительские язык и региональные параметры для "en-US" и "en-GB").</span><span class="sxs-lookup"><span data-stu-id="88f47-825">(for example, "en" is the parent culture of "en-US" and "en-GB")</span></span>
* <span data-ttu-id="88f47-826">Языковой стандарт: тот же, что и язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="88f47-826">Locale: A locale is the same as a culture.</span></span>

[!INCLUDE[](~/includes/localization/currency.md)]

[!INCLUDE[](~/includes/localization/unsupported-culture-log-level.md)]

## <a name="additional-resources"></a><span data-ttu-id="88f47-827">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="88f47-827">Additional resources</span></span>

* <xref:fundamentals/troubleshoot-aspnet-core-localization>
* <span data-ttu-id="88f47-828">[Проект Localization.StarterWeb](https://github.com/aspnet/Entropy/tree/master/samples/Localization.StarterWeb), используемый в этой статье.</span><span class="sxs-lookup"><span data-stu-id="88f47-828">[Localization.StarterWeb project](https://github.com/aspnet/Entropy/tree/master/samples/Localization.StarterWeb) used in the article.</span></span>
* [<span data-ttu-id="88f47-829">Глобализация и локализация приложений .NET</span><span class="sxs-lookup"><span data-stu-id="88f47-829">Globalizing and localizing .NET applications</span></span>](/dotnet/standard/globalization-localization/index)
* [<span data-ttu-id="88f47-830">Ресурсы в RESX-файлах</span><span class="sxs-lookup"><span data-stu-id="88f47-830">Resources in .resx Files</span></span>](/dotnet/framework/resources/working-with-resx-files-programmatically)
* [<span data-ttu-id="88f47-831">Набор средств многоязычных приложений Майкрософт</span><span class="sxs-lookup"><span data-stu-id="88f47-831">Microsoft Multilingual App Toolkit</span></span>](https://marketplace.visualstudio.com/items?itemName=MultilingualAppToolkit.MultilingualAppToolkit-18308)
* [<span data-ttu-id="88f47-832">Локализация и универсальные шаблоны</span><span class="sxs-lookup"><span data-stu-id="88f47-832">Localization & Generics</span></span>](http://hishambinateya.com/localization-and-generics)

::: moniker-end
