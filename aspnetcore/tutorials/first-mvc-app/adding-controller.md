---
title: Часть 2. Добавление контроллера в приложение MVC ASP.NET Core
author: rick-anderson
description: Часть 2 серии руководств по ASP.NET Core MVC.
ms.author: riande
ms.date: 08/05/2017
no-loc:
- ':::no-loc(appsettings.json):::'
- ':::no-loc(ASP.NET Core Identity):::'
- ':::no-loc(cookie):::'
- ':::no-loc(Cookie):::'
- ':::no-loc(Blazor):::'
- ':::no-loc(Blazor Server):::'
- ':::no-loc(Blazor WebAssembly):::'
- ':::no-loc(Identity):::'
- ":::no-loc(Let's Encrypt):::"
- ':::no-loc(Razor):::'
- ':::no-loc(SignalR):::'
uid: tutorials/first-mvc-app/adding-controller
ms.openlocfilehash: 11832efa6715f96856665f174d65b094806d2810
ms.sourcegitcommit: ca34c1ac578e7d3daa0febf1810ba5fc74f60bbf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2020
ms.locfileid: "93061292"
---
# <a name="part-2-add-a-controller-to-an-aspnet-core-mvc-app"></a><span data-ttu-id="dc6ae-103">Часть 2. Добавление контроллера в приложение MVC ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="dc6ae-103">Part 2, add a controller to an ASP.NET Core MVC app</span></span>

<span data-ttu-id="dc6ae-104">Автор: [Рик Андерсон](https://twitter.com/RickAndMSFT) (Rick Anderson)</span><span class="sxs-lookup"><span data-stu-id="dc6ae-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="dc6ae-105">Модель архитектуры MVC разделяет приложение на три основных компонента: **M** odel (модель), **V** iew (представление) и **C** ontroller (контроллер).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-105">The Model-View-Controller (MVC) architectural pattern separates an app into three main components: **M** odel, **V** iew, and **C** ontroller.</span></span> <span data-ttu-id="dc6ae-106">С помощью модели MVC можно создавать приложения, которые удобнее тестировать и обновлять по сравнению с традиционными монолитными приложениями.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-106">The MVC pattern helps you create apps that are more testable and easier to update than traditional monolithic apps.</span></span> <span data-ttu-id="dc6ae-107">Приложения на основе модели MVC содержат следующее:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-107">MVC-based apps contain:</span></span>

* <span data-ttu-id="dc6ae-108">**Модели** : классы, представляющие данные в приложении.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-108">**M** odels: Classes that represent the data of the app.</span></span> <span data-ttu-id="dc6ae-109">Классы модели используют логику проверки, которая позволяет применять бизнес-правила к этим данным.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-109">The model classes use validation logic to enforce business rules for that data.</span></span> <span data-ttu-id="dc6ae-110">Как правило, объекты модели извлекают и сохраняют состояние модели в базе данных.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-110">Typically, model objects retrieve and store model state in a database.</span></span> <span data-ttu-id="dc6ae-111">В этом руководстве модель `Movie` извлекает сведения о фильмах из базы данных и передает их в представление или обновляет.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-111">In this tutorial, a `Movie` model retrieves movie data from a database, provides it to the view or updates it.</span></span> <span data-ttu-id="dc6ae-112">Обновленные данные записываются в базу данных.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-112">Updated data is written to a database.</span></span>

* <span data-ttu-id="dc6ae-113">**Представления** : компоненты, которые формируют пользовательский интерфейс приложения.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-113">**V** iews: Views are the components that display the app's user interface (UI).</span></span> <span data-ttu-id="dc6ae-114">Как правило, в пользовательском интерфейсе отображаются данные модели.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-114">Generally, this UI displays the model data.</span></span>

* <span data-ttu-id="dc6ae-115">**Контроллеры** : классы, которые обрабатывают запросы браузера.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-115">**C** ontrollers: Classes that handle browser requests.</span></span> <span data-ttu-id="dc6ae-116">Они извлекают данные модели и вызывают шаблоны представлений, которые возвращают ответ.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-116">They retrieve model data and call view templates that return a response.</span></span> <span data-ttu-id="dc6ae-117">В приложении MVC представление служит только для отображения информации. Обработку введенных данных, формирование ответа и взаимодействие с пользователем обеспечивает контроллер.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-117">In an MVC app, the view only displays information; the controller handles and responds to user input and interaction.</span></span> <span data-ttu-id="dc6ae-118">Например, контроллер обрабатывает данные маршрута и значения строки запроса, после чего передает эти значения в модель.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-118">For example, the controller handles route data and query-string values, and passes these values to the model.</span></span> <span data-ttu-id="dc6ae-119">Модель может использовать эти значения для выполнения запросов к базе данных.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-119">The model might use these values to query the database.</span></span> <span data-ttu-id="dc6ae-120">Например, `https://localhost:5001/Home/Privacy` содержит данные маршрута для `Home` (контроллер) и метода действия `Privacy` (вызывает контроллер home).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-120">For example, `https://localhost:5001/Home/Privacy` has route data of `Home` (the controller) and `Privacy` (the action method to call on the home controller).</span></span> <span data-ttu-id="dc6ae-121">`https://localhost:5001/Movies/Edit/5` — это запрос на редактирование фильма с идентификатором 5 с использованием контроллера movie.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-121">`https://localhost:5001/Movies/Edit/5` is a request to edit the movie with ID=5 using the movie controller.</span></span> <span data-ttu-id="dc6ae-122">Данные маршрута описаны далее в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-122">Route data is explained later in the tutorial.</span></span>

<span data-ttu-id="dc6ae-123">Модель MVC позволяет создавать приложения, которые разделяют различные аспекты (логика ввода, бизнес-логика и логика пользовательского интерфейса), обеспечивая при этом слабые взаимозависимости между этими элементами.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-123">The MVC pattern helps you create apps that separate the different aspects of the app (input logic, business logic, and UI logic), while providing a loose coupling between these elements.</span></span> <span data-ttu-id="dc6ae-124">Модель определяет, в каком месте приложения будет располагаться логика разных видов.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-124">The pattern specifies where each kind of logic should be located in the app.</span></span> <span data-ttu-id="dc6ae-125">Логика пользовательского интерфейса относится к представлению.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-125">The UI logic belongs in the view.</span></span> <span data-ttu-id="dc6ae-126">Логика ввода относится к контроллеру.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-126">Input logic belongs in the controller.</span></span> <span data-ttu-id="dc6ae-127">Бизнес-логика размещается в модели.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-127">Business logic belongs in the model.</span></span> <span data-ttu-id="dc6ae-128">Подобное разделение позволяет эффективно справляться с трудностями при построении приложения, поскольку оно дает возможность работать одновременно с одним аспектом реализации, не затрагивая при этом код других.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-128">This separation helps you manage complexity when you build an app, because it enables you to work on one aspect of the implementation at a time without impacting the code of another.</span></span> <span data-ttu-id="dc6ae-129">Например, вы можете изменять код представления независимо от кода бизнес-логики.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-129">For example, you can work on the view code without depending on the business logic code.</span></span>

<span data-ttu-id="dc6ae-130">Эти понятия подробно рассматриваются в данной серии руководств и наглядно демонстрируются при построении приложения movie.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-130">We cover these concepts in this tutorial series and show you how to use them to build a movie app.</span></span> <span data-ttu-id="dc6ae-131">Проект MVC содержит папки для *контроллеров* и *представлений*.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-131">The MVC project contains folders for the *Controllers* and *Views*.</span></span>

## <a name="add-a-controller"></a><span data-ttu-id="dc6ae-132">Добавление контроллера</span><span class="sxs-lookup"><span data-stu-id="dc6ae-132">Add a controller</span></span>

# <a name="visual-studio"></a>[<span data-ttu-id="dc6ae-133">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="dc6ae-133">Visual Studio</span></span>](#tab/visual-studio)

* <span data-ttu-id="dc6ae-134">В **обозревателе решений** щелкните правой кнопкой мыши **Контроллеры > Добавить > Контроллер**
  ![Контекстное меню](adding-controller/_static/add_controller.png).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-134">In **Solution Explorer** , right-click **Controllers > Add > Controller**
![Contextual menu](adding-controller/_static/add_controller.png)</span></span>

* <span data-ttu-id="dc6ae-135">В диалоговом окне **Добавление шаблона** выберите **Класс контроллера — пустой**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-135">In the **Add Scaffold** dialog box, select **Controller Class - Empty**</span></span>

  ![Добавьте контроллер MVC и присвойте ему имя.](adding-controller/_static/ac.png)

* <span data-ttu-id="dc6ae-137">В **диалоговом окне "Добавить пустой контроллер MVC"** введите **HelloWorldController** и выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-137">In the **Add Empty MVC Controller dialog** , enter **HelloWorldController** and select **ADD**.</span></span>

# <a name="visual-studio-code"></a>[<span data-ttu-id="dc6ae-138">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="dc6ae-138">Visual Studio Code</span></span>](#tab/visual-studio-code)

<span data-ttu-id="dc6ae-139">Щелкните значок **обозревателя** , а затем правой кнопкой мыши щелкните **Контроллеры > Новый файл** и назовите новый файл *HelloWorldController.cs*.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-139">Select the **EXPLORER** icon and then control-click (right-click) **Controllers > New File** and name the new file *HelloWorldController.cs*.</span></span>

  ![Контекстное меню](~/tutorials/first-mvc-app-xplat/adding-controller/_static/new_file.png)

# <a name="visual-studio-for-mac"></a>[<span data-ttu-id="dc6ae-141">Visual Studio для Mac</span><span class="sxs-lookup"><span data-stu-id="dc6ae-141">Visual Studio for Mac</span></span>](#tab/visual-studio-mac)

<span data-ttu-id="dc6ae-142">В **обозревателе решений** щелкните правой кнопкой мыши **Контроллеры > Добавить > Новый файл**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-142">In **Solution Explorer** , right-click **Controllers > Add > New File**.</span></span>
<span data-ttu-id="dc6ae-143">![Контекстное меню](~/tutorials/first-mvc-app-mac/adding-controller/_static/add_controller.png)</span><span class="sxs-lookup"><span data-stu-id="dc6ae-143">![Contextual menu](~/tutorials/first-mvc-app-mac/adding-controller/_static/add_controller.png)</span></span>

<span data-ttu-id="dc6ae-144">Выберите **ASP.NET Core** и **Класс контроллера**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-144">Select **ASP.NET Core** and **Controller Class**.</span></span>

<span data-ttu-id="dc6ae-145">Присвойте контроллеру имя **HelloWorldController**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-145">Name the controller **HelloWorldController**.</span></span>

![Добавьте контроллер MVC и присвойте ему имя.](~/tutorials/first-mvc-app-mac/adding-controller/_static/ac.png)

---

<span data-ttu-id="dc6ae-147">Замените содержимое файла *Controllers/HelloWorldController.cs* следующим:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-147">Replace the contents of *Controllers/HelloWorldController.cs* with the following:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/HelloWorldController.cs?name=snippet_1)]

<span data-ttu-id="dc6ae-148">Каждый метод `public` в контроллере вызывается как конечная точка HTTP.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-148">Every `public` method in a controller is callable as an HTTP endpoint.</span></span> <span data-ttu-id="dc6ae-149">В приведенном выше примере оба метода возвращают строку.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-149">In the sample above, both methods return a string.</span></span> <span data-ttu-id="dc6ae-150">Обратите внимание на комментарии, предшествующие каждому методу.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-150">Note the comments preceding each method.</span></span>

<span data-ttu-id="dc6ae-151">Конечная точка HTTP — это адресуемый URL в веб-приложении, такой как `https://localhost:5001/HelloWorld`, который объединяет в себе используемый протокол (`HTTPS`), сетевое расположение сервера с TCP-портом (`localhost:5001`), а также целевой URI (`HelloWorld`).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-151">An HTTP endpoint is a targetable URL in the web application, such as `https://localhost:5001/HelloWorld`, and combines the protocol used: `HTTPS`, the network location of the web server (including the TCP port): `localhost:5001` and the target URI `HelloWorld`.</span></span>

<span data-ttu-id="dc6ae-152">В первом комментарии указано, что этот метод [HTTP GET](https://www.w3schools.com/tags/ref_httpmethods.asp) вызывается путем добавления `/HelloWorld/` к базовому URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-152">The first comment states this is an [HTTP GET](https://www.w3schools.com/tags/ref_httpmethods.asp) method that's invoked by appending `/HelloWorld/` to the base URL.</span></span> <span data-ttu-id="dc6ae-153">Во втором комментарии указано, что этот метод [HTTP GET](https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html) вызывается путем добавления `/HelloWorld/Welcome/` к URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-153">The second comment specifies an [HTTP GET](https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html) method that's invoked by appending `/HelloWorld/Welcome/` to the URL.</span></span> <span data-ttu-id="dc6ae-154">Далее в этом руководстве используется механизм формирования шаблонов для создания методов `HTTP POST`, которые обновляют данные.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-154">Later on in the tutorial the scaffolding engine is used to generate `HTTP POST` methods which update data.</span></span>

<span data-ttu-id="dc6ae-155">Запустите приложение в режиме без отладки и добавьте "HelloWorld" к пути в адресной строке.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-155">Run the app in non-debug mode and append "HelloWorld" to the path in the address bar.</span></span> <span data-ttu-id="dc6ae-156">Метод `Index` возвращает строку.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-156">The `Index` method returns a string.</span></span>

![Окно браузера, в котором отображается ответ "This is my default action" (Это действие по умолчанию)](~/tutorials/first-mvc-app/adding-controller/_static/hell1.png)

<span data-ttu-id="dc6ae-158">MVC вызывает классы контроллера (и методы действия в них) в зависимости от входящего URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-158">MVC invokes controller classes (and the action methods within them) depending on the incoming URL.</span></span> <span data-ttu-id="dc6ae-159">[Логика маршрутизации URL-адресов](xref:mvc/controllers/routing), используемая моделью MVC по умолчанию, определяет вызываемый код на основе формата следующего вида:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-159">The default [URL routing logic](xref:mvc/controllers/routing) used by MVC uses a format like this to determine what code to invoke:</span></span>

`/[Controller]/[ActionName]/[Parameters]`

<span data-ttu-id="dc6ae-160">Формат маршрутизации задается в методе `Configure` в файле *Startup.cs*.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-160">The routing format is set in the `Configure` method in *Startup.cs* file.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie3/Startup.cs?name=snippet_1&highlight=5)]

<span data-ttu-id="dc6ae-161">Если при переходе к приложению не указаны сегменты URL-адреса, по умолчанию устанавливаются контроллер Home и метод Index, которые заданы в выделенной выше строке шаблона.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-161">When you browse to the app and don't supply any URL segments, it defaults to the "Home" controller and the "Index" method specified in the template line highlighted above.</span></span>

<span data-ttu-id="dc6ae-162">Первый сегмент URL-адреса определяет класс контроллера, который будет выполняться.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-162">The first URL segment determines the controller class to run.</span></span> <span data-ttu-id="dc6ae-163">Поэтому `localhost:{PORT}/HelloWorld` сопоставляется с классом **HelloWorld** Controller.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-163">So `localhost:{PORT}/HelloWorld` maps to the **HelloWorld** Controller class.</span></span> <span data-ttu-id="dc6ae-164">Вторая часть сегмента URL-адреса определяет метод действия для класса.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-164">The second part of the URL segment determines the action method on the class.</span></span> <span data-ttu-id="dc6ae-165">Таким образом, `localhost:{PORT}/HelloWorld/Index` выполняет метод `Index` класса `HelloWorldController`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-165">So `localhost:{PORT}/HelloWorld/Index` would cause the `Index` method of the `HelloWorldController` class to run.</span></span> <span data-ttu-id="dc6ae-166">Обратите внимание, что в этом случае достаточно перейти по адресу `localhost:{PORT}/HelloWorld`, а метод `Index` вызывается по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-166">Notice that you only had to browse to `localhost:{PORT}/HelloWorld` and the `Index` method was called by default.</span></span> <span data-ttu-id="dc6ae-167">Это связано с тем, что если имя вызываемого метода не указано явно, для контроллера вызывается метод по умолчанию `Index`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-167">That's because `Index` is the default method that will be called on a controller if a method name isn't explicitly specified.</span></span> <span data-ttu-id="dc6ae-168">В третьей части сегмента URL-адреса (`id`) указываются данные маршрута.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-168">The third part of the URL segment ( `id`) is for route data.</span></span> <span data-ttu-id="dc6ae-169">Данные маршрута описаны далее в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-169">Route data is explained later in the tutorial.</span></span>

<span data-ttu-id="dc6ae-170">Перейдите по адресу `https://localhost:{PORT}/HelloWorld/Welcome`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-170">Browse to `https://localhost:{PORT}/HelloWorld/Welcome`.</span></span> <span data-ttu-id="dc6ae-171">Метод `Welcome` запускается и возвращает строку `This is the Welcome action method...`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-171">The `Welcome` method runs and returns the string `This is the Welcome action method...`.</span></span> <span data-ttu-id="dc6ae-172">Для этого URL-адреса заданы контроллер `HelloWorld` и метод действия `Welcome`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-172">For this URL, the controller is `HelloWorld` and `Welcome` is the action method.</span></span> <span data-ttu-id="dc6ae-173">Часть URL-адреса `[Parameters]` на данный момент еще не использовалась.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-173">You haven't used the `[Parameters]` part of the URL yet.</span></span>

![Окно браузера, в котором отображается ответ "This is the Welcome action method" (Это метод действия Welcome)](~/tutorials/first-mvc-app/adding-controller/_static/welcome.png)

<span data-ttu-id="dc6ae-175">Измените код, чтобы передать сведения о параметрах из URL-адреса в контроллер.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-175">Modify the code to pass some parameter information from the URL to the controller.</span></span> <span data-ttu-id="dc6ae-176">Например, `/HelloWorld/Welcome?name=Rick&numtimes=4`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-176">For example, `/HelloWorld/Welcome?name=Rick&numtimes=4`.</span></span> <span data-ttu-id="dc6ae-177">Измените метод `Welcome`, включив два параметра, как показано в следующем коде.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-177">Change the `Welcome` method to include two parameters as shown in the following code.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/HelloWorldController.cs?name=snippet_2)]

<span data-ttu-id="dc6ae-178">Предыдущий код:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-178">The preceding code:</span></span>

* <span data-ttu-id="dc6ae-179">Использует функцию необязательного параметра C#, указывая, что параметр `numTimes` по умолчанию принимает значение 1, если ему не было передано значение.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-179">Uses the C# optional-parameter feature to indicate that the `numTimes` parameter defaults to 1 if no value is passed for that parameter.</span></span> <!-- remove for simplified -->
* <span data-ttu-id="dc6ae-180">Использует `HtmlEncoder.Default.Encode` для защиты приложения от злонамеренного ввода данных (JavaScript).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-180">Uses `HtmlEncoder.Default.Encode` to protect the app from malicious input (namely JavaScript).</span></span>
* <span data-ttu-id="dc6ae-181">Использует [интерполированные строки](/dotnet/articles/csharp/language-reference/keywords/interpolated-strings) в `$"Hello {name}, NumTimes is: {numTimes}"`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-181">Uses [Interpolated Strings](/dotnet/articles/csharp/language-reference/keywords/interpolated-strings) in `$"Hello {name}, NumTimes is: {numTimes}"`.</span></span> <!-- remove for simplified -->

<span data-ttu-id="dc6ae-182">Запустите приложение и перейдите по адресу:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-182">Run the app and browse to:</span></span>

   `https://localhost:{PORT}/HelloWorld/Welcome?name=Rick&numtimes=4`

<span data-ttu-id="dc6ae-183">(Замените `{PORT}` на номер порта.) Вы можете попробовать различные значения `name` и `numtimes` в URL-адресе.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-183">(Replace `{PORT}` with your port number.) You can try different values for `name` and `numtimes` in the URL.</span></span> <span data-ttu-id="dc6ae-184">Система [привязки модели](xref:mvc/models/model-binding) MVC автоматически сопоставляет именованные параметры из строк запроса в адресной строке с параметрами метода.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-184">The MVC [model binding](xref:mvc/models/model-binding) system automatically maps the named parameters from the query string in the address bar to parameters in your method.</span></span> <span data-ttu-id="dc6ae-185">Дополнительные сведения см. в разделе [Привязка модели](xref:mvc/models/model-binding).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-185">See [Model Binding](xref:mvc/models/model-binding) for more information.</span></span>

![Окно браузера, в котором отображается ответ Hello Rick; значение NumTimes равно 4.](~/tutorials/first-mvc-app/adding-controller/_static/rick4.png)

<span data-ttu-id="dc6ae-187">На показанном выше изображении сегмент URL-адреса (`Parameters`) не используется, а параметры `name` и `numTimes` передаются в [строке запроса](https://wikipedia.org/wiki/Query_string).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-187">In the image above, the URL segment (`Parameters`) isn't used, the `name` and `numTimes` parameters are passed in the [query string](https://wikipedia.org/wiki/Query_string).</span></span> <span data-ttu-id="dc6ae-188">Вопросительный знак (`?`) в приведенном выше URL-адресе используется в качестве разделителя, после которого указывается строка запроса.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-188">The `?` (question mark) in the above URL is a separator, and the query string follows.</span></span> <span data-ttu-id="dc6ae-189">Символом `&` отделяются пары "поле-значение".</span><span class="sxs-lookup"><span data-stu-id="dc6ae-189">The `&` character separates field-value pairs.</span></span>

<span data-ttu-id="dc6ae-190">Замените метод `Welcome` следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-190">Replace the `Welcome` method with the following code:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/HelloWorldController.cs?name=snippet_3)]

<span data-ttu-id="dc6ae-191">Запустите приложение и введите следующий URL-адрес: `https://localhost:{PORT}/HelloWorld/Welcome/3?name=Rick`</span><span class="sxs-lookup"><span data-stu-id="dc6ae-191">Run the app and enter the following URL: `https://localhost:{PORT}/HelloWorld/Welcome/3?name=Rick`</span></span>

<span data-ttu-id="dc6ae-192">На этот раз третий сегмент URL-адреса сопоставляется с параметром маршрута `id`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-192">This time the third URL segment matched the route parameter `id`.</span></span> <span data-ttu-id="dc6ae-193">Метод `Welcome` содержит параметр `id`, который сопоставляется с шаблоном URL-адреса в методе `MapControllerRoute`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-193">The `Welcome` method contains a parameter `id` that matched the URL template in the `MapControllerRoute` method.</span></span> <span data-ttu-id="dc6ae-194">Завершающий символ `?` (в `id?`) указывает, что параметр `id` является необязательным.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-194">The trailing `?` (in `id?`) indicates the `id` parameter is optional.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie3/Startup.cs?name=snippet_1&highlight=5)]

<span data-ttu-id="dc6ae-195">В этих примерах контроллер по сути реализует части "V" ( **V** iew, то есть представление) и "C" ( **C** ontroller — контроллер) из модели MVC.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-195">In these examples the controller has been doing the "VC" portion of MVC - that is, the **V** iew and the **C** ontroller work.</span></span> <span data-ttu-id="dc6ae-196">Контроллер возвращает HTML напрямую.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-196">The controller is returning HTML directly.</span></span> <span data-ttu-id="dc6ae-197">Как правило, это не требуется, поскольку в этом случае заметно усложняется написание и поддержка кода.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-197">Generally you don't want controllers returning HTML directly, since that becomes very cumbersome to code and maintain.</span></span> <span data-ttu-id="dc6ae-198">Вместо этого обычно используется отдельный файл шаблона представления :::no-loc(Razor)::: для создания HTML-ответа.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-198">Instead you typically use a separate :::no-loc(Razor)::: view template file to generate the HTML response.</span></span> <span data-ttu-id="dc6ae-199">Это будет показано в следующем руководстве.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-199">You do that in the next tutorial.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="dc6ae-200">[Назад](start-mvc.md)
> [Вперед](adding-view.md)</span><span class="sxs-lookup"><span data-stu-id="dc6ae-200">[Previous](start-mvc.md)
[Next](adding-view.md)</span></span>

::: moniker-end

::: moniker range="< aspnetcore-3.0"

<span data-ttu-id="dc6ae-201">Модель архитектуры MVC разделяет приложение на три основных компонента: **M** odel (модель), **V** iew (представление) и **C** ontroller (контроллер).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-201">The Model-View-Controller (MVC) architectural pattern separates an app into three main components: **M** odel, **V** iew, and **C** ontroller.</span></span> <span data-ttu-id="dc6ae-202">С помощью модели MVC можно создавать приложения, которые удобнее тестировать и обновлять по сравнению с традиционными монолитными приложениями.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-202">The MVC pattern helps you create apps that are more testable and easier to update than traditional monolithic apps.</span></span> <span data-ttu-id="dc6ae-203">Приложения на основе модели MVC содержат следующее:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-203">MVC-based apps contain:</span></span>

* <span data-ttu-id="dc6ae-204">**Модели** : классы, представляющие данные в приложении.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-204">**M** odels: Classes that represent the data of the app.</span></span> <span data-ttu-id="dc6ae-205">Классы модели используют логику проверки, которая позволяет применять бизнес-правила к этим данным.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-205">The model classes use validation logic to enforce business rules for that data.</span></span> <span data-ttu-id="dc6ae-206">Как правило, объекты модели извлекают и сохраняют состояние модели в базе данных.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-206">Typically, model objects retrieve and store model state in a database.</span></span> <span data-ttu-id="dc6ae-207">В этом руководстве модель `Movie` извлекает сведения о фильмах из базы данных и передает их в представление или обновляет.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-207">In this tutorial, a `Movie` model retrieves movie data from a database, provides it to the view or updates it.</span></span> <span data-ttu-id="dc6ae-208">Обновленные данные записываются в базу данных.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-208">Updated data is written to a database.</span></span>

* <span data-ttu-id="dc6ae-209">**Представления** : компоненты, которые формируют пользовательский интерфейс приложения.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-209">**V** iews: Views are the components that display the app's user interface (UI).</span></span> <span data-ttu-id="dc6ae-210">Как правило, в пользовательском интерфейсе отображаются данные модели.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-210">Generally, this UI displays the model data.</span></span>

* <span data-ttu-id="dc6ae-211">**Контроллеры** : классы, которые обрабатывают запросы браузера.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-211">**C** ontrollers: Classes that handle browser requests.</span></span> <span data-ttu-id="dc6ae-212">Они извлекают данные модели и вызывают шаблоны представлений, которые возвращают ответ.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-212">They retrieve model data and call view templates that return a response.</span></span> <span data-ttu-id="dc6ae-213">В приложении MVC представление служит только для отображения информации. Обработку введенных данных, формирование ответа и взаимодействие с пользователем обеспечивает контроллер.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-213">In an MVC app, the view only displays information; the controller handles and responds to user input and interaction.</span></span> <span data-ttu-id="dc6ae-214">Например, контроллер обрабатывает данные маршрута и значения строки запроса, после чего передает эти значения в модель.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-214">For example, the controller handles route data and query-string values, and passes these values to the model.</span></span> <span data-ttu-id="dc6ae-215">Модель может использовать эти значения для выполнения запросов к базе данных.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-215">The model might use these values to query the database.</span></span> <span data-ttu-id="dc6ae-216">Например, `https://localhost:5001/Home/About` содержит данные маршрута для `Home` (контроллер) и метода действия `About` (вызывает контроллер home).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-216">For example, `https://localhost:5001/Home/About` has route data of `Home` (the controller) and `About` (the action method to call on the home controller).</span></span> <span data-ttu-id="dc6ae-217">`https://localhost:5001/Movies/Edit/5` — это запрос на редактирование фильма с идентификатором 5 с использованием контроллера movie.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-217">`https://localhost:5001/Movies/Edit/5` is a request to edit the movie with ID=5 using the movie controller.</span></span> <span data-ttu-id="dc6ae-218">Данные маршрута описаны далее в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-218">Route data is explained later in the tutorial.</span></span>

<span data-ttu-id="dc6ae-219">Модель MVC позволяет создавать приложения, которые разделяют различные аспекты (логика ввода, бизнес-логика и логика пользовательского интерфейса), обеспечивая при этом слабые взаимозависимости между этими элементами.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-219">The MVC pattern helps you create apps that separate the different aspects of the app (input logic, business logic, and UI logic), while providing a loose coupling between these elements.</span></span> <span data-ttu-id="dc6ae-220">Модель определяет, в каком месте приложения будет располагаться логика разных видов.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-220">The pattern specifies where each kind of logic should be located in the app.</span></span> <span data-ttu-id="dc6ae-221">Логика пользовательского интерфейса относится к представлению.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-221">The UI logic belongs in the view.</span></span> <span data-ttu-id="dc6ae-222">Логика ввода относится к контроллеру.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-222">Input logic belongs in the controller.</span></span> <span data-ttu-id="dc6ae-223">Бизнес-логика размещается в модели.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-223">Business logic belongs in the model.</span></span> <span data-ttu-id="dc6ae-224">Подобное разделение позволяет эффективно справляться с трудностями при построении приложения, поскольку оно дает возможность работать одновременно с одним аспектом реализации, не затрагивая при этом код других.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-224">This separation helps you manage complexity when you build an app, because it enables you to work on one aspect of the implementation at a time without impacting the code of another.</span></span> <span data-ttu-id="dc6ae-225">Например, вы можете изменять код представления независимо от кода бизнес-логики.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-225">For example, you can work on the view code without depending on the business logic code.</span></span>

<span data-ttu-id="dc6ae-226">Эти понятия подробно рассматриваются в данной серии руководств и наглядно демонстрируются при построении приложения movie.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-226">We cover these concepts in this tutorial series and show you how to use them to build a movie app.</span></span> <span data-ttu-id="dc6ae-227">Проект MVC содержит папки для *контроллеров* и *представлений*.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-227">The MVC project contains folders for the *Controllers* and *Views*.</span></span>

## <a name="add-a-controller"></a><span data-ttu-id="dc6ae-228">Добавление контроллера</span><span class="sxs-lookup"><span data-stu-id="dc6ae-228">Add a controller</span></span>

# <a name="visual-studio"></a>[<span data-ttu-id="dc6ae-229">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="dc6ae-229">Visual Studio</span></span>](#tab/visual-studio)

* <span data-ttu-id="dc6ae-230">В **обозревателе решений** щелкните правой кнопкой мыши **Контроллеры > Добавить > Контроллер**
  ![Контекстное меню](adding-controller/_static/add_controller.png).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-230">In **Solution Explorer** , right-click **Controllers > Add > Controller**
![Contextual menu](adding-controller/_static/add_controller.png)</span></span>

* <span data-ttu-id="dc6ae-231">В диалоговом окне **Добавление шаблона** выберите **Контроллер MVC — пустой**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-231">In the **Add Scaffold** dialog box, select **MVC Controller - Empty**</span></span>

  ![Добавьте контроллер MVC и присвойте ему имя.](adding-controller/_static/ac.png)

* <span data-ttu-id="dc6ae-233">В **диалоговом окне "Добавить пустой контроллер MVC"** введите **HelloWorldController** и выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-233">In the **Add Empty MVC Controller dialog** , enter **HelloWorldController** and select **ADD**.</span></span>

# <a name="visual-studio-code"></a>[<span data-ttu-id="dc6ae-234">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="dc6ae-234">Visual Studio Code</span></span>](#tab/visual-studio-code)

<span data-ttu-id="dc6ae-235">Щелкните значок **обозревателя** , а затем правой кнопкой мыши щелкните **Контроллеры > Новый файл** и назовите новый файл *HelloWorldController.cs*.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-235">Select the **EXPLORER** icon and then control-click (right-click) **Controllers > New File** and name the new file *HelloWorldController.cs*.</span></span>

  ![Контекстное меню](~/tutorials/first-mvc-app-xplat/adding-controller/_static/new_file.png)

# <a name="visual-studio-for-mac"></a>[<span data-ttu-id="dc6ae-237">Visual Studio для Mac</span><span class="sxs-lookup"><span data-stu-id="dc6ae-237">Visual Studio for Mac</span></span>](#tab/visual-studio-mac)

<span data-ttu-id="dc6ae-238">В **обозревателе решений** щелкните правой кнопкой мыши **Контроллеры > Добавить > Новый файл**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-238">In **Solution Explorer** , right-click **Controllers > Add > New File**.</span></span>
<span data-ttu-id="dc6ae-239">![Контекстное меню](~/tutorials/first-mvc-app-mac/adding-controller/_static/add_controller.png)</span><span class="sxs-lookup"><span data-stu-id="dc6ae-239">![Contextual menu](~/tutorials/first-mvc-app-mac/adding-controller/_static/add_controller.png)</span></span>

<span data-ttu-id="dc6ae-240">Выберите **ASP.NET Core** и **Класс контроллера MVC**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-240">Select **ASP.NET Core** and **MVC Controller Class**.</span></span>

<span data-ttu-id="dc6ae-241">Присвойте контроллеру имя **HelloWorldController**.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-241">Name the controller **HelloWorldController**.</span></span>

![Добавьте контроллер MVC и присвойте ему имя.](~/tutorials/first-mvc-app-mac/adding-controller/_static/ac.png)

---

<span data-ttu-id="dc6ae-243">Замените содержимое файла *Controllers/HelloWorldController.cs* следующим:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-243">Replace the contents of *Controllers/HelloWorldController.cs* with the following:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/HelloWorldController.cs?name=snippet_1)]

<span data-ttu-id="dc6ae-244">Каждый метод `public` в контроллере вызывается как конечная точка HTTP.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-244">Every `public` method in a controller is callable as an HTTP endpoint.</span></span> <span data-ttu-id="dc6ae-245">В приведенном выше примере оба метода возвращают строку.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-245">In the sample above, both methods return a string.</span></span> <span data-ttu-id="dc6ae-246">Обратите внимание на комментарии, предшествующие каждому методу.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-246">Note the comments preceding each method.</span></span>

<span data-ttu-id="dc6ae-247">Конечная точка HTTP — это адресуемый URL в веб-приложении, такой как `https://localhost:5001/HelloWorld`, который объединяет в себе используемый протокол (`HTTPS`), сетевое расположение сервера с TCP-портом (`localhost:5001`), а также целевой URI (`HelloWorld`).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-247">An HTTP endpoint is a targetable URL in the web application, such as `https://localhost:5001/HelloWorld`, and combines the protocol used: `HTTPS`, the network location of the web server (including the TCP port): `localhost:5001` and the target URI `HelloWorld`.</span></span>

<span data-ttu-id="dc6ae-248">В первом комментарии указано, что этот метод [HTTP GET](https://www.w3schools.com/tags/ref_httpmethods.asp) вызывается путем добавления `/HelloWorld/` к базовому URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-248">The first comment states this is an [HTTP GET](https://www.w3schools.com/tags/ref_httpmethods.asp) method that's invoked by appending `/HelloWorld/` to the base URL.</span></span> <span data-ttu-id="dc6ae-249">Во втором комментарии указано, что этот метод [HTTP GET](https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html) вызывается путем добавления `/HelloWorld/Welcome/` к URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-249">The second comment specifies an [HTTP GET](https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html) method that's invoked by appending `/HelloWorld/Welcome/` to the URL.</span></span> <span data-ttu-id="dc6ae-250">Далее в этом руководстве используется механизм формирования шаблонов для создания методов `HTTP POST`, которые обновляют данные.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-250">Later on in the tutorial the scaffolding engine is used to generate `HTTP POST` methods which update data.</span></span>

<span data-ttu-id="dc6ae-251">Запустите приложение в режиме без отладки и добавьте "HelloWorld" к пути в адресной строке.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-251">Run the app in non-debug mode and append "HelloWorld" to the path in the address bar.</span></span> <span data-ttu-id="dc6ae-252">Метод `Index` возвращает строку.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-252">The `Index` method returns a string.</span></span>

![Окно браузера, в котором отображается ответ "This is my default action" (Это действие по умолчанию)](~/tutorials/first-mvc-app/adding-controller/_static/hell1.png)

<span data-ttu-id="dc6ae-254">MVC вызывает классы контроллера (и методы действия в них) в зависимости от входящего URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-254">MVC invokes controller classes (and the action methods within them) depending on the incoming URL.</span></span> <span data-ttu-id="dc6ae-255">[Логика маршрутизации URL-адресов](xref:mvc/controllers/routing), используемая моделью MVC по умолчанию, определяет вызываемый код на основе формата следующего вида:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-255">The default [URL routing logic](xref:mvc/controllers/routing) used by MVC uses a format like this to determine what code to invoke:</span></span>

`/[Controller]/[ActionName]/[Parameters]`

<span data-ttu-id="dc6ae-256">Формат маршрутизации задается в методе `Configure` в файле *Startup.cs*.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-256">The routing format is set in the `Configure` method in *Startup.cs* file.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Startup.cs?name=snippet_1&highlight=5)]

<!-- 
Add link to explain lambda.
Remove link for simplified tutorial.
-->

<span data-ttu-id="dc6ae-257">Если при переходе к приложению не указаны сегменты URL-адреса, по умолчанию устанавливаются контроллер Home и метод Index, которые заданы в выделенной выше строке шаблона.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-257">When you browse to the app and don't supply any URL segments, it defaults to the "Home" controller and the "Index" method specified in the template line highlighted above.</span></span>

<span data-ttu-id="dc6ae-258">Первый сегмент URL-адреса определяет класс контроллера, который будет выполняться.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-258">The first URL segment determines the controller class to run.</span></span> <span data-ttu-id="dc6ae-259">Таким образом, `localhost:{PORT}/HelloWorld` сопоставляется с классом `HelloWorldController`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-259">So `localhost:{PORT}/HelloWorld` maps to the `HelloWorldController` class.</span></span> <span data-ttu-id="dc6ae-260">Вторая часть сегмента URL-адреса определяет метод действия для класса.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-260">The second part of the URL segment determines the action method on the class.</span></span> <span data-ttu-id="dc6ae-261">Таким образом, `localhost:{PORT}/HelloWorld/Index` выполняет метод `Index` класса `HelloWorldController`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-261">So `localhost:{PORT}/HelloWorld/Index` would cause the `Index` method of the `HelloWorldController` class to run.</span></span> <span data-ttu-id="dc6ae-262">Обратите внимание, что в этом случае достаточно перейти по адресу `localhost:{PORT}/HelloWorld`, а метод `Index` вызывается по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-262">Notice that you only had to browse to `localhost:{PORT}/HelloWorld` and the `Index` method was called by default.</span></span> <span data-ttu-id="dc6ae-263">Это связано с тем, что если имя вызываемого метода не задано явно, для контроллера по умолчанию вызывается метод `Index`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-263">This is because `Index` is the default method that will be called on a controller if a method name isn't explicitly specified.</span></span> <span data-ttu-id="dc6ae-264">В третьей части сегмента URL-адреса (`id`) указываются данные маршрута.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-264">The third part of the URL segment ( `id`) is for route data.</span></span> <span data-ttu-id="dc6ae-265">Данные маршрута описаны далее в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-265">Route data is explained later in the tutorial.</span></span>

<span data-ttu-id="dc6ae-266">Перейдите по адресу `https://localhost:{PORT}/HelloWorld/Welcome`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-266">Browse to `https://localhost:{PORT}/HelloWorld/Welcome`.</span></span> <span data-ttu-id="dc6ae-267">Метод `Welcome` запускается и возвращает строку `This is the Welcome action method...`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-267">The `Welcome` method runs and returns the string `This is the Welcome action method...`.</span></span> <span data-ttu-id="dc6ae-268">Для этого URL-адреса заданы контроллер `HelloWorld` и метод действия `Welcome`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-268">For this URL, the controller is `HelloWorld` and `Welcome` is the action method.</span></span> <span data-ttu-id="dc6ae-269">Часть URL-адреса `[Parameters]` на данный момент еще не использовалась.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-269">You haven't used the `[Parameters]` part of the URL yet.</span></span>

![Окно браузера, в котором отображается ответ "This is the Welcome action method" (Это метод действия Welcome)](~/tutorials/first-mvc-app/adding-controller/_static/welcome.png)

<span data-ttu-id="dc6ae-271">Измените код, чтобы передать сведения о параметрах из URL-адреса в контроллер.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-271">Modify the code to pass some parameter information from the URL to the controller.</span></span> <span data-ttu-id="dc6ae-272">Например, `/HelloWorld/Welcome?name=Rick&numtimes=4`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-272">For example, `/HelloWorld/Welcome?name=Rick&numtimes=4`.</span></span> <span data-ttu-id="dc6ae-273">Измените метод `Welcome`, включив два параметра, как показано в следующем коде.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-273">Change the `Welcome` method to include two parameters as shown in the following code.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/HelloWorldController.cs?name=snippet_2)]

<span data-ttu-id="dc6ae-274">Предыдущий код:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-274">The preceding code:</span></span>

* <span data-ttu-id="dc6ae-275">Использует функцию необязательного параметра C#, указывая, что параметр `numTimes` по умолчанию принимает значение 1, если ему не было передано значение.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-275">Uses the C# optional-parameter feature to indicate that the `numTimes` parameter defaults to 1 if no value is passed for that parameter.</span></span> <!-- remove for simplified -->
* <span data-ttu-id="dc6ae-276">Использует `HtmlEncoder.Default.Encode` для защиты приложения от злонамеренного ввода данных (JavaScript).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-276">Uses `HtmlEncoder.Default.Encode` to protect the app from malicious input (namely JavaScript).</span></span>
* <span data-ttu-id="dc6ae-277">Использует [интерполированные строки](/dotnet/articles/csharp/language-reference/keywords/interpolated-strings) в `$"Hello {name}, NumTimes is: {numTimes}"`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-277">Uses [Interpolated Strings](/dotnet/articles/csharp/language-reference/keywords/interpolated-strings) in `$"Hello {name}, NumTimes is: {numTimes}"`.</span></span> <!-- remove for simplified -->

<span data-ttu-id="dc6ae-278">Запустите приложение и перейдите по адресу:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-278">Run the app and browse to:</span></span>

   `https://localhost:{PORT}/HelloWorld/Welcome?name=Rick&numtimes=4`

<span data-ttu-id="dc6ae-279">(Замените `{PORT}` на номер порта.) Вы можете попробовать различные значения `name` и `numtimes` в URL-адресе.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-279">(Replace `{PORT}` with your port number.) You can try different values for `name` and `numtimes` in the URL.</span></span> <span data-ttu-id="dc6ae-280">Система [привязки модели](xref:mvc/models/model-binding) MVC автоматически сопоставляет именованные параметры из строк запроса в адресной строке с параметрами метода.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-280">The MVC [model binding](xref:mvc/models/model-binding) system automatically maps the named parameters from the query string in the address bar to parameters in your method.</span></span> <span data-ttu-id="dc6ae-281">Дополнительные сведения см. в разделе [Привязка модели](xref:mvc/models/model-binding).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-281">See [Model Binding](xref:mvc/models/model-binding) for more information.</span></span>

![Окно браузера, в котором отображается ответ Hello Rick; значение NumTimes равно 4.](~/tutorials/first-mvc-app/adding-controller/_static/rick4.png)

<span data-ttu-id="dc6ae-283">На показанном выше изображении сегмент URL-адреса (`Parameters`) не используется, а параметры `name` и `numTimes` передаются в [строке запроса](https://wikipedia.org/wiki/Query_string).</span><span class="sxs-lookup"><span data-stu-id="dc6ae-283">In the image above, the URL segment (`Parameters`) isn't used, the `name` and `numTimes` parameters are passed in the [query string](https://wikipedia.org/wiki/Query_string).</span></span> <span data-ttu-id="dc6ae-284">Вопросительный знак (`?`) в приведенном выше URL-адресе используется в качестве разделителя, после которого указывается строка запроса.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-284">The `?` (question mark) in the above URL is a separator, and the query string follows.</span></span> <span data-ttu-id="dc6ae-285">Символом `&` отделяются пары "поле-значение".</span><span class="sxs-lookup"><span data-stu-id="dc6ae-285">The `&` character separates field-value pairs.</span></span>

<span data-ttu-id="dc6ae-286">Замените метод `Welcome` следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="dc6ae-286">Replace the `Welcome` method with the following code:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/HelloWorldController.cs?name=snippet_3)]

<span data-ttu-id="dc6ae-287">Запустите приложение и введите следующий URL-адрес: `https://localhost:{PORT}/HelloWorld/Welcome/3?name=Rick`</span><span class="sxs-lookup"><span data-stu-id="dc6ae-287">Run the app and enter the following URL: `https://localhost:{PORT}/HelloWorld/Welcome/3?name=Rick`</span></span>

<span data-ttu-id="dc6ae-288">На этот раз третий сегмент URL-адреса сопоставляется с параметром маршрута `id`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-288">This time the third URL segment matched the route parameter `id`.</span></span> <span data-ttu-id="dc6ae-289">Метод `Welcome` содержит параметр `id`, который сопоставляется с шаблоном URL-адреса в методе `MapRoute`.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-289">The `Welcome` method contains a parameter `id` that matched the URL template in the `MapRoute` method.</span></span> <span data-ttu-id="dc6ae-290">Завершающий символ `?` (в `id?`) указывает, что параметр `id` является необязательным.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-290">The trailing `?` (in `id?`) indicates the `id` parameter is optional.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Startup.cs?name=snippet_1&highlight=5)]

<span data-ttu-id="dc6ae-291">В этих примерах контроллер реализует работу представления и контроллера в модели MVC.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-291">In these examples the controller has been doing the "VC" portion of MVC - that is, the view and controller work.</span></span> <span data-ttu-id="dc6ae-292">Контроллер возвращает HTML напрямую.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-292">The controller is returning HTML directly.</span></span> <span data-ttu-id="dc6ae-293">Как правило, это не требуется, поскольку в этом случае заметно усложняется написание и поддержка кода.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-293">Generally you don't want controllers returning HTML directly, since that becomes very cumbersome to code and maintain.</span></span> <span data-ttu-id="dc6ae-294">Вместо этого обычно используется отдельный файл шаблона представления :::no-loc(Razor)::: для создания HTML-ответа.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-294">Instead you typically use a separate :::no-loc(Razor)::: view template file to help generate the HTML response.</span></span> <span data-ttu-id="dc6ae-295">Это будет показано в следующем руководстве.</span><span class="sxs-lookup"><span data-stu-id="dc6ae-295">You do that in the next tutorial.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="dc6ae-296">[Назад](start-mvc.md)
> [Вперед](adding-view.md)</span><span class="sxs-lookup"><span data-stu-id="dc6ae-296">[Previous](start-mvc.md)
[Next](adding-view.md)</span></span>

::: moniker-end
